/**
 * Created by centi on 2015/6/9.
 */
"use strict";angular.module("DEVBYCM.cmSideMenuBox",[]).directive("cmSideMenuBox",function(){return{restrict:"E",template:"<div ng-transclude></div>",transclude:!0,link:function(){}}}).directive("cmSideMenu",function(){return{restrict:"E",template:'<ng-include src="\'app/components/ui/cmNavBar/template.html\'"></ng-include>\n<div ng-transclude style="position: absolute;top: 45px;right: 0;bottom: 0;left: 0;overflow-y: auto"></div>',transclude:!0}}).directive("cmSideMenuContent",function(){return{restrict:"E"}}).directive("cmSideMenuContentHeader",function(){return{restrict:"EA",scope:!1,template:"<div ng-transclude></div>",transclude:!0,link:function(e,t){t.after("<div></div>"),t.next().css("height",t.prop("offsetHeight")+"px"),t.css("top",t.parent()[0].scrollTop+"px"),t.parent().on("scroll",function(){t.css("top",t.parent()[0].scrollTop+"px")})}}}),angular.module("DEVBYCM.cmNotificationAreaModule",[]).directive("cmPerson",["$rootScope","AccountSvc","LoginSvc","cmLoginSvc","cmLoadingSvc",function(e,t,n,o,i){return{restrict:"E",templateUrl:"app/components/ui/cmNotificationArea/template.html",scope:{},link:function(a){a.uiIsPanelShow=!1,a.currentUser=t.getCurrentUser(),a.funcSwitchUser=function(){a.uiIsPanelShow=!1,o.show()},a.funcLogout=function(){a.uiIsPanelShow=!1,i.setContent("正在登出...","inProgress"),i.show(),n.logout().then(function(){i.setContent("您已注销","success")},function(){i.setContent("登出失败","error")})["finally"](function(){i.hide()})},e.$on("cmLogin",function(){a.currentUser=t.getCurrentUser()})}}}]),angular.module("DEVBYCM.cmNavBarModule",[]).controller("cmNavBarCtrl",["$scope","$rootScope","$state","cmNavBarService","cmBackSvc",function(e,t,n,o,i){e.canGoBack=i.canGoBack(),e.$watch(function(){return i.canGoBack()},function(){e.canGoBack=i.canGoBack()}),e.$watch(function(){return i.getDestType()},function(){e.destType=i.getDestType()}),e.$watch(function(){return i.getDestUrl()},function(){e.url=i.getDestUrl()}),e.goBack=function(){e.canGoBack&&(e.canGoBack=i.goBack())},e.title="",t.$on("cmNavBar",function(t,n){n&&!angular.isUndefined(n.title)&&(e.title=n.title)});var a=function(t,n){e.menuItem=o.getMatchedMenuItem(t,n)};a(n.current.name,n.params),e.toggleMenu=function(){t.$broadcast("cmNavMenu",{toggle:!0})},t.$on("$stateChangeStart",function(e,t,n){a(t.name,n)})}]).factory("cmNavBarService",["$rootScope",function(e){return{setTitle:function(t){e.$broadcast("cmNavBar",{title:t})},getMenu:function(){return[{title:"首页",label:"平台首页",icon:"ion-ios-home-outline",show:!0,state:"home",params:{},match:function(e){return"home"===e}},{title:"收货",label:"收货报告",icon:"ion-ios-list-outline",show:!1,state:"home.process.formList",params:{Class:"收货",ProcessTypeId:"ARRIVAL",Rev:0,ProcessNodeTypeId:"AR01"},match:function(e,t){return"home.process.formList"===e&&"收货"===t.Class}},{title:"检验",label:"检验任务",icon:"ion-ios-paper-outline",show:!0,state:"home.process.formListDataentry",params:{Class:"检验",ProcessTypeId:void 0,Rev:void 0},match:function(e,t){return"home.process.formListDataentry"===e||"home.process.formListCheck"===e}},{title:"管理",label:"系统管理",icon:"ion-ios-cog-outline",show:!0,state:"home.control.feedbackNew",params:{},match:function(e){return"home.control.feedbackNew"===e}},{title:"表单",label:"",icon:"ion-ios-photos-outline",state:"home.process.detailForm",params:{},match:function(e){return"home.process.detailForm"===e}}]},getMatchedMenuItem:function(e,t){var n=[];return angular.forEach(this.getMenu(),function(n){n&&n.match(e,t)&&this.push(n)},n),n[0]}}}]).factory("cmBackSvc",["$state",function(e){var t={state:"",params:{},url:"./"},n="null",o=!1;return{getDestType:function(){return n},getDestUrl:function(){return t.url},canGoBack:function(){return o},clear:function(){o=!1,localStorage.setItem("cmBackSvc.canGoBack",!1)},setUrl:function(e){t.url=e,n="url",o=!0},setState:function(e,i){t.state=e,t.params=i,o=!0,n="state",localStorage.setItem("cmBackSvc.canGoBack",!0),localStorage.setItem("cmBackSvc.destType","state")},goBack:function(){return o&&"state"===n&&(e.go(state,params),o=!1),o}}}]),angular.module("DEVBYCM.cmNavMenu",[]).directive("cmNavMenu",["cmNavBarService","$rootScope","$state",function(e,t,n){return{restrict:"E",templateUrl:"app/components/ui/cmNavMenu/template.html",transclude:!0,controller:function(){},link:function(o){o.menuItems=e.getMenu(),o.show=!1,o.goAndClose=function(e,t){n.go(e,t),o.show=!1},o.close=function(){o.show=!1},t.$on("cmNavMenu",function(e,t){t&&!angular.isUndefined(t.toggle)&&(o.show=!o.show)})}}}]),angular.module("DEVBYCM.cmLoginModule",[]).directive("cmLogin",["$rootScope","cmLoginSvc","LoginSvc",function(e,t,n){return{restrict:"E",templateUrl:"app/components/ui/cmLogin/template.html",scope:{},link:function(t){t.isShow=!1,t.isLoggedIn=n.isLoggedIn(),t.funcTryToClose=function(){t.isLoggedIn&&(t.isShow=!1)},e.$on("cmLogin",function(e,o){o&&!angular.isUndefined(o.show)&&(t.isShow=o.show),t.isLoggedIn=n.isLoggedIn()})}}}]).factory("cmLoginSvc",["$rootScope","$timeout",function(e,t){return{show:function(){e.$broadcast("cmLogin",{show:!0})},hide:function(n){return angular.isUndefined(n)&&(n=1e3),t(function(){e.$broadcast("cmLogin",{show:!1})},n)}}}]).controller("cmLoginCtrl",["$scope","$state","cmLoginSvc","LoginSvc",function(e,t,n,o){e.uiIsHover=!1,e.uiCurrentHoverIndex=null,e.uiIsLoggingIn=!1,e.uiIsInputError=!1;var i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAAAAAB5Gfe6AAAAAmJLR0QA/4ePzL8AAAW0SURBVHja7d29jus4DAVgvv97pVDhFCrGjQtjAAeIGzVqXGmBiy12t9ixrUOGR0O+gb6QlOIfWh6/PCQAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAgAV0/y9l1rbnzhq3V9LTr8EIM2vvxf+3zjKkkcHyGtp/xvHPqdhAaa1thNxFMtqsAPIpZ2OY02DAaRzP/6/0mAkgPVo16M8RwG4kvzmhaAPkG4u/w/Bwg9wK/sN60D8/vw2SaALkI/WH1uiBVgbJOqTEyC9GyiOL0aA/vI3aQRqAKk2ZCxsAM+jYWPjAkjo9be2MgGA81+zCsR7//tHfNEAvFXW345MArA2pTgSBUBualEYABQ2AM2tAA9QmmZk9wCr6vrxbUCYCkCjCISqABSKQGh2AKWdQNgSAJ0CwtQBNfqgUHVAhT4odAkATgEoQLUBaLNTgGy0fuhGIGRbAHwjAAJMZutvu0uA1Q4A2AaFrwVi26DwtUBsGxTGCkDWgBDuAdB9AAaQTNffXu4AZluA6g7gZQvQkjeAagwwewMwXn/7dgYwWQPszgBma4DqDODbGqA5A9jNASZfAMUcIPsCqOYAcwC4AjBfP+ogEAABEAABEACAOMwBFl8AcRD67QC//s/Qyxwg+QJYrNd/OLsekK0BijOAZA3wcgZgfhBYvAFYXxLK3gAWzh6IA8icPRB4e/ygbAFAANuz4OQPwPTeEOzuOBAgWdbA6hDAdCPMHgEy4R4ABTCsgdUlgN2Dcsjn5ZEAZimAfGMC+r5AoWuBYIBM1wLRL00VugQAAzwtusD28AtgsRGA3x4GAxhsBOCXh9HvDqtfF6nJN4B6H0QPEIADKPfB7eEdQLcIavIP8NgUdwD8YD0FgKR3p1hhmJTGHCG1NrA9OAAeXzoC78QCoNMIq8psUaVxegvL+tUGKm4EG4AqAPpvkdpkWb2hqgtB/qsCIPeCt95sZc3ByhkloDlbWnWyNGa0pu50ceXh6qvj9mcC0F8Gm/JHFtS/L5C6kqCqf2nE4BMb+XYnsPjGhslHVm7WwWbxrR0DgLTeTIEyxEdWculogwZfGxLlH7/76lBVTgNRXT7kKKjbCsX78rUJxP/ydQmEYfmaBCoAWeXCuM6pUOO+gNrtwUIxXn9VvDl4+J8u/1S+Owz/+BoYYFF/QAJ9eQQ7WPndDOLtdrJ0NnpQ8nD6nOBi9qwwsgxwAxW3Zhibu5Gayfi1ueJsnuDT/PV51MVioWp/Cq0QAvD1gfWjvkMptOsHCQAAlvaxWDwAfHD9CAGhXj9AQEjrH9YHhHv9/QJ9AM+Pr7/76SlhX3+vQA9Aqs1FdD1B1QPwbk7i/RmArbmJ7RMAS3MUiz2AjwbY3wiFvAF2N0LhbwB9bUAGaABdbUAGaABdbeAeQGkOo9gBrM1lrFYAHgvgdhHIKAVwtwhkmAK4WQTXAdLhF+DGcAXhPwL1HYcuA+TmOrI6QPENULQBnCfA9RSQcTrgvT4ow2yBN7dCGSwBLqeAjJYAV1NARkuAqykgwyXAxRSQ4RLgYgrIeAlwLQWuAFQWgKoDkBtNZBWAwgNQNACIEuBKCsh4LfBaG5TR9sCrO+FpgLlRxQwHKFwABQ0wNbKYwAArG8AKBqhsABULkBtdZCjAygewQgEqH0BFAhBWwNkakFEr4GwNyIinoCtnoVMAqVFGggHMnAAzDGDnBNhhAJUToKIApkYaEwhgZgWYQQA7K8AOAqisABUDkBptJAhA5gXIEICFF2CBAOy8ADsEoPICVAQAcQ880wVl5B54pgvKuOfAc2fBnwFezAAvAMDODLADACozQAUAHMwARz8A9S54Yh/8EWDiBpi6AWZugDkAegG+uQG+uwFe3ACvboCdG2DvBijcAKUboHID/HgU/Aui+qF7tg7BJAAAAABJRU5ErkJggg==",a={Id:null,Password:null,Avatar:i,AutoUpdateSavedUser:!1};e.selectedUser=angular.copy(a),e.savedUsers=o.getSavedUsers(),e.uiWhichPanel="switch";var s=function(t){e.uiWhichPanel="login",e.selectedUser=angular.copy(t)};!function(){0===e.savedUsers.length?s(a):1===e.savedUsers.length&&s(e.savedUsers[0])}(),e.funcRemoveUser=function(t){e.savedUsers.splice(t,1),o.setSavedUsers(e.savedUsers)},e.funcDisplayUserSwitch=function(){e.uiWhichPanel="switch"},e.funcDisplayNewUserLogin=function(){e.uiWhichPanel="login",s(a)},e.funcDisplayUserLogin=function(e){s(e)},e.funcUserIdChanged=function(){e.selectedUser.Avatar=i},e.funcCancelInputErrorMark=function(){e.uiIsInputError=!1},e.funcLogin=function(){e.uiIsLoggingIn=!0;var i=e.selectedUser,a=function(t){var n=e.savedUsers,i=-1;angular.forEach(n,function(e,n){e.Id===t.Id&&(i=n)}),-1===i?n.push(t):n[i]=t,e.savedUsers=n,o.setSavedUsers(n)};o.login(i.ID,i.Password).then(function(o){i.AutoUpdateSavedUser&&(o.AutoUpdateSavedUser=!0,o.Password=i.Password,a(o)),e.uiWhichPanel="success",n.hide(1500).then(function(){e.funcDisplayUserSwitch(),t.reload()})},function(){e.uiIsInputError=!0})["finally"](function(){e.uiIsLoggingIn=!1})}}]),angular.module("DEVBYCM.cmLoadingModule",[]).directive("cmLoading",["cmLoadingSvc","$rootScope",function(e,t){return{restrict:"E",templateUrl:"app/components/ui/cmLoading/template.html",scope:{},link:function(e){e.isShow=!1,e.content="",e.status="",t.$on("cmLoading",function(t,n){n&&!angular.isUndefined(n.show)&&(e.isShow=n.show),n&&!angular.isUndefined(n.content)&&(e.content=n.content),n&&!angular.isUndefined(n.status)&&(e.status=n.status)})}}}]).factory("cmLoadingSvc",["$rootScope","$timeout",function(e,t){var n=[],o={};return{show:function(){n.push(o),e.$broadcast("cmLoading",{show:!0})},hide:function(o){return n.pop(),n.length>0?void e.$broadcast("cmLoading",n[length-1]):(angular.isUndefined(o)&&(o=1e3),t(function(){e.$broadcast("cmLoading",{show:!1})},o))},setContent:function(t,n){o={content:t,status:n},e.$broadcast("cmLoading",o)}}}]),angular.module("RMI.ProcessCtrls",[]).controller("ProcessListCtrl",["$scope","$state","$filter","$timeout","FormSvc","ProcessSvc","cmNavBarService","cmLoadingSvc",function(e,t,n,o,i,a,s,r){e.stateParams=t.params,e.uiIsSideMenuListLoaded=!1,function(){a.fetchProcessTypesByClass(e.stateParams.Class).then(function(t){e.sideMenuList=t,r.setContent("加载完成")},function(e){console.log(e)})["finally"](function(){e.uiIsSideMenuListLoaded=!0,r.hide(750)})}(),e.funcCreateForm=function(){r.setContent("收货报告创建中"),r.show(),i.requestCreate("ARRIVAL","ARRIVAL",0,"AR01").then(function(e){t.go("home.process.detailForm",{ArrivalSerialNumber:e.ArrivalSerialNumber,FormId:e.Id,Mode:"edit"})},function(e){r.setContent("创建过程发生错误，请检查网络连接"),console.log(e)})["finally"](function(){r.hide(750)})},e.funcGoDetail=function(e,n,o){t.go("home.process.detailForm",{ArrivalSerialNumber:e,FormId:n,Mode:o})},e.funcGoDetailInfo=function(e){t.go("home.process.detailInfo",{ArrivalSerialNumber:e})},e.funcGoFormEdit=function(n,o,a){angular.equals(a,{})?(e.funcEditForm=function(e,n){r.setContent("数据加载中"),r.show(),t.go("home.process.detailForm",{ArrivalSerialNumber:e,FormId:n}),r.hide(100)},e.funcShortcutCreateFormAndRequestEditFormAndEditForm=function(n,o,a,s){r.setContent("正在尝试创建表单"),r.show(),i.requestCreate(n,o,a,s).then(function(o){t.reload(),e.funcEditForm(n,o.Id)},function(e){r.setContent("创建失败:"+e)})["finally"](function(){r.hide(750)})},e.funcShortcutCreateFormAndRequestEditFormAndEditForm(n.ArrivalSerialNumber,n.TypeId,n.Rev,o.Id)):e.funcGoDetail(n.ArrivalSerialNumber,a.Id,"edit")}}]).controller("ProcessListCountCtrl",["$scope","$state","$filter","$timeout","$window","ngTableParams","FormSvc","cmNavBarService","cmLoadingSvc",function(e,t,n,o,i,a,s,r,l){var c=[];e.uiIsFilterByCurrentUser=!1,e.tableDataOption={Status:4},e.tableParams=new a({page:1,count:500,sorting:{}},{total:c.length,counts:[],filterDelay:250,getData:function(e,t){}}),s.fetchForms(t.params.ProcessTypeId,t.params.Rev,t.params.ProcessNodeTypeId).then(function(t){c=t,e.tableParams.reload()},function(e){}),e.funcSubmitForm=function(e){var n=i.confirm("是否确认提交？");n===!0&&(l.setContent("正在提交表单"),l.show(),s.requestSubmitAndAddToArrivalAndAddToProcess(e).then(function(){l.setContent("提交成功"),t.reload()},function(e){console.log(e)})["finally"](function(){l.hide(750)}))}}]).controller("ControlInspectionProcessPrintCtrl",["$scope","SerialNo",function(e,t){}]).controller("ProcessListInspectionCtrl",["$scope","AccountSvc","$http","SERVER_URL","$uibModal","cmBackSvc","$state","NgTableParams","ALL_FLOW_ID",function(e,t,n,o,i,a,s,r,l){function c(){console.log(s);var i="";return e.url=s.current.url,console.log(e.url),"/Tasks/Check"==e.url?i="ALL":(console.log(t.getCurrentUser()),i="ALL"),e.myPromise=n.get(o+"inspect/"+i+"/getTasks/").then(function(t){for(var n=angular.copy(t.data),o=0;o<t.data.length;o++)n[o].ArriveTime=new Date(n[o].ArriveTime);u=n,console.log(u),e.tableParams=new r({sorting:{ArriveTime:"desc"}},{dataset:u}),e.tableParams.reload()},function(e){})["finally"](),u}function d(){e.myPromise=n.get(o+"inspect/getFlowList/").then(function(t){e.flowList=t.data})}!function(){e.url=s.current.url,console.log(e.url),a.setUrl("#")}(),e.del=function(t){e.myPromise=n.get(o+"inspect/"+t+"/deleteTask").then(function(){swal("成功","任务已删除","success"),s.reload()},function(){swal("失败","任务未删除","error")})},e.print=function(e){swal({title:"打印",text:"输入打印的张数:",type:"input",showCancelButton:!0,closeOnConfirm:!1,confirmButtonText:"确认",cancelButtonText:"取消",animation:"slide-from-top",inputPlaceholder:"张数"},function(e){return e===!1?!1:""===e?(swal.showInputError("输入的张数格式有误"),!1):void swal("成功","正在打印"+e+"张","success")})},e.url=s.current.url,e.searchFilter=function(e,t){return function(n){var o=n.ArriveTime.getTime()-288e5,i=t?t.getTime():0;return console.log(),(n.Name.indexOf(e)>=0||n.ProductNo.indexOf(e)>=0||n.ColorNo.indexOf(e)>=0||void 0==e||""==e)&&(o==i||0==i)}};var u;c(),e.flowList=[],d(),e.tableParams=new r({sorting:{ArriveTime:"desc"}},{dataset:u}),e["new"]=function(t){e.edit(t,!0)},e.entry=function(e,t){s.go("home.process.checkFormList",{ID:e.SerialNo,params:e,Type:t})},e.edit=function(t,n){var o;o=i.open({templateUrl:"app/interaction/process/list/modifyInspectionProcess.html",controller:"ControlInspectionProcessModifyCtrl",controllerAs:"vm",resolve:{formData:function(){return{fields:[{key:"ArriveTime",type:"input",templateOptions:{label:"到料日期",placeholder:"YYYY-MM-DD",required:!0,type:"date"}},{key:"ProductNo",type:"input",templateOptions:{required:!0,label:"货号",placeholder:"货号"}},{key:"ColorNo",type:"input",templateOptions:{required:!0,label:"色号",placeholder:"色号"}},{key:"FlowID",hideExpression:"1",type:"select",defaultValue:l,templateOptions:{required:!0,label:"流程号",options:e.flowList}}],model:t,ALL_FLOW_ID:l}},isNew:n}}).result,o.then(function(e){n&&s.reload()})}}]).controller("ControlInspectionProcessModifyCtrl",["$scope","$http","ALL_FLOW_ID","formData","$uibModalInstance","SERVER_URL","isNew",function(e,t,n,o,i,a,s){function r(){console.log(c.formData.model);var o=angular.copy(c.formData.model);o.isNew=s,o.hasOwnProperty("FlowID")||(o.FlowID=n),e.myPromise=t.post(a+"inspect/editTask/","JSON="+JSON.stringify(o).replace("true",'"True"').replace("false",'"False"')).then(function(e){swal("成功","您所做的修改已经生效","success"),i.close(c.formData.model)},function(e){swal("发生错误","您所做的修改未生效","error")})["finally"]()}function l(e){console.log(s),s||(o.options.resetModel(),o.model.ArriveTime=e.ArriveTime),i.dismiss("cancel")}e.initialModel=angular.copy(o.model);var c=this;console.log(s),c.ok=r,c.cancel=l,c.hint="",c.formData=o,c.originalFields=angular.copy(c.formData.fields)}]).controller("ProcessDetailInfoCtrl",["$scope","$state","$filter","$timeout","$q","ProcessSvc","FormSvc","ControlDesignSvc","cmNavBarService","cmLoadingSvc",function(e,t,n,o,i,a,s,r,l,c){e.state=t,e.uiIsReferenceShow=!1,e.uiShowProcessNodeDetail=[],e.uiProcessNodeViewSwitch="edit",c.setContent("数据加载中"),e.nodes=[],e.references=[],e.process={},function(){a.fetchProcess(t.params.ArrivalSerialNumber).then(function(t){!function(){t.Parameter=angular.fromJson(t.Parameter)}(),e.process=t,angular.forEach(e.process.Nodes,function(e){e.Order=parseInt(e.Order)}),c.hide()},function(e){alert("Error : "+e)})}(),e.funcGetCurrentStageTabCode=function(e,t,n){return console.log(e,t,n),n||(n=0),t||(t=0),e?"4"===t.toString()?"0"===n.toString()?2:3:1:0},e.funcShowProcessNodeDetail=function(t){e.uiShowProcessNodeDetail=[],e.uiShowProcessNodeDetail[t]=!0},e.currentReference={},e.uiCurrentActiveReferenceIndex=null,e.funcSwitchReference=function(t){t===e.uiCurrentActiveReferenceIndex?(console.log("same"),e.uiIsReferenceShow=!e.uiIsReferenceShow):(e.currentReference=e.references[t],e.uiIsReferenceShow=!0),e.uiCurrentActiveReferenceIndex=t},e.funcHideReference=function(){e.uiIsReferenceShow=!1},e.funcViewSourceForm=function(e){t.go("home.process.detailForm",{ArrivalSerialNumber:"ARRIVAL",FormId:e,Mode:"View"})},e.funcEditForm=function(e,n){t.go("home.process.detailForm",{ArrivalSerialNumber:e,FormId:n,Mode:"Edit"})},e.funcViewForm=function(e,n){t.go("home.process.detailForm",{ArrivalSerialNumber:e,FormId:n,Mode:"View"})},e.funcCreateForm=function(e,n,o,i){c.setContent("正在尝试创建表单"),c.show(),s.requestCreate(e,n,o,i).then(function(){t.reload()},function(e){c.setContent("创建失败:"+e)})["finally"](function(){c.hide(750)})},e.funcRequestEditForm=function(e){c.setContent("正在获取表单编辑权限"),c.show(),s.requestEdit(e).then(function(){t.reload()},function(e){c.setContent("获取失败:"+e)})["finally"](function(){c.hide(750)})},e.funcConfirmForm=function(e){c.setContent("正在提交你对表单的确认"),c.show(),s.requestConfirm(e).then(function(){t.reload()},function(e){c.setContent("创建失败:"+e)})["finally"](function(){c.hide(750)})},e.funcCancelEditForm=function(e){c.setContent("正在获取表单编辑权"),c.show(),s.requestCancelEdit(e).then(function(){t.reload()},function(e){c.setContent("获取失败:"+e)})["finally"](function(){c.hide(750)})},e.funcSubmitForm=function(e){c.setContent("正在提交表单"),c.show(),s.requestSubmit(e).then(function(){t.reload()},function(e){c.setContent("提交失败:"+e)})["finally"](function(){c.hide(750)})},e.funcShortcutCreateFormAndRequestEditFormAndEditForm=function(n,o,i,a){c.setContent("正在尝试创建表单"),c.show(),s.requestCreate(n,o,i,a).then(function(o){t.reload(),e.funcEditForm(n,o.Id)},function(e){c.setContent("创建失败:"+e)})["finally"](function(){c.hide(750)})},e.funcShortcutRequestEditFormAndEditForm=function(n,o){c.setContent("正在获取表单编辑权"),c.show(),s.requestEdit(o).then(function(){t.reload(),e.funcEditForm(n,o)},function(e){c.setContent("获取失败:"+e)})["finally"](function(){c.hide(750)})},e.funcShortcutConfirmFormAndSubmitForm=function(t){var n=window.confirm("确定要提交吗？");n&&e.funcSubmitForm(t)},e.$on("destroy",function(){createFormTimer&&o.cancel(createFormTimer),editFormTimer&&o.cancel(editFormTimer),confirmFormTimer&&o.cancel(confirmFormTimer),cancelEditFormTimer&&o.cancel(cancelEditFormTimer),submitFormTimer&&o.cancel(submitFormTimer)}),e.funcMarkProcessComplete=function(e){var n=window.confirm("请确认标记该检验任务完成吗？");if(n){c.setContent("正在标记完成","inProgress"),c.show();var o=a.updateProcessIsComplete(e,"true"),s=i.all([o]);s.then(function(){c.setContent("检验任务已经标记为完成","success"),t.reload()},function(){c.setContent("操作失败","error")})["finally"](function(){c.hide()})}},e.funcMarkProcessWaiting=function(e){var n=window.confirm("请确认是否提交最后审核？\n注意：确认后负责人将收到最后审核通知，并将检验任务标为完成");if(n){c.setContent("正在提交","inProgress"),c.show();var o=a.updateProcessIsComplete(e,"waiting"),s=i.all([o]);s.then(function(){c.setContent("提交成功","success"),t.reload()},function(){c.setContent("操作失败","error")})["finally"](function(){c.hide()})}},e.funcRedoComplete=function(e){var n=window.confirm("请确认重置该检验任务完成状态吗？\n注意：标记后是否完成重置为否");if(n){c.setContent("正在重置状态","inProgress"),c.show();var o=a.updateProcessIsComplete(e,"false"),s=i.all([o]);s.then(function(){c.setContent("检验任务已回到未完成状态","success"),t.reload()},function(){c.setContent("重置失败","error")})["finally"](function(){c.hide()})}},e.funcUpdateProcessNodeAvailableFlag=function(e,n,i){c.setContent("修改可用性中...","inProgress"),c.show(),a.updateProcessNodeAvailableFlag(e,n,i).then(function(){c.setContent("修改成功","success")},function(e){c.setContent("修改失败","error"),console.log(e)})["finally"](function(){c.hide(),o(function(){t.reload()},1e3)})},e.funcCheckPass=function(e,n){c.setContent("提交审核结果中...","inProgress"),c.show(),a.updateProcessNodeCheckStatus(e,n,1).then(function(){c.setContent("修改成功","success")},function(e){c.setContent("修改失败","error"),console.log(e)})["finally"](function(){c.hide(),o(function(){t.reload()},1e3)})},e.funcCheckDeny=function(e,n){c.setContent("提交审核结果中...","inProgress"),c.show(),a.updateProcessNodeCheckStatus(e,n,2).then(function(){c.setContent("修改成功","success")},function(e){c.setContent("修改失败","error"),console.log(e)})["finally"](function(){c.hide(),o(function(){t.reload()},1e3)})},e.funcRedoFormAndCheck=function(e,n,o){var r=window.confirm("确定要重做该项目吗？\n注意：重做会取消审核结论，并将表单置为可编辑");if(r){c.setContent("正在重设检验项状态","inProgress"),c.show();var l=a.updateProcessNodeCheckStatus(e,n,0),d=s.requestEdit(o),u=i.all([l,d]);u.then(function(){c.setContent("重设成功","success"),t.reload()},function(){c.setContent("重设失败","error")})["finally"](function(){c.hide()})}},e.funcRedoForm=function(e){var n=window.confirm("确定要重做表单吗？\n注意：将表单置为可编辑状态");if(n){c.setContent("正在重置表单编辑状态","inProgress"),c.show();var o=s.requestEdit(e),a=i.all([o]);a.then(function(){c.setContent("重设成功","success"),t.reload()},function(){c.setContent("重设失败","error")})["finally"](function(){c.hide()})}},e.funcRedoCheck=function(e,n){var o=window.confirm("确定要重做审核吗？\n注意：重做会取消审核结论");if(o){c.setContent("正在重设审核状态","inProgress"),c.show();var s=a.updateProcessNodeCheckStatus(e,n,0),r=i.all([s]);r.then(function(){c.setContent("重设成功","success"),t.reload()},function(){c.setContent("重设失败","error")})["finally"](function(){c.hide()})}},e.funcUpdateProcessNodeConclusion=function(e,n,i){i=angular.toJson(i),c.setContent("正在提交检验结论修改","inProgress"),c.show(),a.updateProcessNodeConclusion(e,n,i).then(function(){c.setContent("修改成功","success")},function(e){c.setContent("修改失败","error"),console.log(e)})["finally"](function(){c.hide(),o(function(){t.reload()},1e3)})}}]).controller("ProcessDetailFormCtrl",["$scope","$rootScope","$timeout","$state","$q","$window","$interval","ProcessSvc","FormSvc","cmNavBarService","cmLoadingSvc",function(e,t,n,o,i,a,s,r,l,c,d){e.state=o,e.stateParams=o.params,e.uiIsEditTags=!1,e.uiIsDataLoaded=!1,e.uiIsAutoSaveFormData=!1,e.uiIsReferencePanelShow=!0,e.uiIsReferenceShow=!1,e.uiIsFormStatusEditable=!0,e.option={all:{isEditable:!0},table:{isSortable:!1}},e.formInfo={},e.formData={},e.formConfig={},function(){d.setContent("正在加载表单"),d.show();var t=l.fetchForm(o.params.FormId),n=l.fetchFormData(o.params.FormId),a=l.fetchFormConfig(o.params.FormId),s=i.all([t,n,a]);s.then(function(t){e.formInfo=t[0],e.formData=t[1],e.formConfig=t[2],console.log(JSON.stringify(e.formConfig))},function(){d.setContent("加载失败")})["finally"](function(){d.hide()})}(),e.references=[],e.referencesProvider={},e.currentReference={},e.funcSwitchReferencePanel=function(){e.uiIsReferencePanelShow=!e.uiIsReferencePanelShow},e.uiCurrentActiveReferenceIndex=null,e.funcSwitchReference=function(t){t===e.uiCurrentActiveReferenceIndex?(console.log("same"),e.uiIsReferenceShow=!e.uiIsReferenceShow,e.uiCurrentActiveReferenceIndex=null):(e.currentReference=e.references[t],e.uiIsReferenceShow=!0,e.uiCurrentActiveReferenceIndex=t)},e.funcHideReference=function(){e.uiIsReferenceShow=!1},e.funcSideSaveForm=function(){2===parseInt(e.formInfo.Status)&&(e.option.all.isEditable=!1,e.funcSaveToServer())},e.funcSideEditForm=function(){e.option.all.isEditable=!0},e.funcSideViewForm=function(){e.option.all.isEditable=!1,e.uiIsEditTags=!1},e.funcRedoForm=function(e){var t=window.confirm("确定要重做表单吗？\n注意：将表单置为可编辑状态");if(t){d.setContent("正在重置表单编辑状态","inProgress"),d.show();var n=l.requestEdit(e),a=i.all([n]);a.then(function(){d.setContent("重设成功","success"),o.reload()},function(){d.setContent("重设失败","error")})["finally"](function(){d.hide()})}},e.funcSaveToServer=function(){console.log(e.formData),d.setContent("正在保存到服务器","inProgress"),d.show(),l.saveFormDataToServer(o.params.FormId,e.formData,!1).then(function(){d.setContent("表单数据保存成功！","success")},function(e){d.setContent("保存失败","error")})["finally"](function(){d.hide(750)})},e.funcSubmitForm=function(){var t=function(){var t=e.formInfo;"收货"===t.TypeClass?o.go("home.process.formList",{Class:t.TypeClass,ProcessTypeId:t.ProcessTypeId,Rev:t.Rev,ProcessNodeTypeId:t.ProcessNodeTypeId}):o.go("home.process.processList",{Class:t.TypeClass,ProcessTypeId:t.ProcessTypeId,Rev:t.Rev})},i=a.confirm("是否确认提交？");console.log(1),i===!0&&(d.setContent("校验失败，请检查是否有漏填，错填"),d.show(),d.hide(1500),d.setContent("正在提交表单"),d.show(),l.saveFormDataToServer(o.params.FormId,e.formData,!1).then(function(){"ARRIVAL"===o.params.ArrivalSerialNumber?l.requestSubmitAndAddToArrivalAndAddToProcess(o.params.FormId).then(function(){d.setContent("提交成功，即将转跳回列表","success"),n(function(){t(),d.hide(1e3)},2e3)},function(e){d.setContent("提交失败","error"),console.log(e),d.hide()}):l.requestSubmit(o.params.FormId).then(function(){d.setContent("提交成功，即将转跳回列表","success"),t()},function(e){d.setContent("提交失败","error"),console.log(e),d.hide()})},function(e){console.error(e),d.setContent("欲提交表单保存失败")}))};var u=function(t){return s(function(){e.uiIsAutoSaveFormData=!0,l.saveFormDataToServer(o.params.FormId,e.formData,!0).then(function(){},function(e){})["finally"](function(){e.uiIsAutoSaveFormData=!1})},t)}(12e4);e.$on("$destroy",function(){u&&s.cancel(u)})}]).controller("ProcessListBlankCtrl",["$scope","$state","AccountSvc",function(e,t,n){e.uiIsProcessTypesShow=!1;var o=function(e){"收货"===t.params.Class?t.go("home.process.formList",{Class:t.params.Class,ProcessTypeId:e.ProcessTypeId,Rev:e.Rev,ProcessNodeTypeId:"AR01"}):t.go("home.process.processList",{Class:t.params.Class,ProcessTypeId:e.ProcessTypeId,Rev:e.Rev})},i=n.getUserSetting("UserSetting.UI.Process.List.DefaultProcessType")[t.params.Class];o(i),e.funcSetDefaultProcessType=function(e,a){i.Enable=!0,i.ProcessTypeId=e,i.Rev=a;var s=n.getUserSetting("UserSetting.UI.Process.List.DefaultProcessType");s[t.params.Class]=i,n.setUserSetting("UserSetting.UI.Process.List.DefaultProcessType",s),o(i)}}]).controller("ProcessListMissions",["$scope","$state",function(e,t){function n(e){console.log(t)}e.newCheckMission=n}]),angular.module("RMI.PlayCtrls",[]).controller("PlaygroundCtrl",function(){var e=this;e.options={},e.fields=[{wrapper:"flex-rows",fieldGroup:[{wrapper:["flex-rows","label-left","border-top-right-left"],templateOptions:{label:"送样品部门"},fieldGroup:[{className:"row cmFormCollection border-top border-bottom border-left border-bottom",fieldGroup:[{className:"col-md-3",fieldGroup:[{template:"材料名称"},{template:"供应商"},{template:"到料日期"},{template:"品牌/系列名"}]},{className:"col-md-3",fieldGroup:[{type:"input"},{type:"input"},{type:"input"},{type:"input"}]},{className:"col-md-3",fieldGroup:[{template:"材料名称"},{template:"供应商"},{template:"到料日期"},{template:"品牌/系列名"}]},{className:"col-md-3",fieldGroup:[{type:"input"},{type:"input"},{type:"input"},{type:"input"}]}]},{className:"row cmFormCollection border-top",fieldGroup:[{wrapper:"label-colon",templateOptions:{label:"用途"},fieldGroup:[{className:"row",template:"用于面布，用于面布，用于面布，用于面布，"}]},{wrapper:"label-colon",templateOptions:{label:"模压条件"},fieldGroup:[{className:"row",template:"上模温度，下模温度，用于面布，用于面布，"},{className:"row",template:"上模温度，下模温度，用于面布，用于面布，"},{template:"送检人/日期"}]}]}]}]},{wrapper:"heading",template:"材料模压测试报告"}]}).controller("PlayBuildCtrl",["$scope",function(e){}]),angular.module("RMI.HomeCtrls",[]).controller("HomeCtrl",["$scope","$rootScope","$state","cmBackSvc",function(e,t,n,o){!function(){o.setUrl("#")}()}]).controller("IndexCtrl",["$scope","$http","$interval","AccountSvc","LoginSvc","FormSvc","ProcessSvc","$state","cmLoadingSvc","VERSION","cmLoginSvc",function(e,t,n,o,i,a,s,r,l,c,d){e.version="VERSION: "+c,e.currentUser=o.currentUser(),e.currentTime=new Date,e.quickGoProcessASN="";var u=n(function(){e.currentTime=new Date},1e3);e.funcAddArrivalForm=function(){l.setContent("收货报告创建中"),l.show(),a.requestCreate("ARRIVAL","ARRIVAL",0,"AR01").then(function(e){r.go("home.process.detailForm",{ArrivalSerialNumber:e.ArrivalSerialNumber,FormId:e.Id,Mode:"edit"})},function(e){l.setContent("创建过程发生错误，请检查网络连接"),console.log(e)})["finally"](function(){l.hide(750)})},e.funcQuickGoProcess=function(e){l.setContent("查询中...","inProgress"),l.show();var t=function(e){var t=/[0-9a-fA-F]{6}/;return t.test(e)};t(e)?s.fetchProcess(e).then(function(){l.setContent("转跳中..."),r.go("home.process.detailInfo",{ArrivalSerialNumber:e})},function(){l.setContent("该流水号不存在！")})["finally"](function(){l.hide()}):(l.setContent("流水号输入错误！","error"),l.hide())},e.$on("$destroy",function(){u&&n.cancel(u)})}]),angular.module("RMI.ControlCtrls",[]).controller("ControlBaseCtrl",["$scope","$rootScope","$state",function(e,t,n){e.uiIsInDesignCacheEdit=!1,e.state=n,t.$on("$stateChangeStart",function(t,n,o){e.uiIsInDesignCacheEdit=!!o.isEditCache})}]).controller("ControlDesignProcessCtrl",["$scope","$state","$q","cmLoadingSvc","ControlDesignSvc",function(e,t,n,o,i){e.processTypes=[],e.processTypes=[{Id:"X01",Class:"辅料",Name:"部件",Description:"描述信息描述信息描述信息描述信息描述信息描述信息"}],function(){o.setContent("正在加载所有流程列表","inProgress"),o.show(),i.fetchProcessTypes().then(function(t){e.processTypes=t,o.setContent("加载成功","success")},function(){o.setContent("加载失败")})["finally"](function(){o.hide(750)})}(),e.funcEditProcess=function(e,a){o.setContent("正在加载流程数据","inProgress"),o.show();var s=i.fetchProcessType(e,a),r=i.fetchProcessNodeTypes(e,a),l=n.all([s,r]);l.then(function(e){var n=e[0],a=e[1];angular.forEach(a,function(e){e.FormConfig=angular.fromJson(e.FormConfig)}),i.saveCacheConfig("process",a,n),o.setContent("加载完成","success"),t.go("home.control.designEditProcess",{isEditCache:"cache",loadItemType:void 0})},function(e){o.setContent("数据加载错误","error"),console.log(e)})["finally"](function(){o.hide(750)})}}]).controller("ControlDesignEditCtrl",["$scope","$state","$filter","$q","ControlDesignSvc","FormSvc","cmLoadingSvc",function(e,t,n,o,i,a,s){e.uiIsTable=!1,e.uiIsMap=!1,e.uiIsTableTemplateBaseShow=!1,e.uiIsMapTemplateBaseShow=!1,e.uiIsAddPanelShow=!1,e.uiIsEditCache=t.params.isEditCache?!0:!1;var r=i.getPresetConfig();e.configString="";var l="";"home.control.designEditMap"===t.current.name?(e.uiIsTable=!1,e.uiIsMap=!0,l="map"):"home.control.designEditTable"===t.current.name?(e.uiIsTable=!0,e.uiIsMap=!1,l="table"):"home.control.designEditForm"===t.current.name?l="form":"home.control.designEditProcess"===t.current.name&&(l="process"),e.generalConfig=r.general[l],e.itemConfig=r.item[l],e.itemConfigs=[],e.localConfigs=[],e.localConfigs=[{description:(new Date).getTime()},{description:(new Date).getTime()},{description:(new Date).getTime()}],function(n){if(!n)return 0;var o=i.getCacheConfig(l);angular.extend(e.generalConfig,o.content.general),angular.extend(e.itemConfigs,o.content.items),angular.extend(e.itemConfig,o.content.item);var a=t.params.loadItemType;("form"===a||"table"===a||"map"===a)&&angular.extend(e.itemConfig,i.getCacheItemConfigByChildConfig(a))}(!!t.params.isEditCache),e.funcSaveConfigsCacheAndBack=function(){if(s.setContent("正在保存编辑后的配置","inProgress"),s.show(),i.saveCacheConfig(l,e.itemConfigs,e.generalConfig),"map"===l||"table"===l)t.go("home.control.designEditForm",{isEditCache:"cache",loadItemType:l}),s.hide(750);else if("form"===l)t.go("home.control.designEditProcess",{isEditCache:"cache",loadItemType:l}),s.hide(750);else if("process"===l){var n=i.updateProcessType(e.generalConfig.Id,e.generalConfig),a=i.updateProcessNodeTypes(e.generalConfig.Id,e.itemConfigs),r=o.all([n,a]);r.then(function(){s.setContent("保存成功","success"),t.go("home.control.designProcess",{isEditCache:"cache"})},function(e){console.log(e),s.setContent("保存失败","error")})["finally"](function(){s.hide(750)})}};var c=null;e.funcLoadItemConfigToAddPanel=function(t,n){c=n,e.itemConfig=angular.copy(t),console.log("Current Editing:"+n)};var d=function(n){i.saveCacheConfig(l,e.itemConfigs,e.generalConfig,null),{form:function(){t.go("home.control.designEditForm",{isEditCache:"cache"})},table:function(){t.go("home.control.designEditTable",{isEditCache:"cache"})},map:function(){t.go("home.control.designEditMap",{isEditCache:"cache"})}}[n]()};e.funcGoEditItemConfig=function(t){var n=e.itemConfig,o=c;if(n)if("process"===l)i.saveItemCacheConfig("process",n),
i.saveCacheConfigByFatherConfig(n,"form",o);else if("form"===l){i.saveItemCacheConfig("form",n);var a=n.Type;"table"===a?i.saveCacheConfigByFatherConfig(n,"table",o):"map"===a&&i.saveCacheConfigByFatherConfig(n,"map",o)}d(t)},e.funcGoCreateItemConfig=function(e){d(e)},e.funcPackFormConfigString=function(e){var t=angular.fromJson(e),n={FormConfig:t};return angular.toJson(n)},e.funcLoadConfig=function(t){var n=angular.fromJson(t);angular.forEach(n,function(t,n){e.itemConfig[n]=t})},e.funcAddUpConfigs=function(){e.itemConfig.Order=e.itemConfigs.length+1,e.itemConfigs.push(angular.copy(e.itemConfig)),e.itemConfig=r.item[l]},e.funcReorderConfigs=function(){e.itemConfigs=n("orderBy")(e.itemConfigs,"Order"),angular.forEach(e.itemConfigs,function(e,t){e.Order=t+1})},e.funcDeleteFromConfigs=function(t){e.itemConfigs.splice(t,1)},e.funcAddProcessTypeIdToConfigs=function(){angular.forEach(e.itemConfigs,function(t){t.ProcessTypeId=e.generalConfig.Id,t.Rev=e.generalConfig.Rev})},e.funcAddDatabaseTableNameToFormConfigs=function(){var t="RMI_FORM_DATA_PROCESSTYPEID_REVREPLACE_REV_PROCESSNODETYPEID_COMPONENTORDER_TYPE";angular.forEach(e.itemConfigs,function(e){if("object"==typeof e.FormConfig){var n=t.replace(/PROCESSTYPEID/g,e.ProcessTypeId).replace(/PROCESSNODETYPEID/g,e.Id).replace(/REPLACE_REV/g,e.Rev);angular.forEach(e.FormConfig.Components,function(e){e.DatabaseTableName=n.replace(/ORDER/g,e.Order).replace(/TYPE/g,e.Type.toUpperCase())})}})},e.funcCreateProcessTypeAndProcessNodeTypes=function(){s.setContent("正在提交流程数据"),s.show(),e.funcAddProcessTypeIdToConfigs(),e.funcAddDatabaseTableNameToFormConfigs();var t=e.generalConfig,n=e.itemConfigs;angular.forEach(n,function(e){"string"!=typeof e.FormConfig,"number"==typeof e.Order&&(e.Order=e.Order.toString())});var a=i.createProcessType(t);console.log(n);var r=i.createProcessNodeTypes(n),l=o.all([a,r]);l.then(function(){s.setContent("提交成功！")},function(e){s.setContent("提交失败"),console.log("funcCreateProcessTypeAndProcessNodeTypes Error:"+e)})["finally"](function(){s.hide(750)})}}]).controller("ControlDesignClassificationCtrl",["$scope","$state","SQLQuerySvc","ControlDesignSvc","cmLoadingSvc",function(e,t,n,o,i){e.uiIsAddPanelShow=!1,e.OptionalProcessTypes=[],e.subclasses=[],e.subclass={Subclass:null,ProcessTypeId:null},e.funcSubmitSubclass=function(e){i.setContent("Creating subclass...","inProgress"),i.show(),console.log(e),e.Subclass&&e.ProcessTypeId?o.createSubclass(e).then(function(){i.setContent("Successfully.","success"),t.reload()},function(e){i.setContent("Error.","error"),console.error(e)})["finally"](function(){i.hide()}):(i.setContent("Config error, please check.","error"),i.hide(1e3))},e.funcRemoveSubclass=function(e){i.setContent("Deleting subclass...","inProgress"),i.show(),o.deleteSubclass(e).then(function(){i.setContent("Successfully.","success"),t.reload()},function(e){i.setContent("Error.","error"),console.error(e)})},function(){o.fetchProcessTypes().then(function(t){e.OptionalProcessTypes=t},function(){}),o.fetchSubclasses().then(function(t){e.subclasses=t})}()}]).controller("ControlDesignSourceCtrl",["$scope","ControlDesignSvc","cmLoadingSvc",function(e,t,n){e.uiIsAddPanelShow=!0,e.config={Description:"",Name:"",Type:"value",Value:""},e.configs=[],e.funcReadSources=function(){n.setContent("正在加载数据","inProgress"),n.show(),t.readSourcesFromKVStore().then(function(t){n.setContent("加载完成","success"),e.configs=t},function(){n.setContent("加载失败","error")})["finally"](function(){n.hide(750)})},e.funcCreateSource=function(){n.setContent("正在创建来源","inProgress"),n.show(),t.createSourceToKVStore(e.config).then(function(t){n.setContent("数据成功获取，重载页面值","success"),e.configs=t},function(e){n.setContent("创建失败","error")})["finally"](function(){n.hide(750)})},e.funcDeleteSource=function(o){n.setContent("正在删除来源","inProgress"),n.show(),t.deleteSourceFromKVStore(o).then(function(t){n.setContent("删除成功，重载页面值","success"),e.configs=t},function(e){n.setContent("删除失败","error")})["finally"](function(){n.hide(750)})},e.funcReadSources()}]).controller("ControlFeedbackCtrl",["$scope","ControlFeedbackSvc","cmLoadingSvc","AccountSvc",function(e,t,n,o){e.feedback={Subject:"",Content:"",SubmitTime:"",SubmitUserId:"",SubmitUserName:""},e.funcSubmitNewFeedback=function(e){e.SubmitTime=(new Date).getTime(),e.SubmitUserId=o.currentUser().Id,e.SubmitUserName=o.currentUser().Name,localStorage.setItem("Control.FeedBack."+(new Date).getTime(),angular.toJson(e)),n.setContent("正在提交您的反馈","inProgress"),n.show(),t.createFeedback(e).then(function(){n.setContent("感谢您提供反馈！","success")},function(e){n.setContent("服务器提交失败，已本地存储","error"),console.error(e)})["finally"](function(){n.hide(750)})}}]).controller("ControlUserCtrl",["$scope","formlyVersion","$uibModal","$http","SERVER_URL","cmLoadingSvc",function(e,t,n,o,i,a){function s(t){swal({title:"确认删除？",text:"此操作无法撤销",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!0},function(){e.myPromise=o.get(i+"users/"+t.ID+"/delete/").then(function(){var e=c.history.indexOf(t);c.history.splice(e,1),swal("删除成功","您所做的更改已生效","success")},function(){swal("删除失败","您所做的更改未生效","error")})["finally"](function(){})})}function r(e){return[{key:"ID",type:"input",ngModelAttrs:{myCustomValue:{bound:"ng-ng-readonly",attribute:"ng-readonly"}},templateOptions:{label:"工号",placeholder:"工号",required:!0,myCustomValue:!e}},{key:"Name",type:"input",templateOptions:{required:!0,label:"姓名",placeholder:"姓名"}},{key:"Password",type:"input",templateOptions:{required:!0,label:"密码",type:"password"}},{key:"DepartmentID",type:"select",templateOptions:{required:!0,label:"部门",options:c.departments}},{key:"JobID",type:"select",templateOptions:{required:!0,label:"职位",options:c.jobs}}]}function l(e,t){var o;t?(o=n.open({templateUrl:"app/interaction/control/user/modify.html",controller:"ControlUserModifyCtrl",controllerAs:"vm",resolve:{formData:function(){return{fields:r(!0),model:e}},isNew:!0}}).result,o.then(function(e){c.history.push(e)})):o=n.open({templateUrl:"app/interaction/control/user/modify.html",controller:"ControlUserModifyCtrl",controllerAs:"vm",resolve:{formData:function(){return{fields:r(!1),model:e}},isNew:!1},isNew:!1}).result}var c=this;c.edit=l,c.del=s,c.addNew=function(){var e={ID:null,Name:null,Password:null,DepartmentID:null,JobID:null};c.edit(e,!0)},e.myPromise=o.get(i+"users/",{responseType:"json"}).then(function(t){c.history=t.data,c.status="",e.myPromise=o.get(i+"users/departmentAndJob/").then(function(e){c.departments=e.data.Departments,c.jobs=e.data.Jobs},function(e){})},function(e){}),c.history=[],c.status="正在获取用户列表......",c.departments=[],c.jobs=[],c.formFields=r(!1)}]).controller("ControlUserModifyCtrl",["$scope","$http","formData","$uibModalInstance","SERVER_URL","isNew",function(e,t,n,o,i,a){function s(){console.log(l.formData.model);var n=angular.copy(l.formData.model);n.isNew=a,n.Permission="",e.myPromise=t.post(i+"users/"+n.ID+"/edit/","JSON="+JSON.stringify(n).replace("true",'"True"').replace("false",'"False"')).then(function(e){"0"==e.data?(swal("修改成功","用户需要重新登录以使更改生效","success"),o.close(l.formData.model)):"1"==e.data&&swal("工号已存在","您所做的修改未生效","error")},function(e){swal("发生错误","您所做的修改未生效","error")})["finally"]()}function r(){l.formData.options.resetModel(),o.dismiss("cancel")}var l=this;l.ok=s,l.cancel=r,l.hint="",l.formData=n,l.originalFields=angular.copy(l.formData.fields)}]).controller("ControlOperationCtrl",["$scope","$state","FormSvc","ControlOperationSvc","AccountSvc",function(e,t,n,o,i){e.operations=[],e.funcGo=function(e,o){"form"===e?n.fetchForm(o).then(function(e){t.go("home.process.detailForm",{ArrivalSerialNumber:e.ArrivalSerialNumber,FormId:o,Mode:"edit"})},function(){})["finally"]():"process"===e&&t.go("home.process.detailInfo",{ArrivalSerialNumber:o})},function(n){e.operations=[];var i=function(e){return{GET:"获取表单内容",POST:"创建新表单",PUT:"保存表单数据"}[e]};o.fetchOperations(n,t.params.top).then(function(t){angular.forEach(t,function(e){e.Description=i(e.Method)}),e.operations=t},function(e){console.error(e)})}(i.currentUser())}]),angular.module("RMI.checkFormListCtrls",["angularValidator"]).factory("JianYanGuiZe",["CHECK_ERROR_RULE",function(e){return{getCheckNum:function(t){for(var n=0;n<e.A.length;n++)if(t>=e.A[0]&&t<=e.A[1])return e.A[2];return null},getCiDianLegalNumF02:function(t,n,o){if(!t||!n||!o)return 1e6;var i=e[n];if("其他"==o)for(var a=0;a<i.length;a++)if(i[a][2]==parseFloat(t))return i[a][3];if("肩带"==o||"色纱带"==o||"其他织带"==o){var s=parseFloat(t)/50;return console.log("ZHIDAI:"+s),s+1e-9}},getJiFenLegalNumF02:function(e,t){return e&&t?"其他"==t?1e9:"肩带"==t?1*e/100+1e-5:"色纱带"==t?3*e/100+1e-5:"其他织带"==t?(console.log("!!!!!!!!!!!!!!!"),1*e/100+1e-5):1e9:1e9}}}]).controller("checkFormListCtrlAll",["$scope","$state","$http","SERVER_URL","cmBackSvc",function(e,t,n,o,i){function a(){console.log(t.current.url),"dataEntry"==t.params.Type?i.setUrl("#/Ins/Tasks/Dataentry"):i.setUrl("#/Ins/Tasks/Check"),e.myPromise=n.get(o+"inspect/"+t.params.ID+"/getTaskProcess/").then(function(t){e.formList=t.data}),e.formList=[]}e.formList=[],a();var s=1;e.addNew=function(){e.formList.unshift({name:"新增表单"+s.toString(),state:1}),s+=1},e.del=function(t){for(var n=0,o=0;o<e.formList.length;o++)if(t==e.formList[o]){n=o;break}e.formList.splice(o,1)},e.entry=function(e){t.go("home.forms"+e.ProcessID,{ProcessID:e.ProcessID,SerialNo:t.params.ID,Type:t.params.Type})}}]).controller("form1Ctrl",["$scope","$state","$http","SERVER_URL","cmBackSvc","AUTO_TAB_INTERVAL","$timeout","$element",function(e,t,n,o,i,a,s,r){function l(){i.setUrl("#/Ins/checkFormList/?ID="+t.params.SerialNo+"&Type="+t.params.Type),e.myPromise=n.get(o+"inspect/"+t.params.SerialNo+"/getF01Data/"+t.params.Type+"/").then(function(t){e.info=t.data.info;for(var n=angular.copy(t.data.data),o=0;o<n.listData.length;o++)n.listData[o].hasDingDanShu=n.listData[o].DingDanShu>=0&&null!=n.listData[o].DingDanShu,n.listData[o].hasTouChanShu=n.listData[o].TouChanShu>=0&&null!=n.listData[o].TouChanShu;e.data=n,e.calcDaoLiaoSum(e.data.listData),setTimeout(function(){$("select").each(function(){$(this).removeClass("ng-invalid").addClass("ng-untouched")}),$("input").each(function(){$(this).removeClass("ng-invalid").addClass("ng-untouched")})},200)})["finally"]()}console.log(t.params),e.info={},e.data={},e.stateType=t.params.Type,l(),e.hint="",e.sub=function(i,a){if(i){for(var s=document.getElementsByClassName("ng-invalid"),r=0;r<s.length;r++)("INPUT"==s[r].tagName||"SELECT"==s[r].tagName)&&(s[r].style.border="1px solid red");e.hint="*请填写红框框出的缺失必填字段或修改格式错误字段"}else{var l=(e.data.selectedStep,!1);if(!l){for(var c=angular.copy(e.data),r=0;r<c.listData.length;r++)c.listData[r].WaiGuan?c.listData[r].WaiGuan=1:c.listData[r].WaiGuan=0,c.listData[r].timer=null;c.isSubmit=a,a?swal({title:"请确认步骤是否完成?",text:"无论是否完成数据都会被保存",type:"warning",showCancelButton:!0,confirmButtonColor:"#00CC33",cancelButtonColor:"#DD6B55",confirmButtonText:"是",cancelButtonText:"否",closeOnConfirm:!0,closeOnCancel:!1},function(i){i||(c.isSubmit=!1),e.myPromise=n.post(o+"inspect/"+t.params.SerialNo+"/insertF01Data/","JSON="+JSON.stringify(c)).then(function(n){swal("修改成功","您所做的修改已生效","success"),e.myPromise=null,t.reload(1)},function(e){swal("修改失败","您所做的修改未生效","error")})["finally"]()}):e.myPromise=n.post(o+"inspect/"+t.params.SerialNo+"/insertF01Data/","JSON="+JSON.stringify(c)).then(function(n){swal("修改成功","您所做的修改已生效","success"),e.myPromise=null,t.reload(1)},function(e){swal("修改失败","您所做的修改未生效","error")})["finally"]()}}},e.del=function(t){for(var n,o=0;o<e.data.listData.length;o++)if(t==e.data.listData[o]){n=o;break}e.data.listData.splice(n,1)},e.valid=function(e,t,n){console.log(t),e.valid=e==n,console.log(e),console.log(e.valid)},e.add=function(){e.data.listData.push({GuiGe:null,BiaoZhiShu:null,ShiCeShu:null,HeGeShu:null,WaiGuan:!1,JianYanHao:e.data.default_jianyanhao?e.data.default_jianyanhao:null,QiTa:null,TouChanShu:null,DingDanShu:null,hasDingDanShu:e.data.listData[0]?e.data.listData[0].hasDingDanShu:!1,hasTouChanShu:e.data.listData[0]?e.data.listData[0].hasTouChanShu:!1,timer:null}),setTimeout(function(){document.getElementsByTagName("cm-side-menu-content")[0].scrollTop=1e4;for(var e=document.getElementById("data").getElementsByTagName("tr")[document.getElementById("data").getElementsByTagName("tr").length-1].getElementsByTagName("input"),t=0;t<e.length;t++)$(e[t]).addClass("ng-untouched").removeClass("ng-invalid"),0==t&&e[t].focus()},200)},e.onJianYanHaoDefaultChange=function(t){var n=e.data.listData;console.log(t);for(var o=0;o<n.length;o++)n[o].JianYanHao=t},e.calcDaoLiaoSum=function(t){for(var n=0,o=0;o<t.length;o++)console.log(t[o].HeGeShu),n+=t[o].HeGeShu?parseInt(t[o].HeGeShu):0;e.data.DaoLiaoZongShu=n},e.timer=null,e.stepNext=function(e,t){},e.pass=function(){e.myPromise=n.get(o+"inspect/"+t.params.SerialNo+"/passProcess/F01").then(function(){swal("成功","报表已审核通过","success"),t.reload()},function(){swal("失败","报表审核通过失败","error")})}}]).controller("form2Ctrl",["$scope","$state","$http","SERVER_URL","cmBackSvc","CHECK_ERROR_RULE","iaValidationFac","JianYanGuiZe",function(e,t,n,o,i,a,s,r){function l(){setTimeout(function(){"dataEntry"!=e.stateType&&($("input").each(function(e){console.log(this),this.setAttribute("ng-readonly","true")}),$("select").each(function(e){this.disabled=!0}));for(var i=[],a=document.getElementById("data").getElementsByTagName("tr")[0].childNodes,s=0;s<a.length;s++)for(var r=0;r<a[s].childNodes.length;r++)if(a[s].childNodes[r].getAttribute){var l=a[s].childNodes[r].getAttribute("ng-model");l&&i.push(l.split(".")[1])}e.myPromise=n.get(o+"inspect/"+t.params.SerialNo+"/getF02Data/"+t.params.Type).then(function(t){e.data=t.data.data;for(s in e.data)(i.indexOf(s)>0||"Id"==s||"InspectorNo"==s)&&delete e.data[s];for(var n=0;n<e.data.listData.length;n++){var o=e.data.listData[n];for(s in o)(i.indexOf(s)<0||"Id"==s||"InspectorNo"==s)&&"Inspector"!=s&&delete o[s]}console.log(e.data),e.info=t.data.info,e.calctotalSum(e.data.listData),e.data.XiangMuFlag=JSON.parse(e.data.XiangMuFlag),e.data.LeiBie="B"},function(e){})},200)}!function(){i.setUrl("#/Ins/checkFormList/?ID="+t.params.SerialNo+"&Type="+t.params.Type)}(),e.stateType=t.params.Type,e.validateScale=s.quickValid,e.data={listData:[{}]},e.getCheckNum=r.getCheckNum,l(),e.add=function(){e.data.listData.push({})},e.isWarningJiDian=function(e,t,n,o){return e&&t&&n?t>=r.getCiDianLegalNumF02(e,n,o):!1},e.isWarningJiFen=function(e,t,n){return e&&t&&n?(console.log(n),t>=r.getJiFenLegalNumF02(e,n)):!1},e.del=function(t){var n=e.data.listData.indexOf(t);e.data.listData.splice(n,1)},e.sub=function(i){var a=angular.copy(e.data);a.isSubmit=i,delete a.step;for(var s=0;s<a.listData.length;s++);i?swal({title:"请确认步骤是否完成?",text:"无论是否完成数据都会被保存",type:"warning",showCancelButton:!0,confirmButtonColor:"#00CC33",cancelButtonColor:"#DD6B55",confirmButtonText:"是",cancelButtonText:"否",closeOnConfirm:!0,closeOnCancel:!1},function(i){i||(a.isSubmit=!1),e.myPromise=n.post(o+"inspect/"+t.params.SerialNo+"/insertF02Data/","JSON="+JSON.stringify(a)).then(function(n){swal("修改成功","您所做的修改已生效","success"),e.myPromise=null,t.reload(1)},function(e){swal("修改失败","您所做的修改未生效","error")})["finally"]()}):e.myPromise=n.post(o+"inspect/"+t.params.SerialNo+"/insertF02Data/","JSON="+JSON.stringify(a)).then(function(n){swal("修改成功","您所做的修改已生效","success"),e.myPromise=null,t.reload(1)},function(e){swal("修改失败","您所做的修改未生效","error")})["finally"]()},e.pass=function(){e.myPromise=n.get(o+"inspect/"+t.params.SerialNo+"/passProcess/F02").then(function(){swal("成功","报表已审核通过","success"),t.reload()},function(){swal("失败","报表审核通过失败","error")})},e.totalCount=0,e.calctotalSum=function(t){e.totalCount=0;for(var n=0;n<t.length;n++)e.totalCount+=t[n].JianYanShu?parseInt(t[n].JianYanShu):0},e.comparePiBiaoShiCe=function(e,t){return parseFloat(e)>parseFloat(t)}}]),function(){angular.module("RMI",["ngAnimate","ngCookies","ngTouch","ngMessages","ui.router","ui.bootstrap","nya.bootstrap.select","textAngular","formly","formlyBootstrap","ngTable","ngResource","ui.checkbox","pretty-checkable","validation","cgBusy","RMI.PlayCtrls","RMI.HomeCtrls","RMI.ProcessCtrls","RMI.ControlCtrls","RMI.Validation","RMI.HomeServices","RMI.ProcessServices","RMI.ControlServices","RMI.UniversalServices","RMI.checkFormListCtrls","DEVBYCM.cmTemplateLoad","DEVBYCM.cmInput","DEVBYCM.cmSelect","DEVBYCM.cmCheckbox","DEVBYCM.cmRadio","DEVBYCM.cmToggle","DEVBYCM.cmTextarea","DEVBYCM.cmTable","DEVBYCM.cmBarcode","DEVBYCM.cmNavMenu","DEVBYCM.cmSideMenuBox","DEVBYCM.cmContentEditable","DEVBYCM.cmLoadingModule","DEVBYCM.cmNavBarModule","DEVBYCM.cmLoginModule","DEVBYCM.cmNotificationAreaModule"])}(),function(){function e(e){e.setWrapper({name:"heading",template:'<div class="cmFormCollection heading">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"fill-24",template:'<div style="height: 24px;width: 100%">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"label-left",template:'<div class="cmFormCollection label-left">\n  <div class="left-label">{{options.templateOptions.label}}</div>\n  <div class="right-separator"></div>\n  <div class="content">\n    <formly-transclude></formly-transclude>  \n  </div>\n</div>'}),e.setWrapper({name:"label-top",template:'<div class="cmFormCollection label-top">\n  <div class="top-label">{{options.templateOptions.label}}</div>\n  <div class="bottom-separator"></div>\n  <div class="content">\n    <formly-transclude></formly-transclude>\n  </div>\n</div>'}),e.setWrapper({name:"label-colon",template:'<div class="cmFormCollection label-colon">\n  <div class="colon-label">{{options.templateOptions.label}}</div>\n  <div class="content">\n    <formly-transclude></formly-transclude>  \n  </div>\n</div>'}),e.setWrapper({name:"border-top-right-left",template:'<div class="cmFormCollection border-top-right-left">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"border-bottom",template:'<div class="cmFormCollection border-bottom">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"flex-col",template:'<div class="cmFormCollection flex-col">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"flex-row",template:'<div class="cmFormCollection flex-row">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"flex-cols",template:'<div class="cmFormCollection flex-cols">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"flex-rows",template:'<div class="cmFormCollection flex-rows">\n    <formly-transclude></formly-transclude>\n</div>'})}e.$inject=["formlyConfigProvider"],angular.module("RMI").config(e)}(),function(){function e(e){function t(e){return e=e.replace(/[-_s]+(.)?/g,function(e,t){return t?t.toUpperCase():""}),e.replace(/^([A-Z])/,function(e,t){return t?t.toLowerCase():""})}e.setType({name:"richEditor",template:'<text-angular class="richTextAngular" ng-model="model[options.key || index]"></text-angular>'}),e.setType({name:"blank",template:"<div></div>"});var n='<div class="row"><div class=""><h4 class="text-center">{{options.templateOptions.placeholder}}<h4><hr/></div></div>';e.setType({name:"subTitle",template:n});var o='<div><label>{{options.templateOptions.label}}</label> <ol   class="nya-bs-select col-sm-12 col-xs-12 col-md-12 col-lg12"    ng-model="model[options.key || index]"     id="{{id}}"     disabled="options.templateOptions.options.length === 0">    <li class="nya-bs-option" nya-bs-option="option in options.templateOptions.options">      <a>{{option.name}}</a>    </li>  </ol> </div>';e.setType({name:"basicSelect",template:o});var i='<input ng-readonly="{{options.templateOptions.readonly}}">';e.setType({name:"readonlyAbleInput",template:i});var a='<div>  <label>{{options.templateOptions.label}}</label>  <ol class="nya-bs-select col-sm-12 col-xs-12 col-md-12 col-lg12"     ng-model="model[options.key || index]"        data-live-search="true"        disabled="options.templateOptions.options.length === 0">       <li nya-bs-option="option in  options.templateOptions.options group by option.group"         >         <span class="dropdown-header">{{$group}}</span>         <a>           <span>{{option.name}}</span>           <span class="glyphicon glyphicon-ok check-mark"></span>         </a>       </li>  </ol></div>';e.setType({name:"groupedSelect",template:a});var s=["date-disabled","custom-class","show-weeks","starting-day","init-date","min-mode","max-mode","format-day","format-month","format-year","format-day-header","format-day-title","format-month-title","year-range","shortcut-propagation","datepicker-popup","show-button-bar","current-text","clear-text","close-text","close-on-date-selection","datepicker-append-to-body"],r=["datepicker-mode","min-date","max-date"],l={};angular.forEach(s,function(e){l[t(e)]={attribute:e}}),angular.forEach(r,function(e){l[t(e)]={bound:e}}),e.setType({name:"datepicker",template:'<input  id="{{id}}" class="form-control" ng-click="open($event)" ng-model="model[options.key  || index]" is-open="to.isOpen" ng-click="to.isOpen = true" datepicker-options="to.datepickerOptions" />',wrapper:["bootstrapLabel","bootstrapHasError"],controller:["$scope",function(e){e.open=function(t){t.preventDefault(),t.stopPropagation(),e.opened=!0}}],defaultOptions:{ngModelAttrs:l,templateOptions:{addonLeft:{"class":"glyphicon glyphicon-calendar",onClick:function(e,t){e.templateOptions.isOpen=!e.templateOptions.isOpen}},onFocus:function(e,t,n){n.to.isOpen=!n.to.isOpen},datepickerOptions:{}}}})}e.$inject=["formlyConfigProvider"],angular.module("RMI").config(e)}(),function(){function e(e){e.setType({name:"cm-input",template:'<div class="cmFormCollection cmInput">\n  <label>\n    <div class="input-label">\n      {{options.templateOptions.label}}\n    </div>\n    <input type="{{options.templateOptions.type}}" ng-model="model[options.key]">\n  </label>\n</div>',link:function(e){}}),e.setType({name:"cm-select",template:'<div class="cmFormCollection cmSelect" style="width: {{options.templateOptions.width}}">\n  <label>\n    {{options.templateOptions.label}}\n  </label>\n  <div>\n    <div>\n      <ol class="nya-bs-select" ng-model="model[options.key || index]"\n          style="width: {{options.templateOptions.selectWidth}}"\n          title="请选择"\n          live-search="options.templateOptions.liveSearch===\'true\'"\n          disabled="options.templateOptions.options.length === 0">\n        <li ng-show="options.templateOptions.group"\n            nya-bs-option="option in  options.templateOptions.options group by option.group"\n            data-value="option.value"\n        >\n          <span class="dropdown-header">{{$group}}</span>\n          <a><span>{{option.name}}</span><span class="">1</span></a></li>\n        <li ng-show="!options.templateOptions.group"\n            nya-bs-option="option in  options.templateOptions.options"\n            data-value="option.value"\n        ><span\n          class="dropdown-header">{{$group}}</span>\n          <a><span>{{option.name}}</span><span class="">1</span></a></li>\n      </ol>\n    </div>\n  </div>\n</div>'}),e.setType({name:"cm-table",template:'<cm-formly-table model="model[options.key]" to="to" templateOptions="templateOptions"></cm-formly-table>'})}e.$inject=["formlyConfigProvider"];var t=1;angular.module("RMI").config(e).directive("cmFormlyTable",function(){return{restrict:"E",template:'<div class="cmFormCollection cmTable {{hideRepeat}} cm-animation-fade" style="{{uiIsEmptyTableInitial?\'min-height:163px;max-height:163px;\':\'\'}}">\n  <div class="loading-mask" ng-if="uiIsEmptyTableInitial">\n    <div class="text">Loading...</div>\n  </div>\n  <div>\n    <header class="table-head">\n      <div style="min-width: {{rowModifyClassWidth+\'px\'}};max-width: {{rowModifyClassWidth+\'px\'}};height: 100%;"></div>\n      <div class="head-cell" ng-repeat="cell in tableHeadCells track by $index" style="width: {{cell.width+\'px\'}}">\n        {{cell.name}}\n      </div>\n    </header>\n    <section class="table-body">\n      <div class="table-row" ng-repeat="element in model" ng-init="fields = funcCopyFields(to.fields)">\n        <div class="row-modify">\n          <a ng-click="funcRemoveWithConfirm($index)">删除</a>\n        </div>\n        <formly-form class="row-content" fields="fields" model="element" form="form"></formly-form>\n      </div>\n      <div class="table-row-no-content" ng-show="model.length===0">暂无内容</div>\n    </section>\n    <footer class="table-foot">\n      <div class="addNewRowButton">\n        <button type="button" class="btn btn-block btn-primary" ng-click="funcPushWithBringDown()">添加新的项目</button>\n      </div>\n    </footer>\n  </div>\n</div>',replace:!0,scope:{model:"=",to:"=",templateOptions:"="},link:function(e,t){var n=function(){setTimeout(function(){e.rowModifyClassWidth=$($(t).find(".row-modify")[0]).outerWidth(!0);var n=$(t).find(".formly")[0],o=$(n).find(".formly-field");e.tableHeadCells=o.map(function(){return{width:$(this).outerWidth(!0)}}).get(),angular.forEach(e.tableHeadCells,function(t,n){var o=e.to.fields[n].key;angular.forEach(e.to.relation,function(e){e.key===o&&(t.name=e.name)})}),e.$digest()},0)};$(window).bind("resize",function(){t.ready(function(){n()})}),setInterval(function(){t.ready(function(){n()})},750),e.$watch(function(){return angular.isUndefined(e.model)?0:e.model.length},function(){e.uiIsLoading=!0,setTimeout(function(){var n=$(t).find(".formly");n.map(function(o){$(this).find(".formly-field").map(function(){var i=$(this).next();$(this).find("input").unbind("keypress"),$(this).find("input").bind("keypress",function(a){var s=function(o,i){i-1>=o?$(n[o+1]).find(".formly-field").find("input").first().focus():(e.funcPushWithBringDown(),e.$apply(),r=$(t).find(".formly"),$(r[o+1]).find(".formly-field").find("input").first().focus())},r=null;if(a.ctrlKey===!0&&10===a.keyCode)a.preventDefault(),s(o,n.length-1);else if(13===a.keyCode){a.preventDefault();var l=i.find("input");l.length?l.focus():s(o,n.length-1)}})})}),setTimeout(function(){e.uiIsLoading=!1,e.$digest()},0)},0)}),e.uiIsEmptyTableInitial=!e.model,e.uiIsLoading=!0,e.funcPush(),setTimeout(function(){n(),e.funcPop(),e.uiIsEmptyTableInitial=!1,setInterval(function(){e.uiIsInitial=!1},0)},0)},controller:["$scope",function(e){function n(e){return e=angular.copy(e),o(e),e}function o(e){t++,angular.forEach(e,function(e,n){return e.fieldGroup?void o(e.fieldGroup):(e.templateOptions&&e.templateOptions.fields&&o(e.templateOptions.fields),void(e.id=e.id||e.key+"_"+n+"_"+t+i(0,9999)))})}function i(e,t){return Math.floor(Math.random()*(t-e))+e}e.formOptions={formState:e.formState},e.funcRemoveWithConfirm=function(t){var n=confirm("您确定要删除这一项吗？");n&&e.funcRemove(t)},e.funcRemove=function(t){e.model.splice(t,1)},e.funcPop=function(){e.model.pop()},e.funcPush=function(){e.model=e.model||[],e.model.push({})},e.funcPushWithBringDown=function(){e.model=e.model||[];var t=e.model,n=t[t.length-1],o={};n&&angular.forEach(e.to.bringDown,function(e){n[e.key]&&(o[e.key]=angular.copy(n[e.key]))}),t.push(o)},e.funcCopyFields=n}]}})}(),function(){function e(e){e.debug("runBlock end")}e.$inject=["$log"],angular.module("RMI").run(e)}(),function(){function e(e,t){e.state("home",{url:"/",views:{"":{templateUrl:"app/interaction/dashboard/index.html",controller:"HomeCtrl"},"main@home":{templateUrl:"app/interaction/dashboard/main.html",controller:"IndexCtrl"}}}).state("home.playground",{url:"Playground",views:{"main@home":{templateUrl:"app/interaction/playground/main.html",controller:"PlaygroundCtrl",controllerAs:"vm"}}}).state("home.process",{"abstract":!0,url:"Ins",views:{"main@home":{template:'<div ui-view=""></div>'}}}).state("home.process.detailInfo",{url:"/:ArrivalSerialNumber/Info/",templateUrl:"app/interaction/process/detail/info.html",controller:"ProcessDetailInfoCtrl"}).state("home.process.detailForm",{url:"/:ArrivalSerialNumber/Form/:FormId/?Mode",templateUrl:"app/interaction/process/detail/base.html",controller:"ProcessDetailFormCtrl"}).state("home.process.formListCheck",{url:"/Tasks/Check",templateUrl:"app/interaction/process/list/base.html",controller:"ProcessListCtrl"}).state("home.process.formListDataentry",{url:"/Tasks/Dataentry",templateUrl:"app/interaction/process/list/base.html",controller:"ProcessListCtrl"}).state("home.process.processList",{url:"/:Class/P/:ProcessTypeId-:Rev/?IsComplete",templateUrl:"app/interaction/process/list/base.html",controller:"ProcessListCtrl"}).state("home.process.checkFormList",{url:"/checkFormList/?:ID:/?:Type:/",templateUrl:"app/interaction/checkforms/formListAll.html",controller:"checkFormListCtrlAll"}).state("home.control",{"abstract":!0,url:"Control",views:{"main@home":{templateUrl:"app/interaction/control/base.html",controller:"ControlBaseCtrl"}}}).state("home.control.designProcess",{url:"/design/process/",templateUrl:"app/interaction/control/design/process.html",controller:"ControlDesignProcessCtrl"}).state("home.control.designEditProcess",{url:"/design/edit/process/?isEditCache&loadItemType",templateUrl:"app/interaction/control/design/edit/process.html",controller:"ControlDesignEditCtrl"}).state("home.control.designEditForm",{url:"/design/edit/form/?isEditCache&loadItemType",templateUrl:"app/interaction/control/design/edit/form.html",controller:"ControlDesignEditCtrl"}).state("home.control.designEditTable",{url:"/design/edit/table/?isEditCache",templateUrl:"app/interaction/control/design/edit/table.html",controller:"ControlDesignEditCtrl"}).state("home.control.designEditMap",{url:"/design/edit/map/?isEditCache",templateUrl:"app/interaction/control/design/edit/map.html",controller:"ControlDesignEditCtrl"}).state("home.control.designClassification",{url:"/design/classification/",templateUrl:"app/interaction/control/design/classification.html",controller:"ControlDesignClassificationCtrl"}).state("home.control.designSource",{url:"/design/source/",templateUrl:"app/interaction/control/design/source.html",controller:"ControlDesignSourceCtrl"}).state("home.control.feedbackNew",{url:"/feedback/new/",templateUrl:"app/interaction/control/feedback/new.html",controller:"ControlFeedbackCtrl"}).state("home.control.user",{url:"/user/",templateUrl:"app/interaction/control/user/all.html",controller:"ControlUserCtrl"}).state("home.control.operationRecord",{url:"/operation/record/?top",templateUrl:"app/interaction/control/operation/record.html",controller:"ControlOperationCtrl"}).state("home.formsF01",{url:"forms01/:ProcessID/:SerialNo/:Type",views:{"main@home":{templateUrl:"app/interaction/checkforms/forms/form1.html",controller:"form1Ctrl"}}}).state("home.formsF02",{url:"forms02/:ProcessID/:SerialNo/:Type",views:{"main@home":{templateUrl:"app/interaction/checkforms/forms/form2.html",controller:"form2Ctrl"}}}),t.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("RMI").config(e)}(),function(){angular.module("RMI").constant("malarkey",malarkey).constant("moment",moment).constant("SERVER_URL","/api/").constant("VERSION","1512.22.218").constant("ALL_FLOW_ID","B6EB0ACF-7C31-44F5-AE44-931EE2FF90A2").constant("AUTO_TAB_INTERVAL",5e3).constant("CHECK_ERROR_RULE",{A:[[2,8,2,1],[9,15,3,1],[16,25,5,2],[26,50,8,2],[51,90,13,3],[91,150,20,4],[151,280,32,6],[281,500,50,8],[501,1200,80,11],[1201,3200,125,15],[3201,1e4,200,22],[10001,35e3,315,22],[35001,15e4,500,22],[150001,5e5,800,22]],B:[[2,8,2,2],[9,15,3,2],[16,25,5,2],[26,50,8,3],[51,90,13,4],[91,150,20,6],[151,280,32,8],[281,500,50,11],[501,1200,80,15],[1201,3200,125,22],[3201,1e4,200,22],[10001,35e3,315,22],[35001,15e4,500,22],[150001,5e5,800,22]]})}(),function(){angular.module("RMI").config(["nyaBsConfigProvider",function(e){e.setLocalizedText("zh-cn",{defaultNoneSelection:"",noSearchResult:"没有结果",numberItemSelected:"选中%d项"}),e.useLocale("zh-cn")}])}(),angular.module("RMI.Validation",[]).factory("iaValidationFac",["$rootScope",function(e){var t=[{label:"mm",weight:1},{label:"cm",weight:10},{label:"m",weight:1e3
},{label:"g",weight:1},{label:"kg",weight:1e3}],n=function(e,t,n,i,a){var s=0,r=0;return"%"==i?(s=e*(1-.01*t),r=e*(1+.01*t),s=o(s,n,a),r=o(r,n,a),[s,r]):(e=o(e,n,a),t=o(t,i,a),[e-t,e+t])},o=function(e,n,o){var i=1,a=1,s=1;console.log("value:"+e);for(var r=0;r<t.length;r++)t[r].label==n&&(console.log("valueScale:"+t[r].label),a=t[r].weight),t[r].label==o&&(console.log("targetScale:"+t[r].label),s=t[r].weight);return i=a/s,console.log("ratio"+i.toString()),e*i},i=function(e,t,i,a,s,r){var l=n(parseFloat(e),parseFloat(i),t,a,t);console.log(l);var c=o(s,r,t);return c>=l[0]&&c<=l[1]};return{valid:i,calcRange:n,convertRange:o,quickValid:function(e,t,n){if(!e||!t||!n)return!0;var o="mm|cm|m|g|kg|%",a=parseFloat(e),s=parseFloat(t),r=parseFloat(n),l=e.toString().match(o)?e.match(o)[0]:"",c=t.toString().match(o)?t.match(o)[0]:"",d=n.toString().match(o)?n.match(o)[0]:l;return console.log("------------devSca:"+c),i(a,l,s,c,r,d)}}}]),angular.module("DEVBYCM.cmTemplateLoad",[]).directive("cmTemplateLoad",["UtilSvc","$templateCache",function(e,t){return{restrict:"E",template:'<div ng-include="templateUrl"></div>',scope:{model:"=",template:"@"},replace:!0,link:function(n){n.templateUrl="cmTemplateLoad"+e.random(16,8,!0,!1)+".html",t.put(n.templateUrl,n.template),n.$on("$destroy",function(){t.remove(n.templateUrl)})}}}]),angular.module("DEVBYCM.cmContentEditable",[]).directive("cmcontenteditable",["$timeout",function(e){return{restrict:"A",require:"?ngModel",terminal:!0,link:function(t,n,o,i){if(i){var a={};angular.forEach(["stripBr","noLineBreaks","selectNonEditable","moveCaretToEndOnChange"],function(e){var t=o[e];a[e]=t&&"false"!==t}),n.bind("input",function(o){t.$apply(function(){var t,o,s;t=n.html(),s=!1,a.stripBr&&(t=t.replace(/<br>$/,"")),a.noLineBreaks&&(o=t.replace(/<div>/g,"").replace(/<br>/g,"").replace(/<\/div>/g,""),o!==t&&(s=!0,t=o)),i.$setViewValue(t),s&&i.$render(),""===t&&e(function(){n[0].blur(),n[0].focus()})})});var s=i.$render;i.$render=function(){var e,t,o,r;s&&s(),n.html(i.$viewValue||""),a.moveCaretToEndOnChange&&(e=n[0],o=document.createRange(),r=window.getSelection(),e.childNodes.length>0?(t=e.childNodes[e.childNodes.length-1],o.setStartAfter(t)):o.setStartAfter(e),o.collapse(!0),r.removeAllRanges(),r.addRange(o))},a.selectNonEditable&&n.bind("click",function(e){var t,n,o;o=e.toElement,o!==this&&"false"===angular.element(o).attr("contenteditable")&&(t=document.createRange(),n=window.getSelection(),t.setStartBefore(o),t.setEndAfter(o),n.removeAllRanges(),n.addRange(t))})}}}}]),angular.module("DEVBYCM.cmBarcode",[]).directive("cmBarcode",function(){return{restrict:"E",template:'<img src="">',scope:{value:"="},replace:!0,link:function(e,t){var n={width:2,height:80,quite:0,format:"CODE128",displayValue:!0,font:"Consolas",textAlign:"center",fontSize:17,backgroundColor:"",lineColor:"#000"};e.$watch(function(){return e.value},function(e){e&&JsBarcode(t[0],e,n)},!0)}}}),angular.module("DEVBYCM.cmToggle",[]).directive("cmToggle",["UtilSvc",function(e){return{restrict:"E",template:'<div class="cmFormCollection cmToggle">\n  <label>\n    {{label}}<input type="checkbox" ng-model="model">\n  </label>\n</div>',scope:{model:"=",label:"@"},replace:!0,link:function(e,t){}}}]),angular.module("DEVBYCM.cmTextarea",[]).directive("cmTextarea",function(){return{restrict:"E",template:'<div class="cmFormCollection cmTextarea">\n  <label>\n    <textarea ng-model="model"></textarea>\n  </label>\n</div>',scope:{model:"=",required:"="},replace:!0,link:function(e,t){}}}),angular.module("DEVBYCM.cmTable",[]).directive("cmTable",function(){return{restrict:"E",template:"<table>\n  <thead></thead>\n  <tbody></tbody>\n  <tfoot></tfoot>\n</table>",scope:{},replace:!0,link:function(e,t){}}}),angular.module("DEVBYCM.cmSelect",[]).directive("cmSelect",function(){return{restrict:"E",template:'<div class="cmFormCollection cmSelect" style="width: {{width}}">\n  <label>\n    {{label}}\n  </label>\n  <div>\n    <div>\n      <ol class="nya-bs-select" ng-model="model"\n          style="width: {{selectWidth}}"\n          title="请选择"\n          live-search="liveSearch===\'true\'"\n          disabled="options.length === 0">\n        <li ng-show="group"\n            nya-bs-option="option in  options group by option.group"\n            data-value="option.value"\n        >\n          <span class="dropdown-header">{{$group}}</span>\n          <a><span>{{option.name}}</span><span class="">1</span></a></li>\n        <li ng-show="!group"\n            nya-bs-option="option in  options"\n            data-value="option.value"\n        ><span\n          class="dropdown-header">{{$group}}</span>\n          <a><span>{{option.name}}</span><span class="">1</span></a></li>\n      </ol>\n    </div>\n  </div>\n</div>',scope:{model:"=",options:"=",width:"@",label:"@",liveSearch:"@"},replace:!0,link:function(e,t){}}}),angular.module("DEVBYCM.cmRadio",[]).directive("cmRadio",["UtilSvc",function(e){return{restrict:"E",template:'<div class="cmFormCollection cmRadio">\n  <label ng-repeat="option in options">\n    <input type="radio" name="{{name}}" ng-init="value[$index]=model" ng-model="value[$index]" ng-click="funcUpdateModel(value[$index])" ng-value="option">{{option}}\n  </label>\n</div>',scope:{model:"=",options:"="},replace:!0,link:function(t,n){t.name=e.random(16,8,!0,!1),t.funcUpdateModel=function(e){t.model=e}}}}]),angular.module("DEVBYCM.cmInput",[]).directive("cmInput",function(){return{restrict:"E",template:'<div class="cmFormCollection cmInput">\n  <label>\n    <input type="{{type}}" ng-model="model" required="{{required}}">\n  </label>\n</div>',scope:{model:"=",type:"@",required:"="},replace:!0,link:function(e,t){}}}),angular.module("DEVBYCM.cmCheckbox",[]).directive("cmCheckbox",["UtilSvc",function(e){return{restrict:"E",template:'<div class="cmFormCollection cmCheckbox">\n  <label ng-repeat="option in options">\n    <input type="checkbox" ng-model="value[$index]" ng-click="funcUpdateModel(value[$index],index,option)" ng-value="option">{{option}}\n  </label>\n</div>',scope:{model:"=",options:"="},replace:!0,link:function(t){angular.isArray(t.model)||(t.model=[]),t.name=e.random(16,8,!0,!1);var n=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;console.log("Cant find item in the array.")};t.funcUpdateModel=function(e,o,i){e?t.model.push(i):angular.isNumber(n(t.model,i))&&t.model.splice(n(t.model,i),1)}}}}]),angular.module("RMI.UniversalServices",[]).factory("UtilSvc",function(){return{random:function(e,t,n,o){if(1>e||e>36||0>t||t>16)return console.log("UtilSvc.random Error: radix="+e+" digit="+t+" isUppercase="+n+" isFillZero="+o),-1;var i=Math.round(Math.random()*Math.pow(e,t)).toString(e).toLowerCase();return n&&(i=i.toUpperCase()),o&&i.length!==t-1&&(i+=new Array(t-i.length).join("0")),i}}}).factory("KVStoreSvc",["$rootScope","$q","$http","SERVER_URL",function(e,t,n,o){var i=o+"kvstore/";return{create:function(e,o){var a=t.defer();return n.post(i+e+"/",angular.toJson(o)).success(function(e){a.resolve(angular.fromJson(e))}).error(function(e){a.reject(e)}),a.promise},read:function(e){var o=t.defer();return n.get(i+e+"/").success(function(e){o.resolve(angular.fromJson(e))}).error(function(e){o.reject(e)}),o.promise},update:function(e,o){var a=t.defer();return n.put(i+e+"/",angular.toJson(o)).success(function(e){a.resolve(angular.fromJson(e))}).error(function(e){a.reject(e)}),a.promise},"delete":function(e){var o=t.defer();return n["delete"](i+e+"/").success(function(e){o.resolve(angular.fromJson(e))}).error(function(e){o.reject(e)}),o.promise}}}]).factory("SQLQuerySvc",["$q","$http","SERVER_URL",function(e,t,n){return{query:function(o){var i=e.defer();return t.get(n+"sqlquery",{params:{sql:o}}).success(function(e){i.resolve(e)}).error(function(e){i.reject(e)}),i.promise}}}]),angular.module("RMI.ProcessServices",[]).factory("FormSvc",["$http","$rootScope","$state","$timeout","$q","SERVER_URL",function(e,t,n,o,i,a){return{stateParamsToFormTypeId:function(e){return{daohuo:{shouhuobaogao:"A01"},zhuliao:{waiguan:"B01",lihua:"B02",shimoya:"B03",yanseshougan:"B04",zhuliaoruku:"B05"},fuliao:{shangbiao:"C01",bugantie:"C02",zhika:"C03",huabian:"C04",goupan:"C05",tiaojiekou:"C06",jiandai:"C07",songjindai:"C08"}}[e["class"]][e.type]},fetchForms:function(t,n,o){var s=i.defer();return e.get(a+"forms/",{params:{ProcessTypeId:t,Rev:n,ProcessNodeTypeId:o}}).success(function(e){angular.forEach(e,function(e){e.Parameter&&angular.isString(e.Parameter)&&(e.Parameter=angular.fromJson(e.Parameter))}),s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},fetchForm:function(t){var n=i.defer();return e.get(a+"forms/"+t+"/").success(function(e){e.Parameter&&angular.isString(e.Parameter)&&(e.Parameter=angular.fromJson(e.Parameter)),n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},fetchFormData:function(t){var n=i.defer();return e.get(a+"forms/"+t+"/data/").success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},fetchFormConfig:function(t){var n=i.defer();return e.get(a+"forms/"+t+"/config/").success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},saveFormDataToServer:function(t,n,o){var s=i.defer();return e.put(a+"forms/"+t+"/data/",n,{params:{autoSave:o}}).success(function(){s.resolve()}).error(function(e){s.reject(e)}),s.promise},requestCreate:function(t,n,o,s){var r=i.defer();return e.post(a+"forms/",{ArrivalSerialNumber:t,create:"true",ProcessTypeId:n,Rev:0,ProcessNodeTypeId:s,Status:"2"}).success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise},requestCancelEdit:function(t){var n=i.defer();return e.post(a+"forms/"+t+"/",{Status:"1"}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},requestEdit:function(t){var n=i.defer();return e.post(a+"forms/"+t+"/",{Status:"2"}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},requestConfirm:function(t){var n=i.defer();return e.post(a+"forms/"+t+"/",{Status:"3"}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},requestSubmit:function(t){var n=i.defer();return e.post(a+"forms/"+t+"/",{Status:"4"}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},requestAddToArrival:function(t){var n=i.defer();return e.post(a+"forms/"+t+"/",{addToArrival:"true"}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},requestAddToArrivalAndAddToProcess:function(t){var n=i.defer();return e.post(a+"forms/"+t+"/",{reAddToArrivalAndAddToProcess:"true"}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},requestSubmitAndAddToArrival:function(t){var n=this,o=i.defer();return e.post(a+"forms/"+t+"/",{Status:"4"}).success(function(e){n.requestAddToArrival(t).then(function(){o.resolve(e)},function(e){o.reject(e)})}).error(function(e){o.reject(e)}),o.promise},requestSubmitAndAddToArrivalAndAddToProcess:function(t){var n=this,o=i.defer();return e.post(a+"forms/"+t+"/",{Status:"4"}).success(function(){n.requestAddToArrivalAndAddToProcess(t).then(function(e){o.resolve(e)},function(e){o.reject(e)})}).error(function(e){o.reject(e)}),o.promise},updateFormTags:function(t,n){var o=i.defer();return e.put(a+"forms/"+t+"/tags/",n).success(function(e){o.resolve(angular.fromJson(e))}).error(function(e){o.reject(e)}),o.promise}}}]).factory("ProcessSvc",["SERVER_URL","$q","$http",function(e,t,n){var o=function(e){return angular.forEach(e,function(e){angular.forEach(e.Nodes,function(e){angular.isArray(e.Form.Tags)||(e.Form.Tags=angular.fromJson(e.Form.Tags))})}),e};return{_DEPRECATED_fetchArrivals:function(o){var i=t.defer();return n.get(e+"arrivals/",{params:{Class:o}}).success(function(e){i.resolve(e)}).error(function(e){i.reject(e)}),i.promise},_DEPRECATED_fetchProcessesByClass:function(i){var a=t.defer();return n.get(e+"processes/",{params:{Class:i}}).success(function(e){a.resolve(o(e))}).error(function(e){a.reject(e)}),a.promise},_DEPRECATED_requestAddToProcess:function(o){var i=t.defer();return n.post(e+"arrivals/"+o+"/",{addToProcess:"true"}).success(function(){i.resolve()}).error(function(e){i.reject(e)}),i.promise},_DEPRECATED_requestAddAllToProcess:function(){var o=t.defer();return n.post(e+"arrivals/",{addToProcess:"true"}).success(function(){o.resolve()}).error(function(e){o.reject(e)}),o.promise},fetchProcessTypesByClass:function(o){var i=t.defer();return n.get(e+"processtypes/",{params:{Class:o},cache:!0}).success(function(e){i.resolve(e)}).error(function(e){i.reject(e)}),i.promise},fetchProcess:function(i){var a=t.defer();return n.get(e+"processes/"+i+"/").success(function(e){a.resolve(o([e])[0])}).error(function(e){a.reject(e)}),a.promise},fetchProcessesByProcessTypeIdAndRev:function(i,a,s){var r=t.defer();return n.get(e+"processes/",{params:{ProcessTypeId:i,Rev:a,IsComplete:s.IsComplete}}).success(function(e){r.resolve(o(e))}).error(function(e){r.reject(e)}),r.promise},fetchProcessReference:function(o){var i=t.defer();return n.get(e+"processes/"+o+"/references/").success(function(e){angular.isArray(e)||(e=angular.fromJson(e)),i.resolve(e)}).error(function(e){i.reject(e)}),i.promise},updateProcessCheckStatus:function(o,i){var a=t.defer();return n.put(e+"processes/"+o+"/checkstatus",i).success(function(){a.resolve()}).error(function(e){a.reject(e)}),a.promise},updateProcessIsComplete:function(o,i){i===!0&&(i="true"),i===!1&&(i="false"),("true"!==i||"false"!==i||"waiting"!==i)&&console.warn("IsComplete Value error: "+i),i=angular.toJson(i);var a=t.defer();return n.put(e+"processes/"+o+"/iscomplete",i).success(function(){a.resolve()}).error(function(e){a.reject(e)}),a.promise},fetchProcessNodeTypes:function(o,i){var a=t.defer();return n.get(e+"processtypes/"+o+"/processnodetypes/",{params:{Rev:i}}).success(function(e){a.resolve(e)}).error(function(e){a.reject(e)}),a.promise},updateProcessNodeAvailableFlag:function(o,i,a){var s=t.defer();return n.put(e+"processes/"+o+"/processnodes/"+i+"/availableflag",a).success(function(){s.resolve()}).error(function(e){s.reject(e)}),s.promise},updateProcessNodeCheckStatus:function(o,i,a){var s=t.defer();return n.put(e+"processes/"+o+"/processnodes/"+i+"/checkstatus",a).success(function(){s.resolve()}).error(function(e){s.reject(e)}),s.promise},updateProcessNodeConclusion:function(o,i,a){var s=t.defer();return n.put(e+"processes/"+o+"/processnodes/"+i+"/conclusion",a).success(function(){s.resolve()}).error(function(e){s.reject(e)}),s.promise}}}]).filter("FormStatusFilter",function(){return function(e){switch(e){case"0":return"未创建";case"1":return"待编辑";case"2":return"正在编辑";case"3":return"确认可提交";case"4":return"已提交";case void 0:return"未创建";default:return"读取出错"}}}).filter("TrueFalseShiFouFilter",function(){return function(e){return"true"===e?"是":"false"===e?"否":e===!0?"是":"否"}}).filter("ProcessNodeStatusFilter",function(){return function(e,t,n,o){if(n=+n,o=+o,o||(o=0),n||(n=0),t){if(angular.isUndefined(n))return"可用";switch(n=parseInt(n)){case 0:return"可用";case 1:return"可用";case 2:return"编辑中";case 3:return"编辑中";case 4:switch(o){case 0:return"待审核";case 1:return"已完成";case 2:return"审核不通过"}return"待审核"}return t+n+o}return"不可用"}}).filter("ProcessIsCompleteFilter",function(){return function(e){switch(e=angular.lowercase(e)){case"true":return"是";case"false":return"否";case"waiting":return"等待最终审核";default:console.warn("IsComplete value error: "+e)}}}).filter("ProcessNodeAvailableFlagFilter",function(){return function(e){switch(e){case"default":return"自动开启";case"true":return"手动开启";case"false":return"手动禁用"}return e}}),angular.module("RMI.ControlServices",[]).factory("ControlDesignSvc",["$http","$rootScope","$timeout","$q","SERVER_URL","KVStoreSvc",function(e,t,n,o,i,a){var s="Form.Source",r={general:{process:{Id:"X01",Name:"",Rev:0,Class:"辅料",CompleteCondition:"PN01.Status=4",Reference:'[{"Id":"arrival","Name":"shbg","Order":1,"Visible":true,"Components":[{"Order":1,"Visible":true,"Type":"table","Query":"select * from 123132","Data":[{"a":11,"b":22}],"Relation":{"a":"yi","b":"er"}},{"Order":2,"Visible":true,"Type":"map","Data":{"a":11,"b":22},"Relation":{"a":"yi","b":"er"}},{"Order":3,"Visible":true,"Type":"html","Data":"<div>1</div>"}]}]'},form:{OptionalTags:["Error.A","Error.B","Error.C"]},map:{Type:"map",Style:"flex",Show:"true",QuickInitial:"(function(ref,util){var data={}; return data;})"},table:{Type:"table",Show:"true",QuickInitial:"(function(ref,util){var data=[]; return data;})"}},item:{process:{Id:"",Order:null,Name:"",ProcessTypeId:"",Rev:"",Description:"",AvailableCondition:"1",FormConfig:[]},form:{Order:null,Type:"map",Style:"flex",Show:"true",Config:"",DatabaseTableName:""},map:{Order:null,Name:"",LeftDescription:"",RightDescription:"",AttributeName:"",Row:"",Group:"",Width:"",Type:"text",Sources:[],Options:[],min:null,max:null,ngMinlength:null,ngMaxlength:null,ngPattern:null,ngTrim:!0,required:!0,disabled:!1,ngRequired:!0,ngDisabled:!1,ngChange:""},table:{Order:null,Name:"",AttributeName:"",Row:"",Group:"",Width:"",Type:"text",Sources:[],Options:[],min:null,max:null,ngMinlength:null,ngMaxlength:null,ngPattern:null,ngTrim:!0,required:!0,disabled:!1,ngRequired:!0,ngDisabled:!1,ngChange:""}}},l={table:{order:null,active:!1,content:{general:r.general.table,item:r.item.table,items:[]}},map:{order:"",active:!1,content:{general:r.general.map,item:r.item.map,items:[]}},form:{order:null,active:!1,content:{general:r.general.form,item:r.item.form,items:[]}},process:{order:null,active:!1,content:{general:r.general.process,item:r.item.process,items:[]}}};return{getPresetConfig:function(){return r},getCacheConfig:function(e){return l[e]},getCacheItemConfigByChildConfig:function(e){return{map:function(e){var t=e.content.general;return t.Config=e.content.items,t},table:function(e){var t=e.content.general;return t.Config=e.content.items,t},form:function(e){var t={FormConfig:{}};return t.FormConfig=e.content.general,t.FormConfig.Components=e.content.items,t}}[e](l[e])},saveItemCacheConfig:function(e,t){t?l[e].content.item=t:0},saveCacheConfig:function(e,t,n,o){l[e].content.items=t,n?l[e].content.general=n:0,o?l[e].order=o:0},saveCacheConfigByFatherConfig:function(e,t,n){var o={map:function(e){return{general:function(){var t=angular.copy(e);return delete t.Config,t}(),items:function(){return e.Config}()}},table:function(e){return{general:function(){var t=angular.copy(e);return delete t.Config,t}(),items:e.Config}},form:function(e){return{general:function(){var t=angular.copy(e.FormConfig);return delete t.Components,t}(),items:e.FormConfig.Components}},process:function(e){return{items:e}}},i=o[t](e);this.saveCacheConfig(t,i.items,i.general,n)},fetchProcessTypes:function(){var t=o.defer();return e.get(i+"processtypes/").success(function(e){t.resolve(e)}).error(function(e){t.reject(e)}),t.promise},fetchProcessType:function(t){var n=o.defer();return e.get(i+"processtypes/"+t+"/",{params:{Rev:0}}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},fetchProcessNodeTypes:function(t,n){var a=o.defer();return e.get(i+"processtypes/"+t+"/processnodetypes/",{params:{Rev:n}}).success(function(e){a.resolve(e)}).error(function(e){a.reject(e)}),a.promise},createProcessType:function(t){var n=o.defer();return e.post(i+"processtypes/"+t.Id+"/",t).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},updateProcessType:function(t,n){var a=o.defer();return e.put(i+"processtypes/"+t+"/",n).success(function(e){a.resolve(e)}).error(function(e){a.reject(e)}),a.promise},createProcessNodeType:function(t){var n=o.defer();return e.post(i+"processtypes/"+t.ProcessTypeId+"/processnodetypes/"+t.Id+"/",t).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},createProcessNodeTypes:function(t){var n=o.defer();return e.post(i+"processtypes/"+t[0].ProcessTypeId+"/processnodetypes/",t).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},updateProcessNodeTypes:function(e,t){return this.createProcessNodeTypes(t)},fetchSubclasses:function(){var t=o.defer();return e.get(i+"processtypes/subclasses/").success(function(e){t.resolve(e)}).error(function(e){t.reject(e)}),t.promise},createSubclass:function(t){var n=o.defer();return e.post(i+"processtypes/subclasses/",t).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},deleteSubclass:function(t){var n=o.defer();return e["delete"](i+"processtypes/subclasses/"+t+"/").success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},createSourceToKVStore:function(e){var t=o.defer();return a.read(s).then(function(n){angular.forEach(n,function(e){e.Name===n.Name&&t.reject("Sources Name Existed.")}),a.update(s,n.concat([e])).then(function(e){t.resolve(e)},function(e){t.reject(e)})},function(e){t.reject(e)}),t.promise},deleteSourceFromKVStore:function(e){var t=o.defer();return a.read(s).then(function(n){angular.forEach(n,function(t,o){t.Name===e&&n.splice(o,1)}),a.update(s,n).then(function(e){t.resolve(e)},function(e){t.reject(e)})},function(e){t.reject(e)}),t.promise},readSourcesFromKVStore:function(){var e=o.defer();return a.read(s).then(function(t){e.resolve(t)},function(t){e.reject(t)}),e.promise}}}]).factory("ControlFeedbackSvc",["$http","$q","SERVER_URL",function(e,t,n){return{createFeedback:function(o){var i=t.defer();return e.post(n+"feedback/",o).success(function(e){i.resolve(e)}).error(function(e){i.reject(e)}),i.promise}}}]).factory("ControlOperationSvc",["$http","$q","SERVER_URL",function(e,t,n){return{fetchOperations:function(o,i){i||(i=1e3),o="User";var a=t.defer();return e.get(n+"users/"+o+"/operations/",{params:{top:i}}).success(function(e){a.resolve(e)}).error(function(e){a.reject(e)}),a.promise}}}]).factory("ControlUserSvc",["$http","$q","SERVER_URL",function(e,t,n){return{fetchUsers:function(){var o=t.defer();return e.get(n+"users/").success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise}}}]).filter("FormProcessChineseFilter",function(){return function(e){return"form"===e||"Form"===e?"表单":"process"===e||"Process"===e?"表单":void 0}}),angular.module("RMI.HomeServices",[]).factory("LoginSvc",["$q","$http","$state","SERVER_URL","cmLoginSvc","AccountSvc","$interval","$timeout",function(e,t,n,o,i,a,s,r){var l="false";l="true"==document.cookie.split("=")[1];var c=document.location.hash;console.log(document.cookie);var d=function(){l===!1&&(document.location.hash="#",i.show())};return r(function(){d()}),s(function(){d()},3e5),{isLoggedIn:function(){return l},login:function(n,i){var s=e.defer();return t.post(o+"users/"+n+"/login/",{Id:n,Password:i}).success(function(e){l=!0,a.setCurrentUser(e),localStorage.setItem("LoginSvc.isLoggedIn",!0),document.cookie="isLoggedin=true",s.resolve(e),console.log(c),"#/"!=c?document.location.hash=c:document.location.hash="#/Ins/Tasks/Dataentry"}).error(function(e){s.reject(e)}),s.promise},logout:function(){var n=a.currentUser().ID,i=e.defer();return t.post(o+"users/"+n+"/logout/").success(function(){l=!1,localStorage.setItem("LoginSvc.isLoggedIn",!1),i.resolve(),r(function(){d()},1e3)}).error(function(){i.reject()}),i.promise},getSavedUsers:function(){var e=angular.fromJson(localStorage.getItem("Account.SavedUsers"));return angular.isArray(e)||(e=[]),e},setSavedUsers:function(e){angular.isArray(e)&&localStorage.setItem("Account.SavedUsers",angular.toJson(e))}}}]).factory("AccountSvc",["$state","$rootScope",function(e,t){var n={Username:"未登录",Id:"?",Department:"?",Job:"?"},o=angular.copy(n);o=JSON.parse(localStorage.getItem("Account.currentUser")),console.log(o);var i=function(){return[]},a=function(e){var t={"home.control.designProcess":"Permission.UI.Control.EditProcess","home.control.designEditProcess":"Permission.UI.Control.EditProcess","home.control.designEditForm":"Permission.UI.Control.EditProcess","home.control.designEditTable":"Permission.UI.Control.EditProcess","home.control.designEditMap":"Permission.UI.Control.EditProcess","home.control.designSource":"Permission.UI.Control.EditProcess"},n=i(),o=function(e,t){if(angular.isArray(e)){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}return console.error("Param set not an array."),!1},a=!0;return angular.forEach(t,function(t,i){e.name===i&&(a=o(n,t))}),a};t.$on("$stateChangeStart",function(e,t,n){a(t,n)||(alert("您没有权限查看此页面！\n如有疑问，请于系统管理->问题反馈中提交您的反馈"),e.preventDefault())});var s=function(){return{"UserSetting.UI.Process.List.DefaultProcessType":{"收货":{Enable:!1,ProcessTypeId:"AR01",Rev:0},"主料":{Enable:!1,ProcessTypeId:"R01",Rev:0},"辅料":{Enable:!1,ProcessTypeId:"R02",Rev:0}}}}();return{currentUser:function(){return o},getCurrentUser:function(){return o},setCurrentUser:function(e){o=e,localStorage.setItem("Account.currentUser",angular.toJson(e))},getUserSetting:function(e){return s[e]?s[e]:void 0},setUserSetting:function(e,t){s[e]=t}}}]),angular.module("RMI").run(["$templateCache",function(e){e.put("app/interaction/checkforms/formListAll.html",'<cm-side-menu-box><cm-side-menu style="width: 60px"><style>\n      .form-list-hero {\n        text-align: center;\n      }\n\n      .center {\n        text-align: center;\n      }\n      .formItem {\n\n      }\n      .formcontent {\n        border: 1px solid rgb(221, 221, 221);\n        margin: 5px 5px 5px 5px;\n      }\n\n      .formcontent:hover {\n        border: 3px solid rgb(225, 225, 225);\n        margin: 3px 3px 3px 3px;\n      }\n\n      .big-icon:hover {\n        transform: scale(1.2);\n        -webkit-transform: scale(1.2);\n        -moz-transform: scale(1.2);\n        -o-transform: scale(1.2);\n        -ms-transform: scale(1.2);\n\n      }\n\n      .big-icon {\n        transition: All 0.4s ease-in-out;\n        -webkit-transition: All 0.4s ease-in-out;\n        -moz-transition: All 0.4s ease-in-out;\n        -o-transition: All 0.4s ease-in-out;\n\n      }\n\n      .progress {\n        margin: 20px\n      }\n    </style></cm-side-menu><cm-side-menu-content style="left:60px" cg-busy="{promise:myPromise,message:\'请稍后...\'}"><cm-side-menu-content-header><section class="title"><h2>表格列表</h2></section><section class="toolbar"><a href="#" class="btn btn-link"><span class="ion-home"></span> 回到主页</a></section></cm-side-menu-content-header><section>{{$state.params}}<div class="col-md-3 center formItem" ng-repeat="form in formList" style="padding:5px 5px 5px 5px"><div class="formcontent"><button class="btn btn-link pull-left" ng-click="del(form)" ng-show="false">删除</button><hr style="visibility: hidden"><div class="form-list-hero"><button title="填写表单" class="btn btn-link big-icon" ng-click="entry(form)"><span style="" ng-style="{\'font-size\': \'150px\',\'color\':\'#000066\'}" class="ion-clipboard"></span></button></div><h4>{{form.name}}</h4><p style="color:#999999;font-size: 12px">最近由{{form.modifyPeople}}于{{form.modifyTime}}修改</p><hr><div class="hint_area"><div class="progress"><div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="1" aria-valuemin="1" aria-valuemax="3" ng-style="{width:form.states+\'%\'}"><span style="font-color:black" ng-show="form.states >= 20">{{form.currentState}}</span></div><span style="font-color:black" ng-show="form.states <20">{{form.currentState}}</span></div></div></div></div></section></cm-side-menu-content></cm-side-menu-box>'),e.put("app/interaction/control/base.html",'<cm-side-menu-box><cm-side-menu><section class="category"><h4>流程表单设计</h4><ul><li ui-sref-active="active" ui-sref="home.control.designClassification">检验任务分配规则</li></ul><h4>使用管理</h4><ul><li ui-sref-active="active" ui-sref="home.control.user">用户管理</li><li ui-sref-active="active" ui-sref="home.control.operationRecord({top:500})">操作记录</li></ul><h4>问题反馈</h4><ul><li ui-sref-active="active" ui-sref="home.control.feedbackNew">提交新问题</li></ul></section></cm-side-menu><div ui-view=""></div></cm-side-menu-box>'),e.put("app/interaction/dashboard/index.html",'<style>\r\n  .home-container{\r\n    position: fixed;\r\n    /*border-top: 1px dashed #DEDEDE;*/\r\n    border-top: 2px solid #dddddd;\r\n/*    top: 28px;right: 28px;\r\n    bottom: 28px;left: 28px;\r\n    border: 1px solid rgba(0, 90, 161, 0.4);\r\n    box-shadow: 0 0 15px rgba(102, 175, 233, 0.4);*/\r\n    top: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    left: 0;\r\n  }\r\n  .content-container{\r\n    position: absolute;\r\n    /*top: 45px;*/\r\n    top: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    left: 0;\r\n\r\n  }\r\n  .navbar{\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    left: 0;\r\n  }\r\n  .main{\r\n    /*padding-top: 52px;*/\r\n  }\r\n</style><div class="home-container"><cm-login></cm-login><cm-loading></cm-loading><cm-nav-menu></cm-nav-menu><div class="content-container"><div class="main" ui-view="main"></div></div></div>'),e.put("app/interaction/dashboard/main.html",'<cm-side-menu-box><cm-side-menu><section class="category"><h4>登录信息</h4><ul><li>姓名：{{currentUser.Name}}</li><li>工号：{{currentUser.ID}}</li></ul></section><section class="category"><br><h4>快捷信息</h4><ul><li ng-click="$parent.role=\'luruyuan\'">仓库收货</li><li ng-click="$parent.role=\'zhuliaojianyanyuan\'">主料检验</li><li ng-click="$parent.role=\'fuliaojianyanyuan\'">辅料检验</li></ul></section><section class="category" ng-if="false"><h4>消息通知</h4><ul><li>新数据提示 12</li></ul></section></cm-side-menu><cm-side-menu-content class="tmp-home-main"><cm-side-menu-content-header><section class="title"><h2 title="{{version}}">美山子原材料检验系统</h2></section><section class="toolbar"><div class="button" ui-sref="home.control.feedbackNew">意见反馈</div><cm-person></cm-person></section></cm-side-menu-content-header><article><header><div class="jumbotron"><h3><span class="ion-arrow-right-b" style="padding-right: 16px"></span>欢迎回来，{{currentUser.Name}} !</h3><p>现在是{{currentTime | date:\' yyyy年MM月dd日 HH:mm:ss \'}}，下面是与您相关的一些信息。</p><form class="form-inline" style="margin: 4px auto 14px auto" ng-submit="funcQuickGoProcess(quickGoProcessASN)"><div class="form-group"><label class="sr-only"></label><div class="input-group"><div class="input-group-addon">流程编号</div><input type="text" class="form-control" ng-model="quickGoProcessASN" autofocus=""></div></div><button type="submit" class="btn btn-primary">快速跳转</button></form></div></header><section ng-init="role=\'luruyuan\'" class="card-list"><div ng-show="role===\'luruyuan\'" class="row"><div class="col-sm-4"><div class="card card-block" ng-click="funcAddArrivalForm()"><h3 class="card-title">添加收货报告</h3><p class="card-text">点此添加新的收货报告记录</p></div></div><div class="col-sm-4"><div class="card card-block" ui-sref="home.process.formList({ \'Class\': \'收货\', \'ProcessTypeId\':\'ARRIVAL\', \'ProcessNodeTypeId\':undefined })"><h3 class="card-title">查看收货列表</h3><p class="card-text">浏览已经创建的收货报告</p></div></div><div class="col-sm-4" ui-sref="home.control.operationRecord({\'top\':500})"><div class="card card-block"><h3 class="card-title">查看操作记录</h3><p class="card-text">查阅您的最近的修改记录</p></div></div></div><div ng-show="role===\'zhuliaojianyanyuan\'" class="row"><div class="col-sm-4"><div class="card card-block" ui-sref="home.process.processList({ \'Class\': \'主料\', \'ProcessTypeId\':undefined, \'ProcessNodeTypeId\':undefined, \'Rev\':undefined })"><h3 class="card-title">查看主料检验队列</h3><p class="card-text">查看待检验材料并进行检验录入</p></div></div><div class="col-sm-4" ui-sref="home.control.operationRecord({\'top\':500})"><div class="card card-block"><h3 class="card-title">查看操作记录</h3><p class="card-text">查阅您的最近的修改记录</p></div></div></div><div ng-show="role===\'fuliaojianyanyuan\'" class="row"><div class="col-sm-4"><div class="card card-block" ui-sref="home.process.processList({ \'Class\': \'辅料\', \'ProcessTypeId\':undefined, \'ProcessNodeTypeId\':undefined, \'Rev\':undefined })"><h3 class="card-title">查看辅料检验队列</h3><p class="card-text">查看待检验材料并进行检验录入</p></div></div><div class="col-sm-4" ui-sref="home.control.operationRecord({\'top\':500})"><div class="card card-block"><h3 class="card-title">查看操作记录</h3><p class="card-text">查阅您的最近的修改记录</p></div></div></div></section><br></article></cm-side-menu-content></cm-side-menu-box>'),e.put("app/interaction/playground/main.html",""),
e.put("app/components/ui/cmLoading/template.html",'<div class="cmLoading"><div class="shade" ng-if="isShow"></div><div class="loading cm-animation-fade" ng-if="false"><div class="spinner spinner-lines"><svg viewbox="0 0 64 64"><g stroke-width="7" stroke-linecap="round"><line x1="10" x2="10" y2="48" y1="16"></line><animate attributename="y1" dur="750ms" values="16;18;28;18;16;16" repeatcount="indefinite"></animate><animate attributename="y2" dur="750ms" values="48;46;36;44;48;48" repeatcount="indefinite"></animate><animate attributename="stroke-opacity" dur="750ms" values="1;.4;.5;.8;1;1" repeatcount="indefinite"></animate><line x1="24" x2="24" y2="45.3897" y1="17.3052"></line><animate attributename="y1" dur="750ms" values="16;16;18;28;18;16" repeatcount="indefinite"></animate><animate attributename="y2" dur="750ms" values="48;48;46;36;44;48" repeatcount="indefinite"></animate><animate attributename="stroke-opacity" dur="750ms" values="1;1;.4;.5;.8;1" repeatcount="indefinite"></animate><line x1="38" x2="38" y2="38.7793" y1="24.5258"></line><animate attributename="y1" dur="750ms" values="18;16;16;18;28;18" repeatcount="indefinite"></animate><animate attributename="y2" dur="750ms" values="44;48;48;46;36;44" repeatcount="indefinite"></animate><animate attributename="stroke-opacity" dur="750ms" values=".8;1;1;.4;.5;.8" repeatcount="indefinite"></animate><line x1="52" x2="52" y2="42.5258" y1="21.4742"></line><animate attributename="y1" dur="750ms" values="28;18;16;16;18;28" repeatcount="indefinite"></animate><animate attributename="y2" dur="750ms" values="36;44;48;48;46;36" repeatcount="indefinite"></animate><animate attributename="stroke-opacity" dur="750ms" values=".5;.8;1;1;.4;.5" repeatcount="indefinite"></animate></g></svg></div></div><div class="pane cm-animation-fade" ng-if="isShow"><div class="content"><span ng-if="status===\'inProgress\'"></span> <span ng-if="status===\'success\'"></span> <span ng-if="status===\'error\'"></span> {{content}}</div></div></div>'),e.put("app/components/ui/cmLogin/template.html",'<div class="cmLogin"><div class="shade" ng-if="isShow" ng-click="funcTryToClose()"></div><div class="pane-a cm-animation-fade" ng-if="isShow"><header style="position: relative;"><div class="close-button ion-ios-close" ng-show="isLoggedIn" ng-click="funcTryToClose()"></div><br><br><div style="text-align: center"><h3 style="text-shadow:0 0 2px #DDDDDD">美山子原材料检验</h3></div></header><div class="content" ng-controller="cmLoginCtrl" ng-switch="uiWhichPanel"><section class="switchPanel" ng-switch-when="switch"><div class="avatar-group"><div class="avatar" ng-repeat="user in savedUsers" ng-mouseleave="uiCurrentHoverIndex=null" ng-mouseenter="uiCurrentHoverIndex=$index"><div class="remove ion-ios-close" ng-show="user.Username&&uiCurrentHoverIndex===$index" ng-click="funcRemoveUser($index)"></div><div ng-click="funcDisplayUserLogin(user)"><img ng-src="{{user.Avatar}}"><div class="name" ng-show="user.Username&&uiCurrentHoverIndex===$index">{{user.Username}}</div></div></div></div><br><div class="description" ng-show="savedUsers.length>0">请选择一个用户以登录<span ng-show="savedUsers.length<4">，<a ng-click="funcDisplayNewUserLogin()">或添加一个</a></span></div><div class="description" ng-show="!savedUsers.length>0">还没有存储的用户<span ng-show="savedUsers.length<4">，<a ng-click="funcDisplayNewUserLogin()">点此添加一个</a></span></div></section><section class="loginPanel" ng-switch-when="login"><form ng-submit="funcLogin()"><div class="center"><div style="margin-right: 25px"><div class="avatar" ng-mouseenter="uiIsHover=true" ng-mouseleave="uiIsHover=false"><img ng-src="{{selectedUser.Avatar}}"><div class="name" ng-show="uiIsHover">{{selectedUser.Username}}</div></div></div><div class="login-form {{uiIsInputError?\'has-error\':\'\'}}"><div><label><input type="text" class="form-control above" ng-model="selectedUser.ID" ng-change="funcCancelInputErrorMark();funcUserIdChanged()" autofocus="" placeholder="工号" required="" ng-disabled="uiIsLoggingIn"></label></div><hr><div><label><input type="password" class="form-control below" ng-model="selectedUser.Password" ng-change="funcCancelInputErrorMark()" placeholder="密码" required="" ng-disabled="uiIsLoggingIn"></label></div><div class="options"><label><input type="checkbox" value="true" checked="checked" ng-model="selectedUser.AutoUpdateSavedUser" ng-disabled="uiIsLoggingIn"> <span>保存登录凭证</span></label> <label ng-show="savedUsers.length>0"><span ng-show="uiIsLoggingIn">其他用户</span> <a ng-show="!uiIsLoggingIn" ng-click="funcCancelInputErrorMark();funcDisplayUserSwitch()">其他用户</a></label></div></div></div><div class="form-group"><br><button type="submit" class="btn btn-primary login-button" ng-disabled="uiIsLoggingIn"><span ng-show="!uiIsLoggingIn">登录</span> <span ng-show="uiIsLoggingIn">正在登录中...</span></button></div></form></section><section class="successPanel" ng-switch-when="success"><div class="success"><span class="ion-checkmark-round"></span>登录成功！1秒后返回</div></section></div></div></div>'),e.put("app/components/ui/cmNavBar/template.html",'<div class="cmNavBar" ng-controller="cmNavBarCtrl"><div class="nav-part hide-style"><span ng-show="destType===\'state\'" class="icon button ion-android-arrow-back {{canGoBack?\'active\':\'\'}}" ng-click="goBack()"></span> <a ng-show="destType===\'url\'" ng-href="{{url}}" class="icon button ion-android-arrow-back {{canGoBack?\'active\':\'\'}}"></a> <a ng-show="destType===\'null\'" class="icon button ion-android-arrow-back"></a><div class="current" ng-click="toggleMenu()"><span class="icon {{menuItem.icon||\'ion-ios-photos-outline\'}}"></span> <span class="text">{{menuItem.title||"其他"}}</span> <span class="down"></span> <span class="down ion-ios-arrow-down"></span></div></div><div class="title-part" ng-if="false"><div><span class="title">{{title}}</span></div><div><span class="button active">{{$state.$current.name}}</span> <span class="button active" ng-if="">反馈</span></div></div></div>'),e.put("app/components/ui/cmNavMenu/template.html",'<div class="cmNavMenu"><div class="shade" ng-if="show" ng-click="close()"></div><div class="triangle cm-animation-fade" ng-if="show"></div><div class="navMenu cm-animation-fade" ng-if="show"><div class="content"><div class="block"><div class="item" ng-repeat="i in menuItems" ng-click="goAndClose(i.state,i.params)" ng-show="i.show"><div class="icon {{i.icon}}"></div><div class="label">{{i.label}}</div></div></div></div></div></div>'),e.put("app/components/ui/cmNotificationArea/template.html",'<div class="cmNotificationArea"><div class="button {{uiIsPanelShow?\'active\':\'\'}}" ng-click="uiIsPanelShow=!uiIsPanelShow"><div class="item"><span class="ion-android-person"></span>{{currentUser.Name}}</div></div><div class="panel" ng-show="uiIsPanelShow"><div class="option" ng-click="funcSwitchUser()">切换用户</div><div class="option" ng-click="funcLogout()">退出登录</div></div></div>'),e.put("app/components/ui/cmSideMenuBox/template.html",'<div ng-transclude=""></div>'),e.put("app/interaction/checkforms/forms/form1.html",'<cm-side-menu-box cg-busy="{promise:myPromise,message:\'请稍后...\'}"><cm-side-menu style="width: 60px"></cm-side-menu><cm-side-menu-content style="left:60px"><cm-side-menu-content-header><section class="title"><h2>商标、纸卡、不干贴检收记录</h2></section><section class="toolbar"><a href="#" class="btn btn-link"><span class="ion-home"></span> 回到主页</a></section></cm-side-menu-content-header><section><form name="form" novalidate=""><center><h3>商标、纸卡、不干贴检收记录</h3></center><div class="row"><div class="col-xs-3">到料日期：<span>{{info.ArriveTime | date:\'yyyy-MM-dd\'}}</span></div><div class="col-xs-3">货号：<span>{{info.ProductNo}}</span></div><div class="col-xs-3">色号：<span>{{info.ColorNo}}</span></div><div class="col-xs-3">供应商/客户：<input type="text" style="max-width: 50px;max-height: 21px" ng-model="data.GongYingShang" class="inline-input" ng-readonly="stateType != \'dataEntry\'"></div></div><div class="row" style="margin-top: 10px"><div class="col-xs-3">到料总数：<span>{{data.DaoLiaoZongShu}}</span></div><div class="col-xs-3">订单号：<input ng-readonly="stateType != \'dataEntry\'" type="text" style="max-width: 100px;max-height: 21px" name="dingdanhao" ng-model="data.DingDanHao" required="" class="inline-input"></div><div class="col-xs-3" ng-show="stateType == \'dataEntry\'">步骤选择*:<select ng-model="data.selectedStep" required=""><option value="{{x.value}}" ng-repeat="x in data.step | filter:{name:\'!审核\'}">{{x.name}}</option></select></div><div class="col-xs-3">种类*:<select required="" ng-model="data.SelectedType" ng-disabled="stateType != \'dataEntry\'"><option value="商标">商标</option><option value="纸卡">纸卡</option><option value="不干贴">不干贴</option><option value="其他">其他</option></select></div></div><hr><table class="table table-bordered table-condensed"><thead><tr><th>规格*</th><th>投产数/订单数</th><th>标识数</th><th>实测数</th><th>合格数*</th><th>外观</th><th>检验号</th><th>其它</th><th ng-hide="stateType != \'dataEntry\'">操作</th><th ng-show="stateType != \'dataEntry\'">填写人</th></tr></thead><tbody id="data"><tr ng-repeat="row in data.listData"><td><input ng-readonly="stateType != \'dataEntry\'" name="GuiGe{{$index}}" class="inline-input short" placeholder="规格" type="text" required="" ng-class="{error:row.GuiGe.$error}" ng-model="row.GuiGe"></td><td style="max-width: 170px;min-width: 170px"><input type="checkbox" ng-model="row.hasDingDanShu" ng-disabled="stateType != \'dataEntry\'">订单数 <input type="number" ng-readonly="stateType != \'dataEntry\'" class="inline-input short" ng-pattern="/^[0-9]*[1-9][0-9]*$/" ng-model="row.DingDanShu" ng-show="row.hasDingDanShu" ng-disabled="!row.hasDingDanShu"> <input type="checkbox" ng-model="row.hasTouChanShu" ng-disabled="stateType != \'dataEntry\'">投产数 <input type="number" ng-readonly="stateType != \'dataEntry\'" class="inline-input short" ng-pattern="/^[0-9]*[1-9][0-9]*$/" ng-model="row.TouChanShu" ng-show="row.hasTouChanShu" ng-disabled="!row.hasTouChanShu"></td><td><input ng-readonly="stateType != \'dataEntry\'" type="number" placeholder="标识数" ng-pattern="/^[0-9]*[1-9][0-9]*$/" ng-change="stepNext(row,3)" class="inline-input short" min="1" ng-model="row.BiaoZhiShu"></td><td><input ng-readonly="stateType != \'dataEntry\'" type="number" name="shiceshu" placeholder="实测数" ng-pattern="/^[0-9]*[1-9][0-9]*$/" class="inline-input short" ng-model="row.ShiCeShu"></td><td style="max-width: 80px;min-width: 80px"><input ng-readonly="stateType != \'dataEntry\'" name="HeGeShu{{$index}}" type="number" placeholder="合格数" required="" ng-pattern="/^[0-9]*[1-9][0-9]*$/" ng-change="calcDaoLiaoSum(data.listData)" class="inline-input short" ng-class="{warning:row.HeGeShu<(row.TouChanShu||row.DingDanShu||row.BiaoZhiShu)}" ng-model="row.HeGeShu"> <span ng-if="row.HeGeShu<(row.TouChanShu||row.DingDanShu||row.BiaoZhiShu)" style="color: red">缺{{(row.TouChanShu||row.DingDanShu||row.BiaoZhiShu)-row.HeGeShu}}件</span></td><td><input ng-disabled="stateType != \'dataEntry\'" type="checkbox" class="inline-input short" ng-model="row.WaiGuan">OK</td><td><input ng-readonly="stateType != \'dataEntry\'" type="text" placeholder="检验号" class="inline-input short" ng-model="row.JianYanHao"></td><td><input ng-readonly="stateType != \'dataEntry\'" type="text" placeholder="其他" class="inline-input" style="width: 95%" ng-model="row.QiTa"></td><td ng-hide="stateType != \'dataEntry\'"><a class="btn btn-link" ng-click="del(row)">删除</a></td><td ng-show="stateType != \'dataEntry\'">{{row.Inspector}}</td></tr></tbody><tfoot><tr><td colspan="8">默认检验号：<input ng-readonly="stateType != \'dataEntry\'" type="text" style="max-width: 100px;max-height: 21px" name="jianyanhao" ng-model="data.default_jianyanhao" class="inline-input" ng-change="onJianYanHaoDefaultChange(data.default_jianyanhao)"></td><td colspan="1"><button ng-click="add()" ng-hide="stateType != \'dataEntry\'" class="btn btn-link">添加</button></td></tr></tfoot></table><span style="color: grey" ng-show="stateType == \'dataEntry\'">带*的项目为必填项，填写错误的项目会用红色的方框圈出</span> <span ng-show="stateType != \'dataEntry\' && check">审批人：{{info.Assessor}}于{{info.AssessTime}}审批</span><button class="btn btn-default pull-right" ng-disabled="!form.$valid" ng-show="stateType == \'dataEntry\'" ng-click="sub(form.$invalid,true)"><span class="ion-checkmark"></span> 提交</button> <button style="margin-right: 10px" class="btn btn-default pull-right" ng-disabled="!form.$valid" ng-show="stateType == \'dataEntry\'" ng-click="sub(form.$invalid,false)"><span class="ion-archive"></span> 保存</button><section ng-show="stateType != \'dataEntry\' && !info.check"><button style="margin-right: 10px" class="btn btn-default pull-right" ng-click="pass()"><span class="ion-checkmark"></span> 通过</button></section><span style="color: grey" ng-show="info.check && stateType != \'dataEntry\'">已通过，审批人：{{info.Assessor}}，审批时间：{{info.AssessTime}}</span></form></section></cm-side-menu-content></cm-side-menu-box><style>\n  .inline-input {\n    border-top: hidden;\n    border-left: hidden;\n    border-right: hidden;\n    border-bottom: 1px solid black;\n\n  }\n\n  .short {\n    max-width: 60px;\n  }\n\n  input.ng-invalid {\n    border: 1px solid red;\n  }\n\n  select.ng-invalid {\n    border: 1px solid red;\n  }\n\n  .ng-untouched {\n    border-top: hidden;\n    border-left: hidden;\n    border-right: hidden;\n    border-bottom: 1px solid black;\n  }\n\n  .warning{\n    border: 1px solid olive;\n  }\n\n\n</style>'),e.put("app/interaction/checkforms/forms/form2.html",'<cm-side-menu-box cg-busy="{promise:myPromise,message:\'请稍后...\'}"><cm-side-menu style="width: 60px"></cm-side-menu><cm-side-menu-content style="left:60px;overflow-x: hidden"><cm-side-menu-content-header><section class="title"><h2>材料验收记录（辅料）</h2></section><section class="toolbar"><a href="#" class="btn btn-link"><span class="ion-home"></span> 回到主页</a></section></cm-side-menu-content-header><section><center><h3>材料验收记录（辅料）</h3></center><form name="form" novalidate=""><div class="row"><div class="col-xs-3">到料日期：<span>{{info.ArriveTime | date:\'yyyy-MM-dd\'}}</span></div><div class="col-xs-2">货号：<span>{{info.ProductNo}}</span></div><div class="col-xs-2">色号：<span>{{info.ColorNo}}</span></div><div class="col-xs-2">材料名称：<input type="text" ng-readonly="stateType!=\'dataEntry\'" ng-model="data.CaiLiaoMingCheng" class="input-common"></div><div class="col-xs-3">到料总数：<input type="number" ng-readonly="stateType!=\'dataEntry\'" ng-model="data.DaoLiaoZongShu" class="input-common"></div></div><div class="row" style="margin-top:10px"><div class="col-xs-3">检验数：{{totalCount}}</div><div class="col-xs-2">A/B类别：<select ng-disabled="stateType!=\'dataEntry\'" ng-model="data.LeiBie"><option value="A">A</option><option value="B">B</option></select></div><div class="col-xs-2">供应商：<input type="text" ng-readonly="stateType!=\'dataEntry\'" ng-model="data.GongYingShang" class="input-common"></div><div class="col-xs-2">步骤*：<select ng-disabled="stateType!=\'dataEntry\'" ng-model="data.selectedStep" required=""><option ng-repeat="x in data.step | filter:{name:\'!审核\'}" value="{{x.value}}">{{x.name}}</option></select></div><div class="col-xs-3">产品种类：<select ng-disabled="stateType!=\'dataEntry\'" ng-model="data.ChanPinZhongLei"><optgroup label="织带类"><option value="肩带">肩带</option><option value="色纱带">色纱带</option><option value="其他织带">其他织带</option></optgroup><optgroup label="其他类"><option value="其他">其他</option></optgroup></select></div></div><hr>填写项目： <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.XiangMuFlag.hasKuanDuOrGuiGe">宽度/规格 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.XiangMuFlag.hasCiDian">疵点 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.XiangMuFlag.hasDuiChenXingOrWanQuDu"> 对称性/弯曲度 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.XiangMuFlag.hasKeZhong"> 克重 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.XiangMuFlag.hasKaiDu"> 开度 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.XiangMuFlag.hasHouDu"> 厚度 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.XiangMuFlag.hasHuaXingXunHuan"> 花型循环<div class="row" style="overflow-x: auto; padding: 10px 10px 10px 10px"><table class="table table-bordered table-condensed ng-animinate"><thead><tr><th rowspan="2">卷号</th><th rowspan="2">缸号</th><th rowspan="1" colspan="{{5}}">数量( 米 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.ShuLiang.MiIsChecked"> 片 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.ShuLiang.PianIsChecked"> 个 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.ShuLiang.GeIsChecked"> 付 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.ShuLiang.FuIsChecked"> 枚 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.ShuLiang.MeiIsChecked"> 卷 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.ShuLiang.JuanIsChecked"> 公斤 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.ShuLiang.GongJinIsChecked"> )</th><th colspan="4" ng-show="data.XiangMuFlag.hasKuanDuOrGuiGe">宽度 <input type="radio" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.GuiGeOrKuanDu" value="KuanDu"> 规格 <input type="radio" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.GuiGeOrKuanDu" value="GuiGe"> （单位: <input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" style="background: none" ng-model="data.GuiGeOrKuanDuDanWei">）</th><th colspan="2" ng-show="data.XiangMuFlag.hasCiDian">疵点</th><th colspan="2" ng-show="data.XiangMuFlag.hasDuiChenXingOrWanQuDu">对称性 <input type="radio" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.DuiChenXingOrWanQuDu" value="DuiChenXing"> 弯曲度 <input type="radio" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.DuiChenXingOrWanQuDu" value="WanQuDu"> （单位: <input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" style="background: none" ng-model="data.DuiChenXingOrWanQuDuDanWei">）</th><th colspan="2" ng-show="data.XiangMuFlag.hasKeZhong">克重</th><th colspan="2" ng-show="data.XiangMuFlag.hasKaiDu">开度（松紧带、肩带）</th><th colspan="2" ng-show="data.XiangMuFlag.hasHouDu">厚度（薄膜，百美贴）</th><th colspan="2" ng-show="data.XiangMuFlag.hasHuaXingXunHuan">花型循环</th><th rowspan="2">等级判定</th><th rowspan="2">备注</th><th rowspan="2">手揉回缩率</th><th rowspan="2">自然回缩率</th><th rowspan="2" ng-show="stateType == \'dataEntry\'">操作</th><th rowspan="2" ng-show="stateType != \'dataEntry\'">检验员</th></tr><tr><th>皮标1</th><th>实测1</th><th>皮标2</th><th>实测2</th><th>检验数*</th><th ng-show="data.XiangMuFlag.hasKuanDuOrGuiGe">标准值</th><th ng-show="data.XiangMuFlag.hasKuanDuOrGuiGe">实测1</th><th ng-show="data.XiangMuFlag.hasKuanDuOrGuiGe">实测2</th><th ng-show="data.XiangMuFlag.hasKuanDuOrGuiGe">实测3</th><th ng-show="data.XiangMuFlag.hasCiDian">疵点</th><th ng-show="data.XiangMuFlag.hasCiDian">记分</th><th ng-show="data.XiangMuFlag.hasDuiChenXingOrWanQuDu">标准值</th><th ng-show="data.XiangMuFlag.hasDuiChenXingOrWanQuDu">实测</th><th ng-show="data.XiangMuFlag.hasKeZhong">标准</th><th ng-show="data.XiangMuFlag.hasKeZhong">实测</th><th ng-show="data.XiangMuFlag.hasKaiDu">标准值</th><th ng-show="data.XiangMuFlag.hasKaiDu">实测值</th><th ng-show="data.XiangMuFlag.hasHouDu">标准</th><th ng-show="data.XiangMuFlag.hasHouDu">实测</th><th ng-show="data.XiangMuFlag.hasHuaXingXunHuan">标准</th><th ng-show="data.XiangMuFlag.hasHuaXingXunHuan">实测</th></tr></thead><tbody id="data"><tr ng-repeat="row in data.listData"><td><input type="number" ng-readonly="stateType!=\'dataEntry\'" class="input-common" placeholder="卷号" ng-model="row.JuanHao"></td><td><input type="number" ng-readonly="stateType!=\'dataEntry\'" class="input-common" placeholder="缸号" ng-model="row.GangHao"></td><td><input type="number" ng-readonly="stateType!=\'dataEntry\'" class="input-common" placeholder="皮标1" ng-model="row.ShuLiangPiBiao1"></td><td><input type="number" ng-readonly="stateType!=\'dataEntry\'" class="input-common" placeholder="实测1" ng-model="row.ShuLiangShiCe1" ng-class="{\'input-warning\':comparePiBiaoShiCe(row.ShuLiangPiBiao1,row.ShuLiangShiCe1)}"></td><td><input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-common" placeholder="皮标2" ng-model="row.ShuLiangPiBiao2"></td><td><input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-common" placeholder="实测2" ng-model="row.ShuLiangShiCe2" ng-class="{\'input-warning\':comparePiBiaoShiCe(row.ShuLiangPiBiao2,row.ShuLiangShiCe2)}"></td><td><input type="number" ng-readonly="stateType!=\'dataEntry\'" class="input-common" placeholder="检验数" required="" ng-change="calctotalSum(data.listData)" ng-model="row.JianYanShu"></td><td ng-show="data.XiangMuFlag.hasKuanDuOrGuiGe"><input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="标准" ng-model="row.KuanDuOrGuiGeBiaoZhunZhi">± <input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="偏差" ng-model="row.KuanDuOrGuiGeBiaoZhunPianCha"></td><td ng-show="data.XiangMuFlag.hasKuanDuOrGuiGe"><input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="实测1" ng-class="{\'input-warning\':!validateScale(row.KuanDuOrGuiGeBiaoZhunZhi+data.GuiGeOrKuanDuDanWei, row.KuanDuOrGuiGeBiaoZhunPianCha,row.KuanDuOrGuiGeShiCe1)}" ng-model="row.KuanDuOrGuiGeShiCe1"></td><td ng-show="data.XiangMuFlag.hasKuanDuOrGuiGe"><input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="实测2" ng-class="{\'input-warning\':!validateScale(row.KuanDuOrGuiGeBiaoZhunZhi+data.GuiGeOrKuanDuDanWei, row.KuanDuOrGuiGeBiaoZhunPianCha,row.KuanDuOrGuiGeShiCe2)}" ng-model="row.KuanDuOrGuiGeShiCe2"></td><td ng-show="data.XiangMuFlag.hasKuanDuOrGuiGe"><input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="实测3" ng-class="{\'input-warning\':!validateScale(row.KuanDuOrGuiGeBiaoZhunZhi+data.GuiGeOrKuanDuDanWei, row.KuanDuOrGuiGeBiaoZhunPianCha,row.KuanDuOrGuiGeShiCe3)}" ng-model="row.KuanDuOrGuiGeShiCe3"></td><td ng-show="data.XiangMuFlag.hasCiDian"><input type="number" ng-readonly="stateType!=\'dataEntry\'" class="input-short" ng-class="{\'input-warning\':isWarningJiDian(row.JianYanShu,row.CiDianJiDian,data.LeiBie,data.ChanPinZhongLei)}" placeholder="记点" ng-model="row.CiDianJiDian"></td><td ng-show="data.XiangMuFlag.hasCiDian"><input type="number" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="记分" ng-class="{\'input-warning\':isWarningJiFen(row.JianYanShu,row.CiDianJiFen,data.ChanPinZhongLei)}" ng-model="row.CiDianJiFen"></td><td ng-show="data.XiangMuFlag.hasDuiChenXingOrWanQuDu"><input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="标准" ng-model="row.DuiChenXingOrWanQuDuBiaoZhunZhi">± <input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="偏差" ng-model="row.DuiChenXingOrWanQuDuBiaoZhunPianCha"></td><td ng-show="data.XiangMuFlag.hasDuiChenXingOrWanQuDu"><input type="number" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="实测" ng-class="{\'input-warning\':!validateScale(row.DuiChenXingOrWanQuDuBiaoZhunZhi+data.DuiChenXingOrWanQuDuDanWei, row.DuiChenXingOrWanQuDuBiaoZhunPianCha,row.DuiChenXingOrWanQuDuShiCe)}" ng-model="row.DuiChenXingOrWanQuDuShiCe"></td><td ng-show="data.XiangMuFlag.hasKeZhong"><input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="标准" ng-model="row.KeZhongBiaoZhunZhi">± <input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="偏差" ng-model="row.KeZhongBiaoZhunPianCha"></td><td ng-show="data.XiangMuFlag.hasKeZhong"><input type="number" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="实测" ng-class="{\'input-warning\':!validateScale(row.KeZhongBiaoZhunZhi, row.KeZhongBiaoZhunPianCha,row.KeZhongShiCe)}" ng-model="row.KeZhongShiCe"></td><td ng-show="data.XiangMuFlag.hasKaiDu"><input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="标准" ng-model="row.KaiDuBiaoZhunZhi">± <input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="偏差" ng-model="row.KaiDuBiaoZhunPianCha"></td><td ng-show="data.XiangMuFlag.hasKaiDu"><input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="实测" ng-class="{\'input-warning\':!validateScale(row.KaiDuBiaoZhunZhi, row.KaiDuBiaoZhunPianCha,row.KaiDuShiCe)}" ng-model="row.KaiDuShiCe"></td><td ng-show="data.XiangMuFlag.hasHouDu"><input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="标准" ng-model="row.HouDuBiaoZhunZhi">± <input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="偏差" ng-model="row.HouDuBiaoZhunPianCha"></td><td ng-show="data.XiangMuFlag.hasHouDu"><input type="number" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="实测" ng-class="{\'input-warning\':!validateScale(row.HouDuBiaoZhunZhi, row.HouDuBiaoZhunPianCha,row.HouDuShiCe)}" ng-model="row.HouDuShiCe"></td><td ng-show="data.XiangMuFlag.hasHuaXingXunHuan"><input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="标准" ng-model="row.HuaXingBiaoZhunZhi">± <input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="偏差" ng-model="row.HuaXingBiaoZhunPianCha"></td><td ng-show="data.XiangMuFlag.hasHuaXingXunHuan"><input type="number" ng-readonly="stateType!=\'dataEntry\'" class="input-short" placeholder="实测" ng-class="{\'inpuFt-warning\':!validateScale(row.HuaXingBiaoZhunZhi, row.HuaXingBiaoZhunPianCha,row.HuaXingShiCe)}" ng-model="row.HuaXingShiCe"></td><td><input type="radio" ng-disabled="stateType!=\'dataEntry\'" ng-model="row.DengJiPanDing" value="A">A <input type="radio" ng-disabled="stateType!=\'dataEntry\'" ng-model="row.DengJiPanDing" value="C">C</td><td><input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-common" placeholder="备注" ng-model="row.BeiZhu"></td><td><input type="text" ng-readonly="stateType!=\'dataEntry\'" ng-model="row.ShouRouHuiSuoLv" placeholder="" class="input-common"></td><td><input type="text" ng-readonly="stateType!=\'dataEntry\'" ng-model="row.ZiRanHuiSuoLv" placeholder="" class="input-common"></td><td ng-show="stateType == \'dataEntry\'"><a class="btn btn-link" ng-click="del(row)">删除</a></td><td ng-show="stateType != \'dataEntry\'"><span>{{row.Inspector}}</span></td></tr></tbody><tfoot><tr><td colspan="1"><button class="btn btn-link" ng-click="add()">添加</button></td><td colspan="8">1、对色：与标准色卡比对 <input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.hasBiaoZhunSeKa"> <input type="text" ng-readonly="stateType!=\'dataEntry\'" ng-model="data.BiaoZhunSeKa" class="input-short"> 级，与材料封样比对<input type="checkbox" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.hasCaiLiaoFengYang"> <input type="text" ng-readonly="stateType!=\'dataEntry\'" ng-model="data.CaiLiaoFengYang" class="input-short"> 级<br>2、气味 <input type="radio" ng-disabled="stateType!=\'dataEntry\'" value="ZhengChang" ng-model="data.QiWei">正常 <input type="radio" ng-disabled="stateType!=\'dataEntry\'" value="BuZhengChang" ng-model="data.QiWei">不正常，有 <input type="text" ng-readonly="stateType!=\'dataEntry\'" ng-model="data.QiWeiBeiZhu" class="input-short">味<br>3、氨纶实验结果 <input type="radio" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.AnLunShiYan" value="HeGe"> 合格 <input type="radio" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.AnLunShiYan" value="BuHeGe"> 不合格<br>4、验针结果： <input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-common" ng-model="data.YanZhenJieGuo"><br>5、正、反面：<input type="radio" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.ZhengFanMian" value="ZhengQue">正确 <input type="radio" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.ZhengFanMian" value="BuZhengQue">不正确<br>6、手感： <input type="text" ng-readonly="stateType!=\'dataEntry\'" ng-model="data.ShouGan" class="input-common"><br>7、纱向：<input type="radio" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.ShaXiang" value="ZhengQue">正确<input value="BuZhengQue" ng-model="data.ShaXiang" type="radio">不正确<br>8、材料疵点主要问题说明： <input type="text" ng-readonly="stateType!=\'dataEntry\'" class="input-common" style="min-width: 300px;max-width: 300px" ng-model="data.CaiLiaoCiDianZhuYaoWenTi"><br>9、印标位置：<input type="radio" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.YinBiaoWeiZhi" value="ZhengQue">正确 <input type="radio" ng-disabled="stateType!=\'dataEntry\'" ng-model="data.YinBiaoWeiZhi" value="BuZhengQue">不正确</td><td colspan="99">结论： <input type="radio" ng-disabled="stateType!=\'dataEntry\'" value="HeGe" ng-model="data.JieLun">合格 <input type="radio" ng-disabled="stateType!=\'dataEntry\'" value="BuHeGe" ng-model="data.JieLun">不合格 <input type="radio" ng-disabled="stateType!=\'dataEntry\'" value="BuZuoPanDing" ng-model="data.JieLun">不作判定 <input type="text" ng-readonly="stateType!=\'dataEntry\'" ng-model="data.JieLunBeiZhu" class="input-common"></td></tr></tfoot></table></div><span ng-show="stateType != \'dataEntry\' && info.check">审批人：{{info.Assessor}}于{{info.AssessTime}}审批</span> <button ng-disabled="!form.$valid" class="pull-right btn btn-default" ng-show="stateType == \'dataEntry\'" ng-click="sub(true)"><span class="ion-checkmark"></span> 提交</button> <button ng-disabled="!form.$valid" class="pull-right btn btn-default" ng-show="stateType == \'dataEntry\'" style="margin-right: 10px" ng-click="sub(false)"><span class="ion-archive"></span> 保存</button> <button style="margin-right: 10px" class="btn btn-default pull-right" ng-show="stateType != \'dataEntry\' && !info.check" ng-click="pass()"><span class="ion-checkmark"></span> 通过</button></form></section></cm-side-menu-content></cm-side-menu-box><style>\n  .input-common {\n    max-width: 80px;\n    border-top: none;\n    border-bottom: 1px solid black;\n    border-right: none;\n    border-left: none;\n  }\n\n  .input-short {\n    max-width: 50px;\n    border-top: none;\n    border-bottom: 1px solid black;\n    border-right: none;\n    border-left: none;\n  }\n\n  input.input-warning {\n    border: 1px solid orange!important;\n  }\n\n  input.ng-invalid {\n    border: 1px solid red;\n  }\n\n  input.ng-untouched {\n    border-top: none;\n  !important;\n    border-left: none;\n  !important;\n    border-right: none;\n  !important;\n    border-bottom: 1px solid black;\n  !important;\n  }\n\n  select.ng-invalid {\n    border: 1px solid red;\n  }\n\n  select.ng-untouched {\n    border-top: none;\n  !important;\n    border-left: none;\n  !important;\n    border-right: none;\n  !important;\n    border-bottom: 1px solid black;\n  !important;\n  }\n\n  body {\n    overflow-x: hidden;\n  }\n</style>'),e.put("app/interaction/control/feedback/new.html",'<cm-side-menu-content><cm-side-menu-content-header><section class="title"><h2>提交您的反馈</h2></section></cm-side-menu-content-header><section style="width: 67%;"><form ng-submit="funcSubmitNewFeedback(feedback)"><h5>主题</h5><input type="text" class="form-control" ng-model="feedback.Subject"><br><h5>反馈内容</h5><textarea rows="15" class="form-control" style="resize: none" ng-model="feedback.Content" required=""></textarea><br><button class="btn btn-default">提交</button></form></section></cm-side-menu-content>'),e.put("app/interaction/control/design/classification.html",'<cm-side-menu-content class="control"><cm-side-menu-content-header><section class="title">查看并修改原材料检验任务分配规则</section><section class="toolbar"></section></cm-side-menu-content-header><section class="block" ng-show="0"><h4>添加新的对应</h4><section class="map"><div class="row"><div class="item"><div class="name">物料名称</div><div class="input"><input type="text"></div></div><div class="item"><div class="name">对应流程类型</div><div class="input"><select name="" id=""></select></div></div></div></section><input class="btn btn-default" type="submit" id="submit" value="添加"></section><section class="block"><h4>当前分配规则</h4><br><table class="table table-hover table-bordered"><thead><tr><th>#</th><th>物料名称</th><th>流程类型</th><th>大类</th><th>操作</th></tr></thead><tbody><tr><td></td><td><label style="width: 100%;margin: 0;"><input style="border: 0;" type="text" ng-model="subclass.Subclass"></label></td><td><label style="width: 100%;margin: 0;"><select style="border: 0;" ng-model="subclass.ProcessTypeId" ng-options="ProcessType.Id as (ProcessType.Name+\' \'+ProcessType.Id) group by ProcessType.Class for ProcessType in OptionalProcessTypes track by ProcessType.Name"><option value="" ng-show="!subclass.ProcessTypeId">-- 请选择流程类型 --</option></select></label></td><td>-</td><td><a ng-click="funcSubmitSubclass(subclass)">添加</a></td></tr><tr ng-repeat="subclass in subclasses"><td>{{ $index+1 }}</td><td>{{subclass.Subclass}}</td><td>{{subclass.Name+\' \'+subclass.ProcessTypeId}}</td><td>{{subclass.Class}}</td><td><a ng-click="funcRemoveSubclass(subclass.Id)">删除</a></td></tr></tbody></table></section></cm-side-menu-content>'),
e.put("app/interaction/control/design/process.html",'<cm-side-menu-content class="control"><cm-side-menu-content-header><section class="title">查看并修改流程信息</section><section class="toolbar"><div class="button">添加新的流程</div><div class="button" ui-sref="home.control.designEditProcess({\'isEditCache\':\'cache\'})">进入缓存流程编辑</div></section></cm-side-menu-content-header><section class="block" ng-if="false"><h4>编辑流程基本信息</h4><section class="map"><div class="row"><div class="item"><div class="name">Id</div><input class="value" type="text"></div><div class="item"><div class="name">分类</div><input class="value" type="text"></div><div class="item"><div class="name">名称</div><input class="value" type="text"></div><div class="item"></div></div><div class="row"><div class="item"><div class="name">描述</div><input type="text" class="value" style="width: 67%;"></div></div></section><input class="btn btn-default" type="submit" id="submit" value="添加"></section><section class="block"><h4>当前流程列表</h4><br><table class="table table-hover table-bordered"><thead><tr><th width="15%">Id</th><th width="15%">Rev</th><th width="15%">分类</th><th width="15%">名称</th><th width="40%">描述</th><th width="15%">操作</th></tr></thead><tbody><tr ng-repeat="processType in processTypes"><td>{{processType.Id}}</td><td>{{processType.Rev}}</td><td>{{processType.Class}}</td><td>{{processType.Name}}</td><td>{{processType.Description}}</td><td><span style="cursor: pointer" ng-click="funcEditProcess(processType.Id,processType.Rev)">编辑</span></td></tr></tbody></table></section></cm-side-menu-content>'),e.put("app/interaction/control/design/source.html",'<cm-side-menu-content class="form-table control"><cm-side-menu-content-header><section class="title"><h2>配置选项数据来源</h2></section><section class="toolbar"><div class="button {{uiIsAddPanelShow?\'active\':\'\'}}" ng-click="$parent.uiIsAddPanelShow=!$parent.uiIsAddPanelShow">添加新来源</div></section></cm-side-menu-content-header><section class="block" ng-show="uiIsAddPanelShow"><h4>新的选项数据来源</h4><form name="addNewCol" ng-submit="funcCreateSource()"><section class="map"><div class="row"><div class="item"><div class="name">来源描述</div><div><input type="text" class="value" ng-model="config.Description" placeholder="描述来源内容" required=""></div></div><div class="item"><div class="name">调用名</div><div><input type="text" class="value" ng-model="config.Name" placeholder="调用使用的名称，限字母" required=""></div></div><div class="item"></div></div><div class="row"><div class="item"><div class="name">类型</div><div><label title="字面量"><input type="radio" ng-model="config.Type" id="inlineRadio1" value="value">字面量</label> <label title="SQL查询"><input type="radio" ng-model="config.Type" id="inlineRadio2" value="sql" disabled="">SQL查询</label> <label title="关联关系"><input type="radio" ng-model="config.Type" id="inlineRadio3" value="relation" disabled="">关联关系</label></div></div></div><div class="row" ng-show="config.Type===\'value\'"><div class="item"><div class="name">可选值</div><input type="text" class="value" ng-model="config.Value" ng-list="" placeholder="使用 , 分开多个选项" style="width: 60%"></div></div></section><input class="btn btn-default" type="submit" id="submit" value="提交到服务器"></form></section><section class="block"><h4>存储的选项数据来源</h4><table class="table table-hover table-bordered table-condensed"><thead><tr><th width="5%">序号</th><th width="5%">修改</th><th width="15%">来源描述</th><th width="10%">调用名</th><th width="10%">类型</th><th width="55%">可选值</th></tr></thead><tbody><tr ng-repeat="config in configs"><td>{{$index+1}}</td><td ng-click="funcDeleteSource(config.Name)" style="cursor: pointer;">删除</td><td>{{config.Description}}</td><td>{{config.Name}}</td><td>{{config.Type}}</td><td>{{config.Value}}</td></tr><tr ng-show="!(configs.length>0)"><td colspan="6" style="height: 64px;text-align:center;line-height:64px;background-color: #F4F4F4;font-size: 15px">服务器上还没有选项数据来源</td></tr></tbody></table></section><section class="block"><pre>\r\n      {{configs}}\r\n    </pre></section></cm-side-menu-content>'),e.put("app/interaction/control/operation/record.html",'<cm-side-menu-content><cm-side-menu-content-header><section class="title"><h2>查看操作记录</h2></section></cm-side-menu-content-header><table class="table"><thead><tr><th>时间</th><th>对象</th><th>描述</th><th>操作</th><th>用户名</th><th>IP</th></tr></thead><tbody><tr ng-repeat="operation in operations"><td>{{operation.Time | date:\'MM月dd日&nbsp;&nbsp;HH:mm \'}}</td><td><a ng-click="funcGo(operation.Type,operation.Id)">{{operation.Type | FormProcessChineseFilter}}&nbsp;{{operation.Id}}</a></td><td>{{operation.Description}}</td><td>{{operation.Operation}}</td><td>{{operation.Username}}</td><td>{{operation.IP}}</td></tr></tbody></table></cm-side-menu-content>'),e.put("app/interaction/control/user/all.html",'<cm-side-menu-content ng-controller="ControlUserCtrl as vm" cg-busy="{promise:myPromise,message:\'请稍后...\'}"><cm-side-menu-content-header><section class="title"><h2>用户管理</h2></section><section class="toolbar"><button class="btn btn-link" style="float: right" ng-click="vm.addNew();">添加用户</button></section></cm-side-menu-content-header><section><table class="table table-striped"><thead><tr><th>工号</th><th>姓名</th><th>部门</th><th>岗位</th><th><span class="pull-right" style="padding-left:12px;padding-right:12px;">修改</span></th></tr></thead><tbody><tr ng-repeat="model in vm.history"><td>{{model.ID}}</td><td>{{model.Name}}</td><td ng-repeat="department in vm.departments | filter:{value:model.DepartmentID}">{{department.name || 1}}</td><td ng-repeat="job in vm.jobs | filter:{value:model.JobID}">{{job.name || 1}}</td><td><button class="btn btn-link pull-right" ng-click="vm.edit(model,false)">修改</button> <button class="btn btn-link pull-right" ng-click="vm.del(model)">删除</button></td></tr></tbody></table></section></cm-side-menu-content>'),e.put("app/interaction/control/user/modify.html",'<div cg-busy="{promise:myPromise,message:\'请稍后...\'}"><div class="modal-header"><h3 class="modal-title">添加或修改用户</h3></div><div class="modal-body"><form name="vm.form2"><formly-form model="vm.formData.model" fields="vm.formData.fields" form="vm.form" options="vm.formData.options"></formly-form></form><hr></div><div class="modal-footer"><button class="btn btn-primary" ng-click="vm.ok()" ng-disabled="vm.form2.$invalid">提交</button> <button class="btn btn-warning" ng-click="vm.cancel()">取消</button></div></div>'),e.put("app/interaction/process/detail/base.html",'<cm-side-menu-box><cm-side-menu style="width: 60px;box-sizing: border-box;font-size: 22px;"><div style="height: 67%;display: flex;flex-direction:column;justify-content: center;"><div ng-show="form.Status===\'2\'"><ul ng-if="false"><li class="{{uiIsReferencePanelShow?\'active\':\'\'}}" ng-click="funcSwitchReferencePanel()" style="padding: 0;"><div class="ion-ios-bookmarks" style="text-align: center;height: 100%;" title="参考"></div></li></ul><ul><li ng-click="funcSideSaveForm()" style="padding: 0;"><div class="ion-folder" style="text-align: center;height: 100%;" title="暂存"></div></li></ul><ul><li class="{{option.all.isEditable?\'\':\'active\'}}" ng-click="funcSideViewForm()" style="padding: 0;"><div class="ion-eye" style="text-align: center;height: 100%;" title="查看"></div></li><li class="{{option.all.isEditable?\'active\':\'\'}}" ng-click="funcSideEditForm()" style="padding: 0;"><div class="ion-edit" style="text-align: center;height: 100%;" title="编辑"></div></li></ul><ul></ul></div><div ng-show="form.Status!==\'2\'"><ul><li class="disabled" style="padding: 0;"><div class="ion-folder" style="text-align: center;height: 100%;" data-trigger="hover" data-type="info" data-title="保存" bs-tooltip=""></div></li></ul><ul><li class="disabled {{option.all.isEditable?\'\':\'active\'}}" style="padding: 0;"><div class="ion-eye" style="text-align: center;height: 100%;" data-trigger="hover" data-type="info" data-title="查看" bs-tooltip=""></div></li><li class="disabled {{option.all.isEditable?\'active\':\'\'}}" style="padding: 0;"><div class="ion-edit" style="text-align: center;height: 100%;" data-trigger="hover" data-type="info" data-title="编辑" bs-tooltip=""></div></li></ul><ul></ul></div></div></cm-side-menu><ng-include ng-if="state.current.name===\'home.process.detailForm\'" src="\'app/interaction/process/detail/form.html\'"></ng-include></cm-side-menu-box>'),e.put("app/interaction/process/detail/form.html",'<cm-side-menu-content style="left: 60px;"><cm-side-menu-content-header><section class="form-infomation"><div class="basic">{{formInfo.Status | FormStatusFilter}}：{{formInfo.Id}}</div><div class="edit" title="创建：由 {{formInfo.CreateUserName}} 在 {{formInfo.CreateTime | date:\'MM/dd hh:mm:ss\'}}">最后修改：由 {{formInfo.LastModifiedUserName}} 在 {{formInfo.LastModifiedTime | date:\'MM/dd hh:mm:ss\'}}</div></section><section class="toolbar"><div class="button" ng-show="formInfo.Status===\'2\'&&!uiIsAutoSaveFormData" ng-click="funcSaveToServer()">暂存</div><div class="button disabled" ng-show="formInfo.Status===\'2\'&&uiIsAutoSaveFormData">自动暂存中...</div><div class="button" ng-show="formInfo.Status===\'2\'" ng-click="funcSubmitForm()">提交表单</div></section></cm-side-menu-content-header><section class="block" ng-show="uiIsReferencePanelShow&&references.length"><div class="reference-switch" style="display: flex;"><div ng-repeat="ref in references" class="switcher {{$index===uiCurrentActiveReferenceIndex?\'active\':\'\'}}" ng-click="funcSwitchReference($index)" title="{{ref.Id}}">{{ref.Name}}</div></div><hr style="margin: 6px 0 12px 0;"><ng-include src="\'app/interaction/process/detail/reference.html\'"></ng-include></section><section ng-show="stateParams.ArrivalSerialNumber===\'ARRIVAL\'&&formInfo.Status===\'4\'" style="padding: 12px;margin-bottom:12px;border: 1px solid #eaf2e0;border-radius: 2px;background-color: #f6f9f0;color: darkgreen;"><div style="font-size: 16px;margin-bottom: 2px">该收货报告有问题？<a ng-click="funcRedoForm(formInfo.Id)">点击这里</a> <span style="opacity: 0.9;">重新编辑该表单。</span></div><div style="opacity: 0.6;font-size: 14px">提交后将重新生成检验任务，前后没有变化的检验任务不受到影响。</div><div style="opacity: 0.6;font-size: 14px">该报告生成的检验任务链接： <a ng-repeat="asn in formInfo.Parameter.processes" ui-sref="home.process.detailInfo({ArrivalSerialNumber:asn})">{{asn}}</a></div></section><div><section style="padding: 12px;border: 1px solid #f2f2f2;border-radius: 2px;background-color: #f9f9f9"><div ng-if="formConfig.fields"><formly-form model="formData" fields="formConfig.fields" form="formConfig.form" options="formConfig.options"></formly-form></div><div ng-if="formConfig.template"><cm-template-load template="{{formConfig.template}}" model="formData"></cm-template-load></div></section><section><br><pre>{{formData}}</pre></section></div></cm-side-menu-content>'),e.put("app/interaction/process/detail/info.html",'<cm-side-menu-box><cm-side-menu style="width: 60px;"></cm-side-menu><cm-side-menu-content style="left: 60px;" class="rmiProcessDetailInfo"><cm-side-menu-content-header><section class="title" style="display: flex"><div style="margin: 5px 10px 0 0;"><div class="cm-table-indicator-dot" style="background-color: {{\'#\'+process.ArrivalSerialNumber}}"></div></div><h2>{{\'检验任务： \'+process.TypeName+\' ，由 \'}}<a style="cursor: pointer;" ng-click="funcViewSourceForm(process.SourceFormId)">{{\'收获报告#\'+process.SourceFormId}}</a>{{\'生成\'}}</h2></section><section class="toolbar"><div class="button">打印该检验任务</div><div class="button">打印条形码</div></section></cm-side-menu-content-header><section class="info"><div class="info-part"><h4>基本信息</h4><div class="info-container"><div class="info-col"><div class="info-kv"><div class="key">物料类型</div><div class="value">{{process.TypeClass}}-{{process.TypeName}}-{{process.Parameter.wuliaomingcheng}}</div></div><div class="info-kv"><div class="key">供应商</div><div class="value">{{process.Parameter.gongyingshang}}</div></div><div class="info-kv"><div class="key">货号</div><div class="value">{{process.Parameter.huohao}}</div></div><div class="info-kv"><div class="key">颜色</div><div class="value">{{process.Parameter.yanse}}</div></div></div><div class="info-col"><div class="info-kv"><div class="key">开始时间</div><div class="value">{{process.StartTime | date:\'yyyy年M月d日&nbsp;&nbsp;HH:mm\'}}</div></div><div class="info-kv"><div class="key">是否完成</div><div class="value" title="{{process.IsComplete}}">{{process.IsComplete|ProcessIsCompleteFilter}}<a ng-show="process.IsComplete===true||process.IsComplete===\'true\'" ng-click="funcRedoComplete(process.ArrivalSerialNumber)" style="margin-left: 8px">撤销完成状态</a></div></div><div class="info-kv" ng-show="process.IsComplete===\'false\'||process.IsComplete===\'False\'" style="margin-top: 14px;"><div class="value"><button class="btn btn-default" ng-click="funcMarkProcessWaiting(process.ArrivalSerialNumber)">标记等待确认完成</button></div></div><div class="info-kv" ng-show="process.IsComplete===\'waiting\'" style="margin-top: 14px;"><div class="value"><button class="btn btn-default" ng-click="funcMarkProcessComplete(process.ArrivalSerialNumber)">标记检验完成</button></div></div><div class="info-kv" ng-show="process.IsComplete===\'true\'"><div class="key">完成时间</div><div class="value">{{process.CompleteTime | date:\'yyyy年M月d日&nbsp;&nbsp;HH:mm\'}}</div></div><div class="info-kv" ng-show="process.IsComplete===\'true\'"><div class="key">流程时间</div><div class="value" title="历时{{((+process.CompleteTime)-(+process.StartTime))/(24*60*60*1000)|number:1}}天">{{((+process.CompleteTime)-(+process.StartTime))/(60*60*1000)|number:1}}&nbsp;小时</div></div></div></div></div><div class="info-part"><h4>流水条形码</h4><div class="info-col"><div class="info-kv"><div class="value"><cm-barcode value="process.ArrivalSerialNumber"></cm-barcode></div></div></div></div></section><section><ul class="process-node-list"><li class="process-node" ng-repeat="Node in process.Nodes | orderBy:Node.Order"><div class="process-node-container"><header class="header" ng-init="Node.uiCurrentStageTabCode=funcGetCurrentStageTabCode(Node.Available,Node.Form.Status,Node.CheckStatus); Node.uiActiveTabCode=Node.uiCurrentStageTabCode; Node.uiIsTabAvailable =[]; Node.uiIsTabAvailable[0]=true; Node.uiIsTabAvailable[1]=Node.Available&&(Node.uiCurrentStageTabCode!==0); Node.uiIsTabAvailable[2]=Node.Available&&(Node.uiCurrentStageTabCode===2||Node.uiCurrentStageTabCode===3); Node.uiIsTabAvailable[3]=Node.Available&&(Node.uiCurrentStageTabCode===3);"><h4>{{Node.Name}} · {{1|ProcessNodeStatusFilter:Node.Available:Node.Form.Status:Node.CheckStatus}}</h4><div class="tabs"><div class="tab {{(Node.uiIsTabAvailable[tab.code])?\'\':\'disabled\'}}" ng-repeat="tab in [{\'name\':\'启用\',\'code\':0},{\'name\':\'检验\',\'code\':1},{\'name\':\'审核\',\'code\':2},{\'name\':\'完成\',\'code\':3}]" ng-click="(Node.uiIsTabAvailable[tab.code])&&(Node.uiActiveTabCode=tab.code)">{{tab.name}}<div ng-if="tab.code===Node.uiActiveTabCode" class="tri ion-arrow-up-b"></div></div></div><div ng-show="Node.Available"><div ng-show="Node.Form.Status===undefined"></div><div ng-show="Node.Form.Status!==undefined"><div class="quick-edit-form" ng-show="Node.Form.Status===null||Node.Form.Status===2||Node.Form.Status===\'2\'" ng-click="funcEditForm(process.ArrivalSerialNumber,Node.Form.Id)">快捷编辑</div><div class="quick-view-form" ng-hide="Node.Form.Status===null||Node.Form.Status===2||Node.Form.Status===\'2\'" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">表单查看</div></div></div></header><div class="content" ng-switch="Node.uiActiveTabCode"><div ng-switch-when="0"><div ng-switch="Node.Available"><div ng-switch-when="true"><h5>检验中 <span class="description">当前项状态</span></h5><p>启用方式：{{Node.AvailableFlag |ProcessNodeAvailableFlagFilter}}</p><button ng-click="funcUpdateProcessNodeAvailableFlag(process.ArrivalSerialNumber,Node.Id,\'default\')" class="btn btn-default">恢复默认</button> <button ng-click="funcUpdateProcessNodeAvailableFlag(process.ArrivalSerialNumber,Node.Id,\'true\')" class="btn btn-default">手动启用</button> <button ng-click="funcUpdateProcessNodeAvailableFlag(process.ArrivalSerialNumber,Node.Id,\'false\')" class="btn btn-default">手动禁止</button></div><div ng-switch-when="false"><p class="message">该项当前不可用<br>您可以选择 <a ng-click="funcUpdateProcessNodeAvailableFlag(process.ArrivalSerialNumber,Node.Id,\'true\')">手动启用</a></p></div><div ng-switch-default="">PAGE DISPLAY ERROR.</div></div></div><div ng-switch-when="1"><div ng-switch="Node.Form.Status"><section ng-switch-when="undefined"><h5>未创建 <span class="description">编辑状态</span></h5><p><br></p><button class="btn btn-block btn-default" ng-click="funcShortcutCreateFormAndRequestEditFormAndEditForm(process.ArrivalSerialNumber,process.TypeId,process.Rev,Node.Id)">创建并编辑</button></section><section ng-switch-when="0"><h5>未创建 <span class="description">编辑状态</span></h5><p>还未创建该检验项的报告</p><button class="btn btn-block btn-default" ng-click="funcShortcutCreateFormAndRequestEditFormAndEditForm(process.ArrivalSerialNumber,process.TypeId,process.Rev,Node.Id)">创建并编辑</button></section><section ng-switch-when="2"><h5>编辑中 <span class="description">编辑状态</span></h5><p></p><div style="line-height: 22px;color: #666;"><div>创建：{{Node.Form.CreateUserName}} {{Node.Form.CreateTime | date:\'yyyy年MM月dd日 hh:mm\'}}</div><div>最后编辑： {{Node.Form.LastModifiedUserName}}{{Node.Form.LastModifiedTime | date:\'yyyy年MM月dd日 hh:mm\'}}</div></div><p></p><button class="btn btn-block btn-default" ng-click="funcShortcutRequestEditFormAndEditForm(process.ArrivalSerialNumber,Node.Form.Id)">编辑</button> <button class="btn btn-block btn-default" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">查看</button> <button class="btn btn-block btn-default" ng-click="funcShortcutConfirmFormAndSubmitForm(Node.Form.Id)">提交</button><br><div><h5>检验结论<span class="description"></span></h5><label><input type="radio" ng-model="Node.Conclusion" value="空">空</label> <label><input type="radio" ng-model="Node.Conclusion" value="合格">合格</label> <label><input type="radio" ng-model="Node.Conclusion" value="不合格">不合格</label> {{Node.Conclusion}} <button class="btn btn-block btn-default" ng-click="funcUpdateProcessNodeConclusion(process.ArrivalSerialNumber,Node.Id,Node.Conclusion)">提交修改</button></div></section><section ng-switch-when="4"><h5>已提交 <span class="description">编辑状态</span></h5><p>检验报告已提交，等待审核</p><div style="line-height: 22px;color: #666;"><div>创建：{{Node.Form.CreateUserName}} {{Node.Form.CreateTime | date:\'yyyy年MM月dd日 hh:mm\'}}</div><div>最后编辑： {{Node.Form.LastModifiedUserName}}{{Node.Form.LastModifiedTime | date:\'yyyy年MM月dd日hh:mm\'}}</div></div><p></p><button class="btn btn-block btn-default" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">查看</button> <button class="btn btn-block btn-default" ng-click="funcRedoForm(Node.Form.Id)">撤销提交</button></section><section ng-switch-default="">PAGE DISPLAY ERROR.</section></div></div><div ng-switch-when="2"><div ng-switch="Node.CheckStatus"><section ng-switch-when="undefined"><h5>未审核 <span class="description">审核状态</span></h5><p>检验报告已提交，等待审核</p><p>检验结论： {{Node.Conclusion}}</p><button class="btn btn-block btn-default" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">查看</button> <button class="btn btn-block btn-default" ng-click="funcCheckPass(process.ArrivalSerialNumber,Node.Id)">审核通过</button> <button class="btn btn-block btn-default" ng-click="funcCheckDeny(process.ArrivalSerialNumber,Node.Id)">审核不通过</button></section><section ng-switch-when="0"><h5>未审核 <span class="description">审核状态</span></h5><p>检验报告已提交，等待审核</p><p>检验结论： {{Node.Conclusion}}</p><button class="btn btn-block btn-default" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">查看</button> <button class="btn btn-block btn-default" ng-click="funcCheckPass(process.ArrivalSerialNumber,Node.Id)">审核通过</button> <button class="btn btn-block btn-default" ng-click="funcCheckDeny(process.ArrivalSerialNumber,Node.Id)">审核不通过</button></section><section ng-switch-when="1"><h5>审核通过<span class="description">审核状态</span></h5><p>检验报告已完成审核，该检验项完成</p><p>检验结论： {{Node.Conclusion}}</p><div style="line-height: 16px;color: #666;"><div>审核人：{{Node.CheckUserName}} {{Node.CheckTime | date:\'yyyy年MM月dd日 hh:mm\'}}</div></div><p></p><button class="btn btn-block btn-default" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">查看</button> <button class="btn btn-block btn-default" ng-click="funcRedoCheck(process.ArrivalSerialNumber,Node.Id)">撤销审核</button></section><section ng-switch-when="2"><h5>审核不通过<span class="description">审核状态</span></h5><p>检验报告已完成审核，该检验项完成</p><p>检验结论： {{Node.Conclusion}}</p><button class="btn btn-block btn-default">查看</button> <button class="btn btn-block btn-default" ng-click="funcRedoCheck(process.ArrivalSerialNumber,Node.Id)">撤销审核</button></section><section ng-switch-default=""><h5>未审核 <span class="description">审核状态</span></h5><p>检验报告已提交，等待审核</p><p>检验结论： {{Node.Conclusion}}</p><button class="btn btn-block btn-default" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">查看</button> <button class="btn btn-block btn-default" ng-click="funcCheckPass(process.ArrivalSerialNumber,Node.Id)">审核通过</button> <button class="btn btn-block btn-default" ng-click="funcCheckDeny(process.ArrivalSerialNumber,Node.Id)">审核不通过</button></section></div></div><div ng-switch-when="3"><p>检验结论： {{Node.Conclusion}}</p><p class="message">该项检验已经完成<br>点击上方选项来查看详情<br><br>有问题？<a ng-click="funcRedoFormAndCheck(process.ArrivalSerialNumber,Node.Id,Node.Form.Id)">重做该检验项</a></p></div></div></div></li></ul></section></cm-side-menu-content></cm-side-menu-box>'),e.put("app/interaction/process/detail/reference.html",'<div ng-show="uiIsReferenceShow"><div style="display:flex;flex-flow: row wrap;align-items: stretch; justify-content: space-between;"><h4>{{currentReference.Name}}</h4><div style="opacity: 0.6;cursor: pointer;" ng-click="funcHideReference()">关闭</div></div><br><div ng-repeat="Component in currentReference.Components" ng-switch="Component.Type">{{($index+1)+\'. \'}}{{Component.Name}}<div ng-switch-when="table"><table class="table"><thead><tr><th ng-repeat="(Id,Name) in Component.Relation">{{Name}}</th></tr></thead><tbody><tr ng-repeat="row in Component.Data"><td ng-repeat="(Id,Value) in row">{{Value}}</td></tr></tbody></table></div><div ng-switch-when="map"><table class="table"><thead><tr><th ng-repeat="(Id,Value) in Component.Relation">{{Value}}</th></tr></thead><tbody><tr><td ng-repeat="(Id,Value) in Component.Data">{{Value}}</td></tr></tbody></table></div><div ng-switch-when="html" ng-bind-html="Component.Data"></div></div></div><div ng-hide="1||uiIsReferenceShow">请选择要查看的参考数据</div>'),e.put("app/interaction/process/list/base.html",'<cm-side-menu-box><cm-side-menu style=""><section class="category"><h4>选择条目</h4><ul><li ui-sref-active="active" ui-sref="home.process.formListDataentry">检验任务填写</li><li ui-sref-active="active" ui-sref="home.process.formListCheck">查看汇总数据</li></ul></section></cm-side-menu><ng-include src="\'app/interaction/process/list/inspection_process.html\'" ng-controller="ProcessListInspectionCtrl"></ng-include></cm-side-menu-box>'),e.put("app/interaction/process/list/blank.html",'<cm-side-menu-content><cm-side-menu-content-header><section class="title"><h2>选择检验物料的类型</h2></section><section class="toolbar"></section></cm-side-menu-content-header><section class="rmi-process-list-blank"><section class="notification" style="{{(uiIsProcessTypesShow&&sideMenuList.length)?\'margin-top:20%\':\'margin-top:25%\'}}"><div>请从左边选择检验的物料类型<br>或 <a ng-click="uiIsProcessTypesShow=!uiIsProcessTypesShow">选择一个默认的类型</a></div></section><section class="processTypes" ng-show="uiIsProcessTypesShow&&sideMenuList.length"><div class="processType" ng-repeat="item in sideMenuList track by $index" ng-click="funcSetDefaultProcessType(item.Id,item.Rev)">{{item.Name}}</div></section></section></cm-side-menu-content>'),e.put("app/interaction/process/list/count_form.html",'<cm-side-menu-content><cm-side-menu-content-header><section class="title"><h2>收货报告列表</h2></section><section class="toolbar"><div class="button">我创建的</div><div class="button">未提交</div><div class="button">已提交</div><div class="button">时间范围 2015.1.1 - 2016.1.1</div></section></cm-side-menu-content-header><section><table ng-table="tableParams" class="table table-striped table-hover list"><tbody><tr ng-repeat="item in $data track by $index"><td data-title="\'\'" style="padding-left: 24px;vertical-align: middle"><div class="cm-table-indicator-dot" style="background-color: {{\'#\'+item.Id}}"></div></td><td data-title="\'状态\'"><div title="{{item.Id}}">{{item.Status | FormStatusFilter}}</div></td><td data-title="\'创建\'"><span class="cm-table-user" title="工号：{{item.CreateUserId}}">{{item.CreateUserName}}</span> <span class="cm-table-time">{{item.CreateTime | date: \'MM月dd日 HH:mm\' }}</span></td><td data-title="\'最后修改\'"><span class="cm-table-user" title="工号：{{item.LastModifiedUserId}}">{{item.LastModifiedUserName}}</span> <span class="cm-table-time">{{item.LastModifiedTime | date: \'MM月dd日 HH:mm\' }}</span></td><td data-title="\'生成的检验任务\'" style="padding-left: 24px;vertical-align: middle"><div style="display: flex"><div ng-repeat="asn in item.Parameter.processes" ui-sref="home.process.detailInfo({ArrivalSerialNumber:asn})" style="margin-right: 8px;cursor: pointer;"><div class="cm-table-indicator-dot" style="{{\'background-color:#\'+asn}}"></div></div></div></td><td data-title="\'操作\'" style="text-align: left"><a ng-click="funcGoDetail(item.ArrivalSerialNumber,item.Id,\'view\')">查看</a> &nbsp; <a ng-show="item.Status!==\'4\'" ng-click="funcGoDetail(item.ArrivalSerialNumber,item.Id,\'edit\')">编辑</a></td></tr></tbody></table></section></cm-side-menu-content>'),e.put("app/interaction/process/list/inspection_print.html",""),e.put("app/interaction/process/list/inspection_process.html",'<cm-side-menu-content style="" cg-busy="{promise:myPromise,message:\'请稍后...\'}"><cm-side-menu-content-header><section class="title"><h2>检验任务管理</h2></section><section class="toolbar"><div class="btn btn-link" ng-click="new()">新建</div></section></cm-side-menu-content-header><section>关键字： <input type="text" ng-model="search" id="search" class="form-control" style="max-width: 150px;display: inline" placeholder="姓名，货号，色号"> 来料日期： <input type="date" ng-model="date" id="date" class="form-control" style="max-width: 200px;display: inline" placeholder=""><hr><table class="table table-bordered table-striped table-condensed" ng-table="tableParams"><tbody><tr ng-repeat="row in $data | filter:searchFilter(search,date)"><td data-title="\'来料日期\'" sortable="\'ArriveTime\'"><span>{{row.ArriveTime | date:\'yyyy-MM-dd\'}}</span></td><td data-title="\'货号\'" style="min-width: 100px" sortable="\'ProductNo\'">{{row.ProductNo}}</td><td data-title="\'色号\'" sortable="\'ColorNo\'">{{row.ColorNo}}</td><td data-title="\'创建人\'" sortable="\'Name\'">{{row.Name}}</td><td data-title="\'最后修改时间\'" sortable="\'LastModifiedTime\'">{{row.LastModifiedTime}}</td><td data-title="\'操作\'" style="max-width: 100px"><span class="btn-link pull-right" style="cursor:pointer;margin-right: 5px" ng-show="url == \'/Tasks/Dataentry\'" ng-click="edit(row,false)">修改</span> <span class="btn-link pull-right" style="cursor:pointer;margin-right: 5px" ng-show="url == \'/Tasks/Dataentry\'" ng-click="entry(row,\'dataEntry\')">填写</span> <span class="btn-link pull-right" style="cursor:pointer;margin-right: 5px" ng-show="url == \'/Tasks/Check\'" ng-click="entry(row,\'Check\')">查看</span> <span class="btn-link pull-right" style="cursor:pointer;margin-right: 5px" ng-click="print(row.SerialNo)">打印</span> <span class="btn-link pull-right" style="cursor:pointer;margin-right: 5px" ng-click="del(row.SerialNo)" ng-show="url == \'/Tasks/Dataentry\'">删除</span></td></tr></tbody></table></section></cm-side-menu-content>'),e.put("app/interaction/process/list/modifyInspectionProcess.html",'<div cg-busy="{promise:myPromise,message:\'请稍后...\'}"><div class="modal-header"><h3 class="modal-title">添加或修改检验任务</h3></div><div class="modal-body"><style>\n      .modify-info-div{\n        margin-top: 5px;\n        margin-bottom: 3px;\n      }\n    </style><table class="table-condensed table" ng-show="vm.formData.model.SerialNo"><tr><td>流水号</td><td colspan="3"><label class="label-default label">{{vm.formData.model.SerialNo}}</label></td></tr><tr><td>最后更新时间</td><td>{{vm.formData.model.LastModifiedTime}}</td><td>创建人</td><td>{{vm.formData.model.Name}}</td></tr></table><form name="vm.form2"><formly-form model="vm.formData.model" fields="vm.formData.fields" form="vm.form" options="vm.formData.options"></formly-form></form><hr></div><div class="modal-footer"><button class="btn btn-primary" ng-click="vm.ok()" ng-disabled="vm.form2.$invalid">提交</button> <button class="btn btn-warning" ng-click="vm.cancel(initialModel)" ng-disabled="false">取消</button></div></div>'),e.put("app/interaction/control/design/edit/configs.html",'<section class="block"><h4>组件基本信息</h4><section class="map"><div class="row"><div class="item"><div class="name">模板类型</div><div class="input"><label title="映射"><input type="radio" ng-model="generalConfig.Type" value="map" disabled="">映射</label> <label title="表格"><input type="radio" ng-model="generalConfig.Type" value="table" disabled="">表格</label></div></div><div class="item" ng-if="uiIsMap"><div class="name">模板样式</div><div class="input"><label title="映射"><input type="radio" ng-model="generalConfig.Style" value="flex">Flex</label> <label title="表格"><input type="radio" ng-model="generalConfig.Style" value="left">Left</label></div></div><div class="item"><div class="name">是否可见</div><div class="input"><label title="是"><input type="radio" ng-model="generalConfig.Show" value="true" disabled="">是</label> <label title="否"><input type="radio" ng-model="generalConfig.Show" value="false" disabled="">否</label></div></div><div class="item"></div></div><div class="row"><div class="item"><div class="name">快捷初始化函数</div><div class="input" style="width: 100%;"><label style="width: 100%;"><input type="text" class="value" ng-model="generalConfig.QuickInitial" style="width: 100%;"></label></div></div></div></section></section><section class="block" ng-show="uiIsAddPanelShow"><h4 ng-show="uiIsTable">添加表格新的项</h4><h4 ng-show="uiIsMap">添加映射新的项</h4><form name="addNewCol" ng-submit="funcAddUpConfigs()"><section class="map"><div class="row"><div class="item" ng-if="uiIsTable"><div class="name">列名</div><div><input type="text" class="value" ng-model="itemConfig.Name" placeholder="表头显示的内容"></div></div><div class="item" ng-if="uiIsMap" ng-show="generalConfig.Style===\'flex\'"><div class="name">名称</div><div><input type="text" class="value" ng-model="itemConfig.Name" placeholder="说明文字"></div></div><div class="item" ng-if="uiIsMap" ng-show="generalConfig.Style===\'left\'"><div class="name">左描述</div><div><input type="text" class="value" ng-model="itemConfig.LeftDescription" placeholder=""></div></div><div class="item" ng-if="uiIsMap" ng-show="generalConfig.Style===\'left\'"><div class="name">右描述</div><div><input type="text" class="value" ng-model="itemConfig.RightDescription" placeholder=""></div></div><div class="item"><div class="name">属性名</div><div><input type="text" class="value" ng-model="itemConfig.AttributeName" placeholder="数据表属性名" required=""></div></div><div class="item" ng-if="uiIsMap"><div class="name">行号</div><div><input type="text" class="value" ng-model="itemConfig.Row" placeholder="所处的行数"></div></div><div class="item" ng-if="uiIsTable"><div class="name">组名</div><div><input type="text" class="value" ng-model="itemConfig.Group" placeholder="表头分组依据"></div></div><div class="item"><div class="name">宽度</div><div><input type="text" class="value" ng-model="itemConfig.Width" placeholder="填写区域宽度[WIP]"></div></div><div class="item"></div></div><div class="row"><div class="item"><div class="name">域类型</div><div class="input"><label title="文本"><input type="radio" ng-model="itemConfig.Type" value="text">Text</label> <label title="数字"><input type="radio" ng-model="itemConfig.Type" value="number">Number</label> <label title="下拉单选框"><input type="radio" ng-model="itemConfig.Type" value="select">Select</label> <label title="下拉多选框"><input type="radio" ng-model="itemConfig.Type" value="multiSelect">Multi-Select</label> <label title="单选按钮"><input type="radio" ng-model="itemConfig.Type" value="radio">Radio</label> <label title="多选框"><input type="radio" ng-model="itemConfig.Type" value="checkbox">Checkbox</label> <label title="日期选择器"><input type="radio" ng-model="itemConfig.Type" value="date">Date</label> <label title="周选择器"><input type="radio" ng-model="itemConfig.Type" value="week">Week</label> <label title="日期与时间选择器"><input type="radio" ng-model="itemConfig.Type" value="datetime">Datetime</label></div></div></div><div class="row left" ng-show="itemConfig.Type===\'text\'||itemConfig.Type===\'number\'"><div class="item"><div class="left-description">正则表达式</div><div class="input"><label><input type="text" class="value" ng-model="itemConfig.ngPattern"></label></div></div><div class="item"><div class="left-description">最小长度</div><div><input type="number" class="value" style="min-width: 50px;width: 50px;" ng-model="itemConfig.ngMinlength"></div></div><div class="item"><div class="left-description">最大长度</div><div class="input"><label><input type="number" class="value" style="min-width: 50px;width: 50px;" ng-model="itemConfig.ngMaxlength"></label></div></div><div class="item"><div class="input"><label><input type="checkbox" ng-model="itemConfig.ngRequired">必填</label> <label><input type="checkbox" ng-model="itemConfig.ngDisabled">不可修改</label> <label ng-show="itemConfig.Type===\'text\'"><input type="checkbox" ng-model="itemConfig.ngTrim">字符串优化(trim)</label></div></div></div><div class="row left" ng-show="itemConfig.Type===\'number\'"><div class="item"><div class="left-description">范围限定：</div><div class="left-description">最小值</div><div class="input"><label><input type="number" class="value" style="width: 100px;" ng-model="itemConfig.ngMin"></label></div></div><div class="item"><div class="left-description">最大值</div><div class="input"><label><input type="number" class="value" style="width: 100px;" ng-model="itemConfig.ngMax"></label></div></div></div><div class="row" ng-show="itemConfig.Type===\'select\'||itemConfig.Type===\'multiSelect\'||itemConfig.Type===\'checkbox\'||itemConfig.Type===\'radio\'"><div class="item"><div class="left-description">可选值来源</div><div style="cursor: pointer;white-space: nowrap" onclick="alert(\'DEV\')">设置&nbsp;&nbsp;</div><div class="input" style="width:100%;"><label style="width: 100%;"><input type="text" class="value" ng-model="itemConfig.Sources" ng-list="" placeholder="使用预设的可选值列表" style="width: 100%"></label></div></div><div class="item"><div class="input"><label><input type="checkbox" ng-model="itemConfig.ngRequired">必填</label> <label><input type="checkbox" ng-model="itemConfig.ngDisabled">不可修改</label></div></div></div><div class="row" ng-show="itemConfig.Type===\'select\'||itemConfig.Type===\'multiSelect\'||itemConfig.Type===\'checkbox\'||itemConfig.Type===\'radio\'"><div class="item"><div class="name">可选值</div><div class="input" style="width:100%;"><label style="width: 100%;"><input type="text" class="value" ng-model="itemConfig.Options" ng-list="" placeholder="请使用&quot;,&quot;字符来分隔可选项" style="width: 100%"></label></div></div></div><div class="row left" ng-show="itemConfig.Type===\'date\'||itemConfig.Type===\'week\'||itemConfig.Type===\'datetime\'"><div class="item"><div class="left-description">最早时间</div><div class="input"><label><input type="number" class="value" ng-model="itemConfig.ngMin"></label></div></div><div class="item"><div class="left-description">最晚时间</div><div class="input"><label><input type="number" class="value" ng-model="itemConfig.ngMax"></label></div></div><div class="item"><div class="input"><label><input type="checkbox" ng-model="itemConfig.ngRequired">必填</label> <label><input type="checkbox" ng-model="itemConfig.ngDisabled">不可修改</label></div></div></div></section><input class="btn btn-default" type="submit" id="submit" value="添加"></form></section><section class="block"><h4>表格配置信息</h4><table class="table table-hover table-bordered table-condensed"><thead><tr ng-if="uiIsTable"><th width="5%">修改</th><th width="5%" style="cursor:pointer;" ng-click="funcReorderConfigs()">序号</th><th width="15%">组名</th><th width="15%">列名</th><th width="15%">属性名</th><th width="10%">类型</th><th width="35%">限定配置</th></tr><tr ng-if="uiIsMap"><th width="5%">修改</th><th width="5%" style="cursor:pointer;" ng-click="funcReorderConfigs()">序号</th><th width="5%">行号</th><th width="15%">列名</th><th width="15%">属性名</th><th width="10%">类型</th><th width="40%">限定配置</th><th style="width:5%">修改</th></tr></thead><tbody><tr ng-repeat="itemConfig in itemConfigs | orderBy:Order" ng-if="uiIsTable"><td ng-click="funcDeleteFromConfigs($index)" style="cursor: pointer;">删除</td><td><div contenteditable="true" cmcontenteditable="" ng-model="itemConfig.Order"></div></td><td>{{itemConfig.Group}}</td><td>{{itemConfig.Name}}</td><td>{{itemConfig.AttributeName}}</td><td>{{itemConfig.Type}}</td><td style="word-break: break-all;overflow: hidden"><code>{{itemConfig}}</code></td></tr><tr ng-repeat="itemConfig in itemConfigs | orderBy:Order" ng-if="uiIsMap"><td ng-click="funcDeleteFromConfigs($index)" style="cursor: pointer;">删除</td><td><div contenteditable="true" cmcontenteditable="" ng-model="itemConfig.Order"></div></td><td>{{itemConfig.Row}}</td><td>{{itemConfig.Name}}</td><td>{{itemConfig.AttributeName}}</td><td>{{itemConfig.Type}}</td><td style="word-break: break-all;overflow: hidden"><code>{{itemConfig}}</code></td><td ng-click="funcLoadItemConfigToAddPanel(itemConfig,$index)" style="cursor: pointer;">修改</td></tr><tr ng-show="!(itemConfigs.length>0)"><td colspan="8" style="height: 64px;text-align:center;line-height:64px;background-color: #F4F4F4;font-size: 15px">列表为空，请从上面添加项目</td></tr></tbody></table></section><section class="block"><h4>配置信息</h4><pre>\r\n    {{itemConfigs | json}}\r\n  </pre></section>'),
e.put("app/interaction/control/design/edit/form.html",'<cm-side-menu-content class="form-table control"><cm-side-menu-content-header><section class="title"><div class="block" ng-if="uiIsEditCache">正在编辑缓存 <span ng-click="funcSaveConfigsCacheAndBack()" class="cm-button">保存并返回</span></div></section><section class="toolbar"></section></cm-side-menu-content-header><section style="display: flex;"><div style="flex: 7;"><section class="block"><h4>表单基本信息</h4><section class="map"><div class="row"><div class="item"><div class="name">可选表单标签</div><input type="text" class="value" ng-model="generalConfig.OptionalTags" ng-list="" placeholder="使用英文逗号分隔" style="width: 67%"></div></div></section></section><section class="block"><h4>添加表单组件</h4><section class="map"><div class="row"><div class="item"><div class="name">通过JSON加载</div><div style="cursor: pointer" ng-click="funcLoadConfig(configString)" class="cm-button">加载</div><input type="text" class="value" ng-model="configString" placeholder="" style="width: 67%"></div></div><div class="row"><div class="item"><div class="name">通过本地缓存加载</div><div>加载&nbsp;&nbsp;&nbsp;&nbsp;</div><div ng-click="funcGoCreateItemConfig(\'table\')" class="cm-button">创建表格组件</div><div ng-click="funcGoCreateItemConfig(\'map\')" class="cm-button">创建映射组件</div><div ng-click="funcGoEditItemConfig(itemConfig.Type)" class="cm-button">编辑当前组件</div></div></div></section><form ng-submit="funcAddUpConfigs()"><section class="map"><div class="row"><div class="item"><div class="name">模板类型</div><div class="input"><label title="映射"><input type="radio" ng-model="itemConfig.Type" value="map">映射</label> <label title="表格"><input type="radio" ng-model="itemConfig.Type" value="table">表格</label></div></div><div class="item" ng-show="itemConfig.Type===\'map\'"><div class="name">模板样式</div><div class="input"><label title="映射"><input type="radio" ng-model="itemConfig.Style" value="flex">Flex</label> <label title="表格"><input type="radio" ng-model="itemConfig.Style" value="left">Left</label></div></div><div class="item"><div class="name">是否可见</div><div class="input"><label title="是"><input type="radio" ng-model="itemConfig.Show" id="inlineRadio3" value="true">是</label> <label title="否"><input type="radio" ng-model="itemConfig.Show" id="inlineRadio4" value="false">否</label></div></div></div><div class="row"><div class="item"><div class="name">快捷初始化函数</div><input type="text" class="value" ng-model="itemConfig.QuickInitial" style="width: 67%;"></div></div><div class="row"><div class="item"><div class="name">模板配置</div><div style="width: 85%;"><pre>{{itemConfig.Config}}</pre></div></div></div></section><input class="btn btn-default" type="submit" id="submit" value="添加"></form></section><section class="block"><h4>表单内容配置信息</h4><table class="table table-hover table-bordered table-condensed"><thead><tr><th style="width:5%">修改</th><th style="width:5%;cursor:pointer;" ng-click="funcReorderConfigs()">序号</th><th style="width:10%">模板类型</th><th style="width:5%">是否显示</th><th style="width:70%;">配置信息</th><th style="width:5%">修改</th></tr></thead><tbody><tr ng-repeat="itemConfig in itemConfigs | orderBy:Order"><td ng-click="funcDeleteFromConfigs($index)" style="cursor: pointer;">删除</td><td><div contenteditable="true" cmcontenteditable="" ng-model="itemConfig.Order"></div></td><td>{{itemConfig.Type}}</td><td>{{itemConfig.Show}}</td><td><code style="word-break: break-all;overflow: hidden">{{itemConfig.Config}}</code></td><td ng-click="funcLoadItemConfigToAddPanel(itemConfig,$index)" style="cursor: pointer;">修改</td></tr><tr ng-show="!(itemConfigs.length>0)"><td colspan="8" style="height: 64px;text-align:center;line-height:64px;background-color: #F4F4F4;font-size: 15px">列表为空，请从上面添加项目</td></tr></tbody></table></section><section class="block"><pre>\r\n    {{itemConfigs | json}}\r\n  </pre></section></div><div style="flex: 3;margin-left: 12px;" ng-if="false"><section class="block"><h4>本地组件列表</h4><ul><li ng-repeat="localConfig in localConfigs">{{localConfig.description}} <span style="float: right;">X</span></li></ul></section></div></section></cm-side-menu-content>'),e.put("app/interaction/control/design/edit/map.html",'<cm-side-menu-content class="form-table control"><cm-side-menu-content-header><section class="title"><div class="block" ng-if="uiIsEditCache">正在编辑缓存 <span ng-click="funcSaveConfigsCacheAndBack()" class="cm-button">保存并返回</span></div></section><section class="toolbar"><div class="button {{$parent.uiIsAddPanelShow?\'active\':\'\'}}" ng-click="$parent.uiIsAddPanelShow=!$parent.uiIsAddPanelShow">添加新列</div></section></cm-side-menu-content-header><section style="display: flex;"><div style="flex: 7;"><ng-include src="\'app/control/design/edit/configs.html\'"></ng-include></div><div style="flex: 3;margin-left: 12px" ng-if="false"><section class="block"><h4>缓存的映射配置</h4><ul><li ng-repeat="i in [1,2,3,4,5,6,7,8,9]">{{"Condition:"+i}}</li></ul></section></div></section></cm-side-menu-content>'),e.put("app/interaction/control/design/edit/process.html",'<cm-side-menu-content class="form-table control"><cm-side-menu-content-header><section class="title"><div class="block" ng-if="uiIsEditCache">正在编辑缓存 <span ng-click="funcSaveConfigsCacheAndBack()" class="cm-button">提交流程修改</span></div></section><section class="toolbar"><div class="button" ng-click="funcAddProcessTypeIdToConfigs()">添加ProcessTypeId</div><div class="button" ng-click="funcAddDatabaseTableNameToFormConfigs()">添加生成的数据表名称</div><div class="button" ng-click="funcCreateProcessTypeAndProcessNodeTypes(processConfig,configs)">提交流程</div></section></cm-side-menu-content-header><section class="block"><h4>流程基本信息</h4><section class="map"><div class="row"><div class="item"><div class="name">唯一标识</div><div class="input"><input type="text" class="value" ng-model="generalConfig.Id" placeholder="例如：A01" required=""></div></div><div class="item"><div class="name">修订号</div><div class="input"><input type="text" class="value" ng-model="generalConfig.Rev" placeholder="例如：勾袢" required=""></div></div><div class="item"><div class="name">分类</div><div class="input"><label title="收货"><input type="radio" ng-model="generalConfig.Class" value="收货">收货</label> <label title="主料"><input type="radio" ng-model="generalConfig.Class" value="主料">主料</label> <label title="辅料"><input type="radio" ng-model="generalConfig.Class" value="辅料">辅料</label></div></div></div><div class="row"><div class="item"><div class="name">名称</div><div class="input"><label><input type="text" class="value" ng-model="generalConfig.Name" placeholder="例如：勾袢" required=""></label></div></div></div><div class="row"><div class="item"><div class="name">描述</div><input type="text" class="value" ng-model="generalConfig.Description" style="width: 100%;" placeholder="编辑时的参考文字"></div></div><div class="row"><div class="item"><div class="name">流程完成条件</div><input type="text" class="value" ng-model="generalConfig.CompleteCondition" style="width: 100%;" placeholder="例：PN01.Status=4&PN01.Tag!=>\'严重质量问题\'"></div></div><div class="row"><div class="item"><div class="name">流程参考配置</div><input type="text" class="value" ng-model="generalConfig.Reference" style="width: 100%;" placeholder="配置收货报告、参考文档、标准值参考、选项框内容等"></div></div></section></section><section class="block"><h4>添加流程节点</h4><form ng-submit="funcAddUpConfigs()"><section class="map"><div class="row"><div class="item"><div class="name">节点标识</div><div><input type="text" class="value" ng-model="itemConfig.Id" placeholder="例如：PN01" required=""></div></div><div class="item"><div class="name">名称</div><div><input type="text" class="value" ng-model="itemConfig.Name" placeholder="例如：颜色检验" required=""></div></div><div class="item"></div></div><div class="row"><div class="item"><div class="name">描述</div><input type="text" class="value" ng-model="itemConfig.Description" placeholder="描述信息，可为空" style="width: 60%"></div></div><div class="row"><div class="item"><div class="name">可用性条件</div><input type="text" class="value" ng-model="itemConfig.AvailableCondition" placeholder="表示该节点可用需具备的条件，开发中" style="width: 60%"></div></div><div class="row"><div class="item"><div class="name">导入JSON表单配置</div><div class="cm-button" ng-click="funcLoadConfig(funcPackFormConfigString(configString))">加载</div><input type="text" class="value" ng-model="configString" placeholder="" style="width: 60%"></div></div><div class="row"><div class="item"><div class="name">导入本地表单配置</div><div style="padding-right: 12px">加载</div><div ng-click="funcGoCreateItemConfig(\'form\')" class="cm-button">创建表单</div><div ng-click="funcGoEditItemConfig(\'form\')" class="cm-button">编辑当前表单</div></div></div><div class="row"><div class="item"><div class="name">表单配置</div><div style="width: 85%"><pre>{{itemConfig.FormConfig}}</pre></div></div></div></section><input class="btn btn-default" type="submit" id="submit" value="添加"></form></section><section class="block"><h4>流程节点配置信息</h4><table class="table table-hover table-bordered table-condensed"><thead><tr><th style="width:5%">修改</th><th style="width:5%;cursor:pointer;" ng-click="funcReorderConfigs()">序号</th><th style="width:5%">节点标识</th><th style="width:5%">名称</th><th style="width:15%;">描述</th><th style="width:20%">可用性条件</th><th style="width:40%">表单配置</th><th style="width:5%">修改</th></tr></thead><tbody><tr ng-repeat="itemConfig in itemConfigs | orderBy:Order"><td ng-click="funcDeleteFromConfigs($index)" style="cursor: pointer;">删除</td><td><div contenteditable="true" cmcontenteditable="" ng-model="itemConfig.Order"></div></td><td>{{itemConfig.Id}}</td><td>{{itemConfig.Name}}</td><td><code style="word-break: break-all;overflow: hidden">{{itemConfig.Description}}</code></td><td><code style="word-break: break-all;overflow: hidden">{{itemConfig.AvailableCondition}}</code></td><td><code style="word-break: break-all;overflow: hidden">{{itemConfig.FormConfig}}</code></td><td ng-click="funcLoadItemConfigToAddPanel(itemConfig,$index)" style="cursor: pointer;">修改</td></tr><tr ng-show="!(itemConfigs.length>0)"><td colspan="8" style="height: 64px;text-align:center;line-height:64px;background-color: #F4F4F4;font-size: 15px">列表为空，请从上面添加项目</td></tr></tbody></table></section><section class="block"><pre>\r\n  {{itemConfigs | json}}\r\n  </pre></section></cm-side-menu-content>'),e.put("app/interaction/control/design/edit/table.html",'<cm-side-menu-content class="form-table control"><cm-side-menu-content-header><section class="title"><div class="block" ng-if="uiIsEditCache">正在编辑缓存 <span ng-click="funcSaveConfigsCacheAndBack()" class="cm-button">保存并返回</span></div></section><section class="toolbar"><div class="button {{$parent.uiIsAddPanelShow?\'active\':\'\'}}" ng-click="$parent.uiIsAddPanelShow=!$parent.uiIsAddPanelShow">添加新列</div></section></cm-side-menu-content-header><section style="display: flex;"><div style="flex: 7;"><ng-include src="\'app/control/design/edit/configs.html\'"></ng-include></div><div style="flex: 3;margin-left: 12px" ng-if="false"><section class="block"><h4>缓存的表格配置</h4><ul><li ng-repeat="i in [1,2,3,4,5,6,7,8,9]">{{"Condition:"+i}}</li></ul></section></div></section></cm-side-menu-content>')}]);
//# sourceMappingURL=../maps/scripts/app-a70ec01dca.js.map
